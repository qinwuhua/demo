<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.gcglgcglsj">

	<select id="selectgcgzsjYbByJhid" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
		select * from (
		select m.*,rownum rn from (
			select t1.*,t2.tbr,t2.tbsj,t2.tbyf,t2.cgsdwzj,t2.cscyj,t2.stz from GCGL_GCGZSJ t1 left join GCGL_CGS t2 on t1.jhid=t2.jhid and t1.sbyf=t2.tbyf
			where 1=1 and t1.sfsj &lt;=#{sfsj}
		<if test="jhid != null and  jhid != ''">
			and t1.jhid =#{jhid}
		</if>
		order by to_number(substr(sbyf,0,4))desc,to_number(replace(sbyf,'-','')) desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	<select id="selectgcgzsjYbByJhidCount" parameterType="gcglgcgzsj" resultType="int">
		select count(*) from GCGL_GCGZSJ 
		where 1=1 and sfsj &lt;=#{sfsj}
		<if test="jhid != null and  jhid != ''">
			and jhid =#{jhid}
		</if>
	</select>
	<select id="selectgcgzsjYbByJhid1" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
		select * from (
		select m.*,rownum rn from (
			select t1.*,t2.tbr,t2.tbsj,t2.tbyf,t2.cgsdwzj,t2.cscyj,t2.stz from GCGL_GCGZSJ t1 left join GCGL_CGS t2 on t1.jhid=t2.jhid and t1.sbyf=t2.tbyf
			where 1=1 and sfsj=7
		<if test="jhid != null and  jhid != ''">
			and t1.jhid =#{jhid}
		</if>
		order by to_number(substr(sbyf,0,4))desc,to_number(replace(sbyf,'-','')) desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	<select id="selectgcgzsjYbByJhidCount1" parameterType="gcglgcgzsj" resultType="int">
		select count(*) from GCGL_GCGZSJ 
		where 1=1 and sfsj=7 
		<if test="jhid != null and  jhid != ''">
			and jhid =#{jhid}
		</if>
	</select>
	<!-- 添加月报 -->
	<insert id="insertgcgzsjYb" parameterType="gcglgcgzsj">
		insert into GCGL_GCGZSJ(id,jhid,qlwcqk_z,qlwcqk_ym,sdwcqk_z,sdwcqk_ym,hdwcqk_m,ljtsfwcqk,dcwcqk,jcwcqk,lqlmwcqk,snlmwcqk,zycgs,dfbz,yhdk,sttxdk,qtzj,bywctze,bywcgzl,sbyf,sbsj,bywcmc,kgdl,qksm,shzt,sfsj,sfth,ssdctc,bndsslc,wcqk,wkglc<if test="gz != null">,gz</if><if test="sz != null">,sz</if><if test="yiji != null">,yiji</if><if test="erji != null">,erji</if><if test="sanji != null">,sanji</if><if test="siji != null">,siji</if>)
		values(sys_guid(),#{jhid},#{qlwcqk_z},#{qlwcqk_ym},#{sdwcqk_z},#{sdwcqk_ym},#{hdwcqk_m},#{ljtsfwcqk},#{dcwcqk},#{jcwcqk},#{lqlmwcqk},#{snlmwcqk},#{zycgs},#{dfbz},#{yhdk},#{sttxdk},#{qtzj},#{bywctze},#{bywcgzl},#{sbyf},#{sbsj},#{bywcmc},#{kgdl},#{qksm},#{shzt},#{sfsj},'否',#{ssdctc},#{bndsslc},#{wcqk},#{wkglc}<if test="gz != null">,#{gz}</if><if test="sz != null">,#{sz}</if><if test="yiji != null">,#{yiji}</if><if test="erji != null">,#{erji}</if><if test="sanji != null">,#{sanji}</if><if test="siji != null">,#{siji}</if>)
	</insert>
	<select id="queryYbByYf" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
		select * from GCGL_GCGZSJ where sbyf=#{sbyf} and jhid=#{jhid}
	</select>
	<!-- 修改月报 -->
	<update id="updategcgzsjYb" parameterType="gcglgcgzsj">
		update GCGL_GCGZSJ set qlwcqk_z=#{qlwcqk_z},qlwcqk_ym=#{qlwcqk_ym},sdwcqk_z=#{sdwcqk_z},sdwcqk_ym=#{sdwcqk_ym},hdwcqk_m=#{hdwcqk_m},ljtsfwcqk=#{ljtsfwcqk},dcwcqk=#{dcwcqk},jcwcqk=#{jcwcqk},lqlmwcqk=#{lqlmwcqk},snlmwcqk=#{snlmwcqk},zycgs=#{zycgs},dfbz=#{dfbz},yhdk=#{yhdk},sttxdk=#{sttxdk},qtzj=#{qtzj},bywctze=#{bywctze},bywcgzl=#{bywcgzl},bywcmc=#{bywcmc},kgdl=#{kgdl},qksm=#{qksm},sbyf=#{sbyf},ssdctc=#{ssdctc},bndsslc=#{bndsslc},wcqk=#{wcqk},wkglc=#{wkglc} 
		<if test="gz != null">,gz=#{gz}</if><if test="sz != null">,sz=#{sz}</if>
		<if test="yiji != null">,yiji=#{yiji}</if><if test="sanji != null">,sanji=#{sanji}</if>
		<if test="erji != null">,erji=#{erji}</if><if test="siji != null">,siji=#{siji}</if>
		where id=#{id} and jhid=#{jhid}
	</update>
	<!-- 修改月报状态 -->
	<update id="sbWqgzYb" parameterType="gcglgcgzsj">
		update GCGL_GCGZSJ set sfsj=#{sfsj} <!-- , shzt='已审核' , xgcsyj='同意' -->
		where id=#{id}
	</update>
	<!-- 删除月报 -->
	<delete id="deletegcgzsjYb" parameterType="gcglgcgzsj">
		delete from GCGL_GCGZSJ where id=#{id}
	</delete>
	<!-- 审核月报 -->
	<update id="shgcgzsjyb" parameterType="gcglgcgzsj">
		update GCGL_GCGZSJ set shuser=#{shuser},shtime=#{shtime},zjje=#{zjje},xgcsyj=#{xgcsyj},shzt='已审核'
		where id=#{id} and jhid=#{jhid}
	</update>
	
			<!-- 添加车购税 -->
	<insert id="insertGcgzsjCgs" parameterType="gcglgcgzsj">
		insert into GCGL_CGS(id,jhid,cgsdwzj,tbr,tbyf,tbsj
		<if test="stz != null">,stz</if>
		,cscyj
		<if test="sz != null">,sz</if>
		<if test="gz != null">,gz</if>
		<if test="yhdk != null">,yhdk</if>
		<if test="pfztz != null">,pfztz</if>
		<if test="zq != null">,zq</if>
		<if test="jl != null">,jl</if>
		<if test="qt != null">,qt</if>
		)
		values(sys_guid(),#{jhid},#{cgsdwzj},#{tbr},#{tbyf},#{tbsj}
		<if test="stz != null">,#{stz}</if>
		,#{cscyj}
		<if test="sz != null">,#{sz}</if>
		<if test="gz != null">,#{gz}</if>
		<if test="yhdk != null">,#{yhdk}</if>
		<if test="pfztz != null">,#{pfztz}</if>
		<if test="zq != null">,#{zq}</if>
		<if test="jl != null">,#{jl}</if>
		<if test="qt != null">,#{qt}</if>
		)
	</insert>
	<select id="queryCGSByYf" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
		select * from GCGL_CGS where tbyf=#{tbyf} and jhid=#{jhid}
	</select>
	<!-- 查询cgs -->
	<select id="selectGcgzsjCgsList" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
		select * from (
		select m.*,rownum rn from (
			select t1.*,t2.sbsj,t2.sbyf from GCGL_CGS t1 left join GCGL_GCGZSJ t2 on t1.jhid=t2.jhid and t1.tbyf=t2.sbyf
			where 1=1
		<if test="jhid != null and  jhid != ''">
			and t1.jhid =#{jhid}
		</if>
		order by to_number(substr(tbyf,0,4))desc,to_number(replace(tbyf,'-','')) desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	<select id="selectGcgzsjCgsListCount" parameterType="gcglgcgzsj" resultType="int">
		select count(*) from GCGL_CGS 
		where 1=1
		<if test="jhid != null and  jhid != ''">
			and jhid =#{jhid}
		</if>
	</select>
	<!-- 删除cgs -->
	<delete id="deleteGcgzsjCgs" parameterType="gcglgcgzsj">
		delete from GCGL_CGS where id=#{id}
	</delete>
	<!-- 修改cgs -->
	<update id="updateGcgzsjCgs" parameterType="gcglgcgzsj">
		update GCGL_CGS set cgsdwzj=#{cgsdwzj},tbsj=#{tbsj},tbyf=#{tbyf},cscyj=#{cscyj}
		<if test="stz != null">,stz=#{stz}</if>
		<if test="sz != null">,sz=#{sz}</if>
		<if test="gz != null">,gz=#{gz}</if>
		<if test="yhdk != null">,yhdk=#{yhdk}</if>
		<if test="pfztz != null">,pfztz=#{pfztz}</if>
		<if test="zq != null">,zq=#{zq}</if>
		<if test="jl != null">,jl=#{jl}</if>
		<if test="qt != null">,qt=#{qt}</if>
		
		where id=#{id} and jhid=#{jhid}
	</update>
<!-- 上传 -->
	<update id="uploadWqgzFilesgxk" parameterType="gcglgcgzsj">
		update PLAN_GCSJ set SGXKWJ=#{tiaojian},SGXKWJFILE=#{sgxkwjfile}
		where id=#{jhid}
	</update>
		<update id="uploadWqgzFilejgtc" parameterType="gcglgcgzsj">
		update PLAN_GCSJ set JGTCWJ=#{tiaojian},JGTCWJFILE=#{jgtcwjfile}
		where id=#{jhid}
	</update>
		<update id="uploadWqgzFilejgys" parameterType="gcglgcgzsj">
		update PLAN_GCSJ set JGYSWJ=#{tiaojian},JGYSWJFILE=#{jgyswjfile}
		where id=#{jhid}
	</update>
	<!-- 下载 -->
	<select id="downWqgzFile" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
		select ${tiaojian} tiaojian,${lxmc} sgxkwjfile from PLAN_GCSJ where id=#{jhid}
	</select>
	<update id="insertWqgzwwg" parameterType="gcglgcgzsj">
		update PLAN_GCSJ set WJGYY=#{wjgyy} where id=#{jhid}
	</update>
	<update id="insertWqgzwg" parameterType="gcglgcgzsj">
		update JHSH_SJGZ set sjwgsj=#{sjwgsj},jgzt=#{jgzt} where xmbm=#{jhid}
	</update>
	<update id="insertWqgzkg" parameterType="gcglgcgzsj">
		update JHSH_SJGZ set kgzt=#{kgzt},sjkgsj=#{sjkgsj},yjwgsj=#{yjwgsj},sgdw=#{sgdw},jldw=#{jldw},jsdw=#{jsdw},htje=#{htje},gys=#{gsztz} where xmbm=#{jhid}
	</update>
	
	<select id="selectWqgzjhList" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
		select * from (
		select m.*,rownum rn from (
		select 
		t1.lxmc,t1.lxbm,t1.yjsdj,t1.qdzh,t1.zdzh,t1.qzlc,t1.gydw,t1.gydwbm,t1.xzqhdm,t1.xzqhmc,t1.xmlc,t1.bhnr,t1.bz lxbz,  
		t2.fapgdw,t2.fascdw,t2.faspsj,t2.spwh,t2.tzgs,t2.jsxz,t2.jsnr,t2.scbz,
		t2.jhnf sbnf,t2.jhkgsj,t2.jhwgsj,t2.id id,t2.xmmc,t2.sftqss,t2.sjdw,t2.sjpfdw,t2.jsjsbz,t2.ql,t2.ql_m,t2.sd,t2.sd_m,t2.hd,t2.ljtsf,t2.dc,t2.jc,t2.lqlm,t2.snlm,t2.gjhjsdj,t2.
		pfwh,t2.pfsj,t2.pftz pfztz,t2.jhsybbzje,t2.jhsydfzczj,t2.id jhid,
		t2.sfsqablbz,t2.ablbzsqwh,t2.gkbgmc,t2.sjsgtmc,t2.remarks,
		t2.xdsj,t2.sjkgsj,t2.sjwgsj,t2.kgzt,t2.jgzt,t2.yjwgsj,t2.sfqxkg,t2.jsdw,t2.sgdw,t2.jldw,t2.htje,t2.sgxkwj,t2.jgtcwj,t2.jgyswj,t2.gsztz,t2.wjgyy
		from PLAN_LX_GCSJ t1 left join PLAN_GCSJ t2 on t1.jhid=t2.id
		where t2.spzt='1'
	<if test="gydw != null and  gydw != ''">
			${gydw}
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="lxmc != null and  lxmc != ''">
			and t1.lxmc like '%'||trim(#{lxmc})||'%'
	</if>
	<if test="shzt != null and  shzt != ''">
			and ${tiaojian} like '%'||trim(#{shzt})||'%'
	</if>
	order by t2.jhnf
	) m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
	</select>
	 <select id="selectWqgzjhListCount" parameterType="gcglgcgzsj" resultType="int">
	 	select count(*) from PLAN_LX_GCSJ t1 left join PLAN_GCSJ t2 on t1.jhid=t2.id
		where t2.spzt='1'
	<if test="gydw != null and  gydw != ''">
			${gydw}
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="lxmc != null and  lxmc != ''">
			and t1.lxmc like '%'||trim(#{lxmc})||'%'
	</if>
	<if test="shzt != null and  shzt != ''">
			and ${tiaojian} like '%'||trim(#{shzt})||'%'
	</if>
	 </select>
	 <select id="selectWqgzjhFile" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
	 	select sgxkwj,jgtcwj,jgyswj from PLAN_GCSJ where id=#{jhid}
	 </select>
	 <update id="updateSjZT" parameterType="gcglgcgzsj" >
	 update JHSH_SJGZ set sjzt=#{sjzt} where xmbm=#{jhid}
	 </update>
	 <update id="updateXjZT" parameterType="gcglgcgzsj" >
	 update JHSH_SJGZ set xjzt=#{xjzt} where xmbm=#{jhid}
	 </update>
	 <update id="updateSJSH" parameterType="gcglgcgzsj" >
	 update JHSH_SJGZ set sjsh=#{sjsh} where xmbm=#{jhid}
	 </update>
	  <update id="updatezdyf" parameterType="gcglgcgzsj" >
	 update PLAN_GCSJ set zdyf=#{sbyf} where id=#{jhid}
	 </update>
	 <select id="selectnumbyyh" parameterType="gcglgcgzsj" resultType="int">
	 	select count(*) from GCGL_GCGZSJ 
		where jhid=#{jhid} and sfsj=#{yhtype} and shzt='未审核'
	 </select>
	 <select id="exportAbyb1" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
	 select * from (
		select m.*,rownum rn from (
		select 
		t1.lxmc,t1.lxbm,t1.yjsdj,t1.qdzh,t1.zdzh,t1.qzlc,t1.gydw,t1.gydwbm,t1.xzqhdm,t1.xzqhmc,t1.xmlc,t1.bhnr,t1.bz lxbz,  
		t2.fapgdw,t2.fascdw,t2.faspsj,t2.spwh,t2.tzgs,t2.jsxz,t2.jsnr,t2.scbz,
		t2.jhnf sbnf,t2.jhkgsj,t2.jhwgsj,t2.id id,t2.xmmc,t2.sftqss,t2.sjdw,t2.sjpfdw,t2.jsjsbz,t2.ql,t2.ql_m,t2.sd,t2.sd_m,t2.hd,t2.ljtsf,t2.dc,t2.jc,t2.lqlm,t2.snlm,t2.gjhjsdj,t2.
		pfwh,t2.pfsj,t2.pftz pfztz,t2.jhsybbzje,t2.jhsydfzczj,t2.id jhid,
		t2.sfsqablbz,t2.ablbzsqwh,t2.gkbgmc,t2.sjsgtmc,t2.remarks,
		t2.xdsj,t2.sjkgsj,t2.sjwgsj,t2.kgzt,t2.jgzt,t2.yjwgsj,t2.sfqxkg,t2.jsdw,t2.sgdw,t2.jldw,t2.htje,t2.sgxkwj,t2.jgtcwj,t2.jgyswj,t2.gsztz,t2.wjgyy
		from PLAN_LX_GCSJ t1 left join PLAN_GCSJ t2 on t1.jhid=t2.id
		where t2.spzt='1'
	<if test="gydw != null and  gydw != ''">
			${gydw}
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="lxmc != null and  lxmc != ''">
			and t1.lxmc like '%'||trim(#{lxmc})||'%'
	</if>
	<if test="shzt != null and  shzt != ''">
			and ${tiaojian} like '%'||trim(#{shzt})||'%'
	</if>
	order by t2.jhnf
	) m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
	 </select>
	  <!-- 查询最进展大月份 -->
	 <select id="querymaxybyf" parameterType="gcglgcgzsj" resultType="gcglgcgzsj">
	 	select max(sbyf) sbyf from gcgl_gcgzsj where jhid=#{jhid}
	 </select>
	 <!-- 差列表 -->
	 <resultMap id="gcsj_jh" type="plan_gcsj">
		<id property="id" column="id" />
		<result property="jhnf" column="jhnf"/>
		<result property="jhkgsj" column="jhkgsj"/>
		<result property="jhwgsj" column="jhwgsj"/>
		<result property="sjdw" column="sjdw"/>
		<result property="sjpfdw" column="sjpfdw"/>
		<result property="pfwh" column="pfwh"/>
		<result property="pfsj" column="pfsj"/>
		<result property="ql" column="ql"/>
		<result property="ql_m" column="ql_m"/>
		<result property="sd" column="sd"/>
		<result property="sd_m" column="sd_m"/>
		<result property="hd" column="hd"/>
		<result property="ljtsf" column="ljtsf"/>
		<result property="dc" column="dc"/>
		<result property="jc" column="jc"/>
		<result property="lqlm" column="lqlm"/>
		<result property="snlm" column="snlm"/>
		<result property="gjhjsdj" column="gjhjsdj"/>
		<result property="pftz" column="pftz"/>
		<result property="jhsybbzje" column="jhsybbzje"/>
		<result property="jhsydfzczj" column="jhsydfzczj"/>
		<result property="sfsqablbz" column="sfsqablbz"/>
		<result property="ablbzsqwh" column="ablbzsqwh"/>
		<result property="remarks" column="remarks"/>
		<result property="tbsj" column="tbsj"/>
		<result property="tbbm" column="tbbm"/>
		<result property="sbzt" column="sbzt"/>
		<result property="sbbm" column="sbbm"/>
		<result property="sbsj" column="sbsj"/>
		<result property="spzt" column="spzt"/>
		<result property="spbm" column="spbm"/>
		<result property="spsj" column="spsj"/>
		<result property="xmwybh" column="xmwybh"/>
		<result property="xdsj" column="xdsj"/>
		<result property="gkbgmc" column="gkbgmc"/>
		<result property="gkbgwj" column="gkbgwj"/>
		<result property="sjsgtmc" column="sjsgtmc"/>
		<result property="sjsgtwj" column="sjsgtwj"/>
		<result property="sjkgsj" column="sjkgsj"/>
		<result property="sjwgsj" column="sjwgsj"/>
		<result property="sgdw" column="sgdw"/>
		<result property="jldw" column="jldw"/>
		<result property="htje" column="htje"/>
		<result property="sgxkwj" column="sgxkwj"/>
		<result property="jgtcwj" column="jgtcwj"/>
		<result property="jgyswj" column="jgyswj"/>
		<result property="wjsczt" column="wjsczt"/>
		<result property="kgzt" column="kgzt"/>
		<result property="jgzt" column="jgzt"/>
		<result property="wjgyy" column="wjgyy"/>
		<result property="yjwgsj" column="yjwgsj"/>
		<result property="xmmc" column="xmmc"/>
		<result property="jsjsbz" column="jsjsbz"/>
		<result property="sftqss" column="sftqss"/>
		<result property="jsdw" column="jsdw"/>
		<result property="jhxdwh" column="jhxdwh"/>
		<result property="gksjwh" column="gksjwh"/>
		<result property="sjpfwh" column="sjpfwh"/>
		<result property="wjzt" column="wjzt"/>
		<result property="wjsj" column="wjsj"/>
		<result property="gsztz" column="gsztz"/>
		<result property="sfqxkg" column="sfqxkg"/>
		<result property="fapgdw" column="fapgdw"/>
		<result property="fascdw" column="fascdw"/>
		<result property="faspsj" column="faspsj"/>
		<result property="spwh" column="spwh"/>
		<result property="tzgs" column="tzgs"/>
		<result property="jsxz" column="jsxz"/>
		<result property="jsnr" column="jsnr"/>
		<result property="sfqxkg" column="sfqxkg"/>
		<result property="jh_sbthcd" column="jh_sbthcd"/>
		<result property="sfylsjl" column="sfylsjl"/>
		<collection property="plan_lx_gcsjs" ofType="plan_lx_gcsj" resultMap="gcsj_lx"/>
	</resultMap>
	<resultMap id="gcsj_lx" type="plan_lx_gcsj">
		<id property="id" column="id" />
		<result property="lxmc" column="lxmc"/>
		<result property="qzlc" column="qzlc"/>
		<result property="xmlc" column="xmlc"/>
		<result property="lxbm" column="lxbm"/>
		<result property="xzqhdm" column="xzqhdm"/>
		<result property="xzqhmc" column="xzqhmc"/>
		<result property="qdzh" column="qdzh"/>
		<result property="zdzh" column="zdzh"/>
		<result property="qzlc" column="qzlc"/>
		<result property="xmlc" column="xmlc"/>
		<result property="gydw" column="gydw"/>
		<result property="gydwbm" column="gydwbm"/>
		<result property="yjsdj" column="yjsdj"/>
		<result property="bhnr" column="bhnr"/>
		<result property="sczt" column="sczt"/>
		<result property="tbsj" column="tbsj"/>
		<result property="tbbmbh" column="tbbmbh"/>
		<result property="gydwdm" column="gydwdm"/>
		<result property="scbz" column="scbz"/>
		<result property="scbmbm" column="scbmbm"/>
		<result property="bz" column="bz"/>
		<result property="jhid" column="jhid"/>
		
		<result property="qdmc" column="qdmc"/>
		<result property="zdmc" column="zdmc"/>
		<result property="lyllqk" column="lyllqk"/>
		<result property="dlqlbm" column="dlqlbm"/>
		<result property="dlqlzxzh" column="dlqlzxzh"/>
	</resultMap>
	<select id="queryGcgjList"  parameterType="gcglgcgzsj" resultType="hashmap">
	select * from (
		select rownum num ,t.*,lxsh.ghlxbh,s.sl sl,nvl(xd.xdzj,0) xdzj,nvl(bf.bfzj,0) bfzj  from JHSH_SJGZ t left join lxsh_sjgz lxsh on t.xmbm=lxsh.xmbm left join (select count(*) sl, xmid xmbm from lxsh_lx where jdbs='2' group by xmid) s on t.xmbm=s.xmbm 
		left join gcgl_jgys jg on t.xmbm=jg.jhid
		left join (select xmid,sum(xdzj) xdzj from plan_zjxd group by xmid) xd on t.xmbm=xd.xmid
    	left join (select jhid,sum(cgsdwzj+stz+yhdk+gz+sz) bfzj from gcgl_cgs group by jhid) bf on t.xmbm=bf.jhid
		where 1=1
		<if test="jgys != null and  jgys != ''">
				and decode(jg.id,null,'否','是') = #{jgys}
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				and substr(t.xmbm,0,4) in (${sbnf})
		</if>
		<if test="shzt != null and  shzt != ''">
				and ${tiaojian} like '%'||trim(#{shzt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and lxsh.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and t.xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		and t.xmbm in (
				select xmid from lxsh_lx where 1=1 
				<if test="gydw!='' and gydw!= null ">
				${gydw}
				</if>
				<if test="lxmc != null and  lxmc != ''">
					and lxmc like '%'||trim(#{lxmc})||'%'
				</if>
				<if test="lxbm != null and  lxbm != ''">
					and lxbm like '%'||trim(#{lxbm})||'%'
				</if>
				<if test="jsdj != null and  jsdj != ''">
					and xjsdj like '%'||trim(#{jsdj})||'%'
				</if>
				<if test="gldj != null and  gldj != ''">
						and lxbm like trim(#{gldj})||'%'
				</if>
			)
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm
	</select>
	<select id="queryGcgjListCount" resultType="int" parameterType="gcglgcgzsj">
		select count(*)  from JHSH_SJGZ t left join gcgl_jgys jg on t.xmbm=jg.jhid
		where 1=1
		<if test="jgys != null and  jgys != ''">
				and decode(jg.id,null,'否','是') = #{jgys}
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				and substr(t.xmbm,0,4) in (${sbnf})
		</if>
		<if test="shzt != null and  shzt != ''">
				and ${tiaojian} like '%'||trim(#{shzt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and lxsh.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and t.xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		and t.xmbm in (
				select xmid from lxsh_lx where 1=1 
				<if test="gydw!='' and gydw!= null ">
				${gydw}
				</if>
				<if test="lxmc != null and  lxmc != ''">
					and lxmc like '%'||trim(#{lxmc})||'%'
				</if>
				<if test="lxbm != null and  lxbm != ''">
					and lxbm like '%'||trim(#{lxbm})||'%'
				</if>
				<if test="jsdj != null and  jsdj != ''">
					and xjsdj like '%'||trim(#{jsdj})||'%'
				</if>
				<if test="gldj != null and  gldj != ''">
						and lxbm like trim(#{gldj})||'%'
				</if>
			)
	</select>
	
	<select id="selectWqgzjhList2"  parameterType="gcglgcgzsj" resultType="hashmap">
	select * from (
		select rownum num ,t.*,lxsh.ghlxbh,s.sl sl,nvl(xd.xdzj,0) xdzj,nvl(bf.bfzj,0) bfzj  from JHSH_SJGZ t left join lxsh_sjgz lxsh on t.xmbm=lxsh.xmbm left join (select count(*) sl, xmid xmbm from lxsh_lx where jdbs='2' group by xmid) s on t.xmbm=s.xmbm left join (select max(jhid) jhid,sum(t.cgsdwzj) cgsdwzj,max(tbyf) tbyf,max(tbsj) tbsj,max(tbr) tbr,sum(stz) stz,max(cscyj) cscyj,sum(yhdk) yhdk,sum(gz) gz,sum(sz) sz from gcgl_cgs t  where tbyf=#{tbyf} group by jhid,t.tbyf) c on t.xmbm=c.jhid
		left join (select xmid jhid,WMSYS.WM_CONCAT(xdnf) xdsj from plan_zjxd group by xmid) xdjh on t.xmbm=xdjh.jhid
		left join (select 
	    (case when tb1.ztz&lt;=tb2.ztz then '已全部拨付'
	      else '未全部拨付' end) ljbfzt,tb1.xmid
	    from(select sum(pz.xdzj) ztz,xmid from plan_zjxd pz group by pz.xmid) tb1, 
	    (select sum(gc.cgsdwzj+gc.stz) ztz,jhid from gcgl_cgs gc group by gc.jhid) tb2
	    where tb1.xmid=tb2.jhid) tb3 on t.xmbm=tb3.xmid
	    left join (select xmid,sum(xdzj) xdzj from plan_zjxd group by xmid) xd on t.xmbm=xd.xmid
    	left join (select jhid,sum(cgsdwzj+stz+yhdk+gz+sz) bfzj from gcgl_cgs group by jhid) bf on t.xmbm=bf.jhid
			where 1=1 
			<!-- <if test="xdsj != null and  xdsj != ''">
			and xdjh.xdsj like '%'||trim(#{xdsj})||'%'
		</if> -->
			<if test="tiaojian != null and  tiaojian != ''">
				<if test="tiaojian =='未拨付'">
					and c.tbyf is null
				</if>
				<if test="tiaojian =='已拨付'">
					and c.tbyf is not null
				</if>
			</if>
		<if test="kgzt != null and  kgzt != ''">
				and t.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				${sbnf}
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and lxsh.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbfzt != null and  ljbfzt != ''">
			<if test="ljbfzt =='已全部拨付'">
				and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%'
			</if>
			<if test="ljbfzt =='未全部拨付'">
				and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%' or tb3.ljbfzt is null
			</if>
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and t.xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		and t.xmbm in (
				select xmid from lxsh_lx where 1=1 
				<if test="gydw!='' and gydw!= null ">
				${gydw}
				</if>
				<if test="lxmc != null and  lxmc != ''">
					and lxmc like '%'||trim(#{lxmc})||'%'
				</if>
				<if test="lxbm != null and  lxbm != ''">
					and lxbm like '%'||trim(#{lxbm})||'%'
				</if>
				<if test="jsdj != null and  jsdj != ''">
					and xjsdj like '%'||trim(#{jsdj})||'%'
				</if>
				<if test="gldj != null and  gldj != ''">
						and lxbm like trim(#{gldj})||'%'
				</if>
			)
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm 
	</select>
	<select id="selectWqgzjhListcount1" resultType="int" parameterType="gcglgcgzsj">
		select count(*) from JHSH_SJGZ t left join lxsh_sjgz lxsh on t.xmbm=lxsh.xmbm left join (select max(jhid) jhid,sum(t.cgsdwzj) cgsdwzj,max(tbyf) tbyf,max(tbsj) tbsj,max(tbr) tbr,sum(stz) stz,max(cscyj) cscyj,sum(yhdk) yhdk,sum(gz) gz,sum(sz) sz from gcgl_cgs t  where tbyf=#{tbyf} group by jhid,t.tbyf) c on t.xmbm=c.jhid
		left join (select xmid jhid,WMSYS.WM_CONCAT(xdnf) xdsj from plan_zjxd group by xmid) xdjh on t.xmbm=xdjh.jhid
		left join (select 
	    (case when tb1.ztz&lt;=tb2.ztz then '已全部拨付'
	      else '未全部拨付' end) ljbfzt,tb1.xmid
	    from(select sum(pz.xdzj) ztz,xmid from plan_zjxd pz group by pz.xmid) tb1, 
	    (select sum(gc.cgsdwzj+gc.stz) ztz,jhid from gcgl_cgs gc group by gc.jhid) tb2
	    where tb1.xmid=tb2.jhid) tb3 on t.xmbm=tb3.xmid
			where 1=1 
			<!-- <if test="xdsj != null and  xdsj != ''">
			and xdjh.xdsj like '%'||trim(#{xdsj})||'%'
		</if> -->
			<if test="tiaojian != null and  tiaojian != ''">
				<if test="tiaojian =='未拨付'">
					and c.tbyf is null
				</if>
				<if test="tiaojian =='已拨付'">
					and c.tbyf is not null
				</if>
			</if>
		<if test="kgzt != null and  kgzt != ''">
				and t.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				${sbnf}
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and lxsh.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbfzt != null and  ljbfzt != ''">
			<if test="ljbfzt =='已全部拨付'">
				and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%'
			</if>
			<if test="ljbfzt =='未全部拨付'">
				and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%' or tb3.ljbfzt is null
			</if>
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and t.xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		and t.xmbm in (
				select xmid from lxsh_lx where 1=1 
				<if test="gydw!='' and gydw!= null ">
				${gydw}
				</if>
				<if test="lxmc != null and  lxmc != ''">
					and lxmc like '%'||trim(#{lxmc})||'%'
				</if>
				<if test="lxbm != null and  lxbm != ''">
					and lxbm like '%'||trim(#{lxbm})||'%'
				</if>
				<if test="jsdj != null and  jsdj != ''">
					and xjsdj like '%'||trim(#{jsdj})||'%'
				</if>
				<if test="gldj != null and  gldj != ''">
						and lxbm like trim(#{gldj})||'%'
				</if>
			)
	</select>
	
	
	
	
	<select id="queryGsdList"  parameterType="gcglgcgzsj" resultType="hashmap">
	select * from (
		select rownum num ,t.*,s.sl sl,nvl(xd.xdzj,0) xdzj,nvl(bf.bfzj,0) bfzj  from GSDGZ t left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) lxsh on t.xmbm=lxsh.xmbm left join (select count(*) sl, xmid xmbm from lxsh_lx where jdbs='2' group by xmid) s on t.xmbm=s.xmbm 
		left join gcgl_jgys jg on t.xmbm=jg.jhid
		left join (select xmid,sum(xdzj) xdzj from plan_zjxd group by xmid) xd on t.xmbm=xd.xmid
    	left join (select jhid,sum(cgsdwzj+stz+yhdk+gz+sz) bfzj from gcgl_cgs group by jhid) bf on t.xmbm=bf.jhid
		where 1=1
		<if test="jgys != null and  jgys != ''">
				and decode(jg.id,null,'否','是') = #{jgys}
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				and substr(t.xmbm,0,4) in (${sbnf})
		</if>
		<if test="shzt != null and  shzt != ''">
				and ${tiaojian} like '%'||trim(#{shzt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and lxsh.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and t.xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="xmlx1 != null and  xmlx1 != ''">
				${xmlx1}
		</if>
		and t.xmbm in (
				select xmid from lxsh_lx where 1=1 
				<if test="gydw!='' and gydw!= null ">
				${gydw}
				</if>
				<if test="lxmc != null and  lxmc != ''">
					and lxmc like '%'||trim(#{lxmc})||'%'
				</if>
				<if test="lxbm != null and  lxbm != ''">
					and lxbm like '%'||trim(#{lxbm})||'%'
				</if>
				<if test="jsdj != null and  jsdj != ''">
					and xjsdj like '%'||trim(#{jsdj})||'%'
				</if>
				<if test="gldj != null and  gldj != ''">
						and lxbm like trim(#{gldj})||'%'
				</if>
			)
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm
	</select>
	<select id="queryGsdListCount" resultType="int" parameterType="gcglgcgzsj">
		select count(*)  from gsdgz t left join gcgl_jgys jg on t.xmbm=jg.jhid
		where 1=1
		<if test="jgys != null and  jgys != ''">
				and decode(jg.id,null,'否','是') = #{jgys}
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				and substr(t.xmbm,0,4) in (${sbnf})
		</if>
		<if test="shzt != null and  shzt != ''">
				and ${tiaojian} like '%'||trim(#{shzt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and lxsh.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and t.xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="xmlx1 != null and  xmlx1 != ''">
				${xmlx1}
		</if>
		and t.xmbm in (
				select xmid from lxsh_lx where 1=1 
				<if test="gydw!='' and gydw!= null ">
				${gydw}
				</if>
				<if test="lxmc != null and  lxmc != ''">
					and lxmc like '%'||trim(#{lxmc})||'%'
				</if>
				<if test="lxbm != null and  lxbm != ''">
					and lxbm like '%'||trim(#{lxbm})||'%'
				</if>
				<if test="jsdj != null and  jsdj != ''">
					and xjsdj like '%'||trim(#{jsdj})||'%'
				</if>
				<if test="gldj != null and  gldj != ''">
						and lxbm like trim(#{gldj})||'%'
				</if>
			)
	</select>
	
	<select id="selectgsdgzListbf"  parameterType="gcglgcgzsj" resultType="hashmap">
	select * from (
		select rownum num ,t.*,s.sl sl,nvl(xd.xdzj,0) xdzj,nvl(bf.bfzj,0) bfzj  from GSDGZ t left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) lxsh on t.xmbm=lxsh.xmbm left join (select count(*) sl, xmid xmbm from lxsh_lx where jdbs='2' group by xmid) s on t.xmbm=s.xmbm left join (select max(jhid) jhid,sum(t.cgsdwzj) cgsdwzj,max(tbyf) tbyf,max(tbsj) tbsj,max(tbr) tbr,sum(stz) stz,max(cscyj) cscyj,sum(yhdk) yhdk,sum(gz) gz,sum(sz) sz from gcgl_cgs t  where tbyf=#{tbyf} group by jhid,t.tbyf) c on t.xmbm=c.jhid
		left join (select xmid jhid,WMSYS.WM_CONCAT(xdnf) xdsj from plan_zjxd group by xmid) xdjh on t.xmbm=xdjh.jhid
		left join (select 
	    (case when tb1.ztz&lt;=tb2.ztz then '已全部拨付'
	      else '未全部拨付' end) ljbfzt,tb1.xmid
	    from(select sum(pz.xdzj) ztz,xmid from plan_zjxd pz group by pz.xmid) tb1, 
	    (select sum(gc.cgsdwzj+gc.stz) ztz,jhid from gcgl_cgs gc group by gc.jhid) tb2
	    where tb1.xmid=tb2.jhid) tb3 on t.xmbm=tb3.xmid
	    left join (select xmid,sum(xdzj) xdzj from plan_zjxd group by xmid) xd on t.xmbm=xd.xmid
    	left join (select jhid,sum(cgsdwzj+stz+yhdk+gz+sz) bfzj from gcgl_cgs group by jhid) bf on t.xmbm=bf.jhid
			where 1=1 
			<!-- <if test="xdsj != null and  xdsj != ''">
			and xdjh.xdsj like '%'||trim(#{xdsj})||'%'
		</if> -->
			<if test="tiaojian != null and  tiaojian != ''">
				<if test="tiaojian =='未拨付'">
					and c.tbyf is null
				</if>
				<if test="tiaojian =='已拨付'">
					and c.tbyf is not null
				</if>
			</if>
		<if test="kgzt != null and  kgzt != ''">
				and t.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				${sbnf}
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and lxsh.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbfzt != null and  ljbfzt != ''">
			<if test="ljbfzt =='已全部拨付'">
				and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%'
			</if>
			<if test="ljbfzt =='未全部拨付'">
				and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%' or tb3.ljbfzt is null
			</if>
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and t.xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="xmlx1 != null and  xmlx1 != ''">
				${xmlx1}
		</if>
		and t.xmbm in (
				select xmid from lxsh_lx where 1=1 
				<if test="gydw!='' and gydw!= null ">
				${gydw}
				</if>
				<if test="lxmc != null and  lxmc != ''">
					and lxmc like '%'||trim(#{lxmc})||'%'
				</if>
				<if test="lxbm != null and  lxbm != ''">
					and lxbm like '%'||trim(#{lxbm})||'%'
				</if>
				<if test="jsdj != null and  jsdj != ''">
					and xjsdj like '%'||trim(#{jsdj})||'%'
				</if>
				<if test="gldj != null and  gldj != ''">
						and lxbm like trim(#{gldj})||'%'
				</if>
			)
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm 
	</select>
	<select id="selectgsdgzListbfcount" resultType="int" parameterType="gcglgcgzsj">
		select count(*) from GSDGZ t left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) lxsh on t.xmbm=lxsh.xmbm left join (select max(jhid) jhid,sum(t.cgsdwzj) cgsdwzj,max(tbyf) tbyf,max(tbsj) tbsj,max(tbr) tbr,sum(stz) stz,max(cscyj) cscyj,sum(yhdk) yhdk,sum(gz) gz,sum(sz) sz from gcgl_cgs t  where tbyf=#{tbyf} group by jhid,t.tbyf) c on t.xmbm=c.jhid
		left join (select xmid jhid,WMSYS.WM_CONCAT(xdnf) xdsj from plan_zjxd group by xmid) xdjh on t.xmbm=xdjh.jhid
		left join (select 
	    (case when tb1.ztz&lt;=tb2.ztz then '已全部拨付'
	      else '未全部拨付' end) ljbfzt,tb1.xmid
	    from(select sum(pz.xdzj) ztz,xmid from plan_zjxd pz group by pz.xmid) tb1, 
	    (select sum(gc.cgsdwzj+gc.stz) ztz,jhid from gcgl_cgs gc group by gc.jhid) tb2
	    where tb1.xmid=tb2.jhid) tb3 on t.xmbm=tb3.xmid
			where 1=1 
			<!-- <if test="xdsj != null and  xdsj != ''">
			and xdjh.xdsj like '%'||trim(#{xdsj})||'%'
		</if> -->
			<if test="tiaojian != null and  tiaojian != ''">
				<if test="tiaojian =='未拨付'">
					and c.tbyf is null
				</if>
				<if test="tiaojian =='已拨付'">
					and c.tbyf is not null
				</if>
			</if>
		<if test="kgzt != null and  kgzt != ''">
				and t.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				${sbnf}
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and lxsh.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbfzt != null and  ljbfzt != ''">
			<if test="ljbfzt =='已全部拨付'">
				and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%'
			</if>
			<if test="ljbfzt =='未全部拨付'">
				and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%' or tb3.ljbfzt is null
			</if>
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and t.xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="xmlx1 != null and  xmlx1 != ''">
				${xmlx1}
		</if>
		and t.xmbm in (
				select xmid from lxsh_lx where 1=1 
				<if test="gydw!='' and gydw!= null ">
				${gydw}
				</if>
				<if test="lxmc != null and  lxmc != ''">
					and lxmc like '%'||trim(#{lxmc})||'%'
				</if>
				<if test="lxbm != null and  lxbm != ''">
					and lxbm like '%'||trim(#{lxbm})||'%'
				</if>
				<if test="jsdj != null and  jsdj != ''">
					and xjsdj like '%'||trim(#{jsdj})||'%'
				</if>
				<if test="gldj != null and  gldj != ''">
						and lxbm like trim(#{gldj})||'%'
				</if>
			)
	</select>
	
	
</mapper>