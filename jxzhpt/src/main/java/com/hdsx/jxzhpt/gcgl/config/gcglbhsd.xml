<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.gcglbhsd">

	<select id="selectBhsdYbByJhid" parameterType="gcglbhsd" resultType="gcglbhsd">
		select * from (
		select m.*,rownum rn from (
			select t1.*,t2.tbr,t2.tbsj,t2.tbyf,t2.cgsdwzj,t2.cscyj,t2.stz 
			from gcgl_bhsd t1 
			left join GCGL_CGS t2 on t1.jhid=t2.jhid and t1.sbyf=t2.tbyf
			where 1=1 and t1.sfsj &lt;=#{sfsj}
		<if test="jhid != null and  jhid != ''">
			and t1.jhid =#{jhid}
		</if>
		order by to_number(substr(sbyf,0,4))desc,to_number(replace(sbyf,'-','')) desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	<select id="selectBhsdYbByJhidCount" parameterType="gcglbhsd" resultType="int">
		select count(*) from gcgl_bhsd 
		where 1=1 and sfsj &lt;=#{sfsj}
		<if test="jhid != null and  jhid != ''">
			and jhid =#{jhid}
		</if>
	</select>
	
	<select id="selectBhsdYbByJhid1" parameterType="gcglbhsd" resultType="gcglbhsd">
		select * from (
		select m.*,rownum rn from (
			select t1.*,t2.tbr,t2.tbsj,t2.tbyf,t2.cgsdwzj,t2.cscyj,t2.stz 
			from gcgl_bhsd t1 left join GCGL_CGS t2 on t1.jhid=t2.jhid and t1.sbyf=t2.tbyf
			where 1=1 and sfsj=7
		<if test="jhid != null and  jhid != ''">
			and t1.jhid =#{jhid}
		</if>
		order by to_number(substr(sbyf,0,4))desc,to_number(replace(sbyf,'-','')) desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	
	<select id="selectBhsdYbByJhidCount1" parameterType="gcglbhsd" resultType="int">
		select count(*) from gcgl_bhsd 
		where 1=1 and sfsj=7
		<if test="jhid != null and  jhid != ''">
			and jhid =#{jhid}
		</if>
	</select>
	
	<!-- 添加月报 -->
	<insert id="insertBhsdYb" parameterType="gcglbhsd">
		insert into gcgl_bhsd(id,jhid,wc_btz,wc_stz,wc_qttz,zjdw_btz,zjdw_stz,zjdw_qttz,qksm,wcqk,
		sbsj,sbyf,shzt,sfsj,sfth,tbman)
		values(sys_guid(),#{jhid},#{wc_btz,jdbcType=VARCHAR},#{wc_stz,jdbcType=VARCHAR},#{wc_qttz,jdbcType=VARCHAR},
		#{zjdw_btz,jdbcType=VARCHAR},#{zjdw_stz,jdbcType=VARCHAR},#{zjdw_qttz,jdbcType=VARCHAR},
		#{qksm,jdbcType=VARCHAR},#{wcqk,jdbcType=VARCHAR},#{sbsj},#{sbyf},#{shzt},#{sfsj},'否',tbman)
	</insert>
	
	<select id="queryYbByYf" parameterType="gcglbhsd" resultType="gcglbhsd">
		select * from gcgl_bhsd where sbsj=#{sbsj} and id=#{jhid}
	</select>
	
	<!-- 修改月报 -->
	<update id="updateBhsdYb" parameterType="gcglbhsd">
		update gcgl_bhsd set wc_btz=#{wc_btz,jdbcType=VARCHAR},wc_stz=#{wc_stz,jdbcType=VARCHAR},wc_qttz=#{wc_qttz,jdbcType=VARCHAR},
		zjdw_btz=#{zjdw_btz,jdbcType=VARCHAR},
		zjdw_stz=#{zjdw_stz,jdbcType=VARCHAR},zjdw_qttz=#{zjdw_qttz,jdbcType=VARCHAR},
		qksm=#{qksm,jdbcType=VARCHAR},wcqk=#{wcqk,jdbcType=VARCHAR},sbyf=#{sbyf},sbsj=#{sbsj},tbman=#{tbman}
		where id=#{id} and jhid=#{jhid}
	</update>
	
	<!-- 修改月报状态 -->
	<update id="sbBhsdYb" parameterType="gcglbhsd">
		update gcgl_bhsd set sfsj=#{sfsj},yb_thyj=#{yb_thyj}
		where id=#{id}
	</update>
	
	<!-- 删除月报 -->
	<delete id="deleteBhsdYb" parameterType="gcglbhsd">
		delete from gcgl_bhsd where id=#{id}
	</delete>
	
	<!-- 审核月报 -->
	<update id="shbhsdyb" parameterType="gcglbhsd">
		update gcgl_bhsd set shuser=#{shuser},shtime=#{shtime},shzt='已审核'
		where id=#{id} and jhid=#{jhid}
	</update>
	
	<!-- 添加车购税 -->
	<insert id="insertBhsdCgs" parameterType="gcglbhsd">
		insert into GCGL_CGS(id,jhid,cgsdwzj,tbr,tbyf,tbsj,stz,cscyj)
		values(sys_guid(),#{jhid},#{cgsdwzj},#{tbr},#{tbyf},#{tbsj},#{stz},#{cscyj})
	</insert>
	
	<select id="queryCGSByYf" parameterType="gcglbhsd" resultType="gcglbhsd">
		select * from GCGL_CGS where tbyf=#{tbyf} and jhid=#{jhid}
	</select>
	
	<!-- 查询cgs -->
	<select id="selectBhsdCgsList" parameterType="gcglbhsd" resultType="gcglbhsd">
		select * from (
		select m.*,rownum rn from (
			select t1.*,t2.sbsj,t2.sbyf from GCGL_CGS t1 
			left join gcgl_bhsd t2 on t1.jhid=t2.jhid and t1.tbyf=t2.sbyf
			where 1=1
		<if test="jhid != null and  jhid != ''">
			and t1.jhid =#{jhid}
		</if>
		order by to_number(substr(tbyf,0,4))desc,to_number(replace(tbyf,'-','')) desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	
	<select id="selectBhsdCgsListCount" parameterType="gcglbhsd" resultType="int">
		select count(*) from GCGL_CGS 
		where 1=1
		<if test="jhid != null and  jhid != ''">
			and jhid =#{jhid}
		</if>
	</select>
	
	<!-- 删除cgs -->
	<delete id="deletebhsdCgs" parameterType="gcglbhsd">
		delete from GCGL_CGS where id=#{id}
	</delete>
	
	<!-- 修改cgs -->
	<update id="updateBhsdCgs" parameterType="gcglbhsd">
		update GCGL_CGS set cgsdwzj=#{cgsdwzj},tbyf=#{tbyf},stz=#{stz},cscyj=#{cscyj}
		where id=#{id} and jhid=#{jhid}
	</update>
	
	<!-- 上传 -->
	<update id="uploadBhsdFilesgxk" parameterType="gcglbhsd">
		update PLAN_BHSD set SGXKWJ=#{tiaojian},SGXKWJFILE=#{sgxkwjfile}
		where =ID#{jhid}
	</update>
	
	<update id="uploadBhsdFilejgtc" parameterType="gcglbhsd">
		update plan_bhsd set JGTCWJ=#{tiaojian},JGTCWJFILE=#{jgtcwjfile}
		where ID=#{jhid}
	</update>
		<update id="uploadBhsdFilejgys" parameterType="gcglbhsd">
		update PLAN_BHSD set JGYSWJ=#{tiaojian},JGYSWJFILE=#{jgyswjfile}
		where ID=#{jhid}
	</update>
	
	<!-- 下载 -->
	<select id="downBhsdFile" parameterType="gcglbhsd" resultType="gcglbhsd">
		select ${tiaojian} tiaojian,${lxmc} sgxkwjfile from PLAN_BHSD where ID=#{jhid}
	</select>
	<update id="insertBhsdwwg" parameterType="gcglbhsd">
		update PLAN_BHSD set WJGYY=#{wjgyy} where ID=#{jhid}
	</update>
	
	<update id="insertBhsdwg" parameterType="gcglbhsd">
		update PLAN_BHSD set SJWGSJ=#{sjwgsj},JGZT=#{jgzt} where ID=#{jhid}
	</update>
	<update id="insertBhsdkg" parameterType="gcglbhsd">
		update PLAN_BHSD set xdsj=#{xdsj},jhxdwh=#{xdwh},kgzt=#{kgzt},sjkgsj=#{sjkgsj},yjjgsj=#{yjjgsj},sgdw=#{sgdw},
		jldw=#{jldw},jsdw=#{jsdw},htje=#{htje},gys=#{gys} where ID=#{jhid}
	</update>
	
	<select id="selectBhsdjhList" parameterType="gcglbhsd" resultType="gcglbhsd">
		select * from (
		select m.*,rownum rn from (
		select 
	    t1.sbnf,t1.jhkgsj,t1.jhwgsj,t1.sjdw,t1.sjpfdw,t1.pfwh,t1.pfsj,t1.pfztz,t1.jhsybzje,t1.jhsydfzcje,
	    t1.gkbglj,t1.gkbgmc,t1.sjsgtlj,t1.sjsgtmc,t1.bz jhbz,t1.xdsj,t1.jhxdwh xdwh,
	    t1.sjkgsj,t1.ID jhid,t1.id,t3.sdcd,t3.sdkd,t3.sdgd,
	    t1.yjjgsj,t1.sgdw,t1.jldw,t1.jsdw,t1.gys,t1.htje,t1.sjwgsj,t1.kgzt,t1.jgzt,t1.wjgyy,t1.sgxkwj,t1.jgtcwj,t1.jgyswj,
	    t3.sdmc,t3.sddm,t3.sdzxzh,t3.xzqhmc,t3.xzqhdm,t3.gydw,t3.lxmc,t3.lxbm,t3.jsdj,t3.pddj,t3.xjgjnd,t3.acdfl,t3.xmnf,t3.xmtype,t3.bhnr,
	    t2.tzgs,t2.spwh,t2.sck_jsxz,t2.zyjsnr,t2.scbz
	    from PLAN_BHSD t1 left join SCK_BHSD  t2 on t1.SCKID=t2.SCKID
            left join XMK_BHSD t3 on t2.xmkid=t3.id
		    where  t1.spzt='1' 
<!-- 	    <if test="xtType!='' and xtType!= null "> -->
<!-- 				${xtType} -->
<!-- 		</if> -->
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
<!-- 		<if test="tbbmbm!='' and tbbmbm!= null "> -->
<!-- 				and t3.tbbmbm like '%'||(#{tbbmbm})||'%' -->
<!-- 		</if> -->
		<if test="kgzt != null and  kgzt != ''">
				and t1.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t1.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and t1.sbnf like '%'||trim(#{xmnf})||'%'
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and t3.lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="sdmc != null and  sdmc != ''">
				and t3.sdmc like '%'||trim(#{sdmc})||'%'
		</if>
		<if test="sddm != null and  sddm != ''">
				and t3.sddm like '%'||trim(#{sddm})||'%'
		</if>
		<if test="shzt != null and  shzt != ''">
				and ${tiaojian} like '%'||trim(#{shzt})||'%'
		</if>
		order by t1.sbnf
		) m
				where <![CDATA[rownum<=(#{page} * #{rows})]]>
			) 
				where RN>((#{page} - 1) * #{rows})
	</select>
	
	 <select id="selectBhsdjhListCount" parameterType="gcglbhsd" resultType="int">
	 	select count(*) from  PLAN_BHSD t1 left join SCK_BHSD  t2 on t1.SCKID=t2.SCKID 
	 	left join XMK_BHSD t3 on t2.xmkid=t3.id  
		where  t1.spzt='1' 
<!-- 	    <if test="xtType!='' and xtType!= null "> -->
<!-- 				${xtType} -->
<!-- 		</if> -->
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
<!-- 		<if test="tbbmbm!='' and tbbmbm!= null "> -->
<!-- 				and t3.tbbmbm like '%'||(#{tbbmbm})||'%' -->
<!-- 		</if> -->
		<if test="kgzt != null and  kgzt != ''">
				and t1.kgzt like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t1.jgzt like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and t1.sbnf like '%'||trim(#{xmnf})||'%'
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and t3.lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="sdmc != null and  sdmc != ''">
				and t3.sdmc like '%'||trim(#{sdmc})||'%'
		</if>
		<if test="sddm != null and  sddm != ''">
				and t3.sddm like '%'||trim(#{sddm})||'%'
		</if>
		<if test="shzt != null and  shzt != ''">
				and ${tiaojian} like '%'||trim(#{shzt})||'%'
		</if>	
	 </select>
	 
	 <select id="selectBhsdjhFile" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select sgxkwj,jgtcwj,jgyswj from PLAN_BHSD where ID=#{jhid}
	 </select>
	 
	 <select id="selectBhsdzyf" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select tbyf,cgsdwzj from GCGL_CGS where jhid=#{jhid} 
	 	order by to_number(substr(tbyf,0,4))desc,to_number(replace(tbyf,'-','')) desc
	 </select>
	 
	 <select id="selectBhsdwcqkmin" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select max(wcqk) wcqkmin 
	 	from gcgl_bhsd 
	 	where 1=1 and jhid=#{jhid}
	 	and	to_date(sbyf,'yyyy-mm')&lt;to_date(#{sbyf},'yyyy-mm') 
	 </select>
	 
	 <select id="selectBhsdwcqkmax" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select min(wcqk) wcqkmax 
	 	from gcgl_bhsd 
	 	where 1=1 and jhid=#{jhid}
	 	and	to_date(sbyf,'yyyy-mm')&gt;to_date(#{sbyf},'yyyy-mm') 
	 </select>	 
	 
	 <select id="selectbhzj1" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select sum(cgsdwzj)+sum(stz) zbfzj from gcgl_cgs where jhid=#{jhid}
	 </select>
	 
	  <select id="selectwqzj2" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select sum(cgsdwzj)+sum(stz) nbfzj from gcgl_cgs where jhid=#{jhid} and tbyf like #{nf}||'%'
	 </select>
	 
	  <select id="selectwqzj3" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select sum(btzzj)+sum(stz) nxdzj from PLAN_ZJXD where xmid=#{id} and xdnf like #{nf}||'%'
	 </select>
	 
	 <select id="selectwqzj4" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select sum(btzzj)+sum(stz) zxdzj from PLAN_ZJXD where xmid=#{id}
	 </select>
	 
	 <update id="updateSjZT" parameterType="gcglbhsd" >
	 update PLAN_BHSD set sjzt=#{sjzt} where id=#{jhid}
	 </update>
	 
	 <update id="updateXjZT" parameterType="gcglbhsd" >
	 update plan_bhsd set xjzt=#{xjzt} where id=#{jhid}
	 </update>
	 <update id="updateSJSH" parameterType="gcglbhsd" >
	 update plan_bhsd set sjsh=#{sjsh} where id=#{jhid}
	 </update>
	  <update id="updatezdyf" parameterType="gcglbhsd" >
	 update plan_bhsd set zdyf=#{sbyf} where id=#{jhid}
	 </update>
	 <select id="selectnumbyyh" parameterType="gcglbhsd" resultType="int">
	 	select count(*) from gcgl_bhsd 
		where jhid=#{jhid} and sfsj=#{yhtype} and shzt='未审核'
	 </select>
	 
	 <!-- 查询每月的车购税 -->
	 <select id="selectcgsyf" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select cgsdwzj zjdw_btz,stz zjdw_stz from gcgl_cgs where tbyf=#{tbyf} and jhid=#{jhid}
	 </select>
	 
	 <!-- 查询最进展大月份 -->
	 <select id="querymaxybyf" parameterType="gcglbhsd" resultType="gcglbhsd">
	 	select max(sbyf) sbyf from gcgl_bhsd where jhid=#{jhid}
	 </select>
	 
	  <!-- 拨付资金列表 -->
	 <select id="selectBhsdjhList1" parameterType="gcglbhsd" resultType="gcglbhsd">
		select * from (
		select m.*,rownum rn from (
		select 
		t1.sbnf,t1.jhkgsj,t1.jhwgsj,t1.sjdw,t1.sjpfdw,t1.pfwh,t1.pfsj,t1.pfztz,t1.jhsybzje,t1.jhsydfzcje,
	    t1.gkbglj,t1.gkbgmc,t1.sjsgtlj,t1.sjsgtmc,t1.bz jhbz,t1.xdsj,t1.jhxdwh xdwh,
	    t1.sjkgsj,t1.ID jhid,t1.id,t3.sdcd,t3.sdkd,t3.sdgd,
	    t1.yjjgsj,t1.sgdw,t1.jldw,t1.jsdw,t1.gys,t1.htje,t1.sjwgsj,t1.kgzt,t1.jgzt,t1.wjgyy,t1.sgxkwj,t1.jgtcwj,t1.jgyswj,
	    t3.sdmc,t3.sddm,t3.sdzxzh,t3.xzqhmc,t3.xzqhdm,t3.gydw,t3.lxmc,t3.lxbm,t3.jsdj,t3.pddj,t3.xjgjnd,t3.acdfl,t3.xmnf,t3.xmtype,t3.bhnr,
	    t2.tzgs,t2.spwh,t2.sck_jsxz,t2.zyjsnr,t2.scbz
		from PLAN_Bhsd t1 left join SCK_BHSD  t2 on t1.SCKID=t2.SCKID left join XMK_BHSD t3 on t2.xmkid=t3.id left join (select max(jhid) jhid,sum(t.cgsdwzj) cgsdwzj,max(tbyf) tbyf,max(tbsj) tbsj,max(tbr) tbr,sum(stz) stz,max(cscyj) cscyj,sum(yhdk) yhdk,sum(gz) gz,sum(sz) sz from gcgl_cgs t  where tbyf=#{tbyf} group by jhid,t.tbyf) c on t1.id=c.jhid
		left join (select xmid jhid,WMSYS.WM_CONCAT(xdnf) xdsj from plan_zjxd group by xmid) xdjh on t1.id=xdjh.jhid
		left join (select 
	    (case when tb1.ztz&lt;=tb2.ztz then '已全部拨付'
	      else '未全部拨付' end) ljbfzt,tb1.xmid
	    from(select sum(pz.xdzj) ztz,xmid from plan_zjxd pz group by pz.xmid) tb1, 
	    (select sum(gc.cgsdwzj+gc.stz) ztz,jhid from gcgl_cgs gc group by gc.jhid) tb2
	    where tb1.xmid=tb2.jhid) tb3 on t1.id=tb3.xmid
	 	where t1.spzt='1' 
	 		<!-- <if test="xdsj != null and  xdsj != ''">
			and xdjh.xdsj like '%'||trim(#{xdsj})||'%'
			</if> -->
				<if test="xmnf != null and  xmnf != ''">
				and xdjh.xdsj like '%'||trim(#{xmnf})||'%'
			</if>
<!-- 			<if test="sfylrbwqk != null and  sfylrbwqk != ''"> -->
<!-- 					and t1.sfylrbwqk = #{sfylrbwqk} -->
<!-- 			</if> -->
			<if test="gydw != null and  gydw != ''">
					${gydw}
			</if>
<!-- 			<if test="gydwtj != null and  gydwtj != ''"> -->
<!-- 					${gydwtj} -->
<!-- 			</if> -->
			<if test="xzqhdm != null and  xzqhdm != ''">
					${xzqhdm}
			</if>
			<if test="kgzt != null and  kgzt != ''">
					and t1.kgzt like '%'||trim(#{kgzt})||'%'
			</if>
			<if test="jgzt != null and  jgzt != ''">
					and t1.jgzt like '%'||trim(#{jgzt})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="sdmc != null and  sdmc != ''">
					and t3.sdmc like '%'||trim(#{sdmc})||'%'
			</if>
			<if test="sddm != null and  sddm != ''">
			and t3.sddm like '%'||trim(#{sddm})||'%'
			</if>
			<if test="gldj != null and  gldj != ''">
					and t3.lxbm like trim(#{gldj})||'%'
			</if>
<!-- 			<if test="tsdq != null and  tsdq != ''"> -->
<!-- 					and t3.tsdq like '%'||trim(#{tsdq})||'%' -->
<!-- 			</if> -->
			<if test="ljbfzt != null and  ljbfzt != ''">
					<if test="ljbfzt =='已全部拨付'">
					and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%'
				</if>
				<if test="ljbfzt =='未全部拨付'">
					and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%' or tb3.ljbfzt is null
				</if>
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
				<if test="tiaojian =='未拨付'">
					and c.tbyf is null
				</if>
				<if test="tiaojian =='已拨付'">
					and c.tbyf is not null
				</if>
			</if>
			order by t1.sbnf
			) m
					where <![CDATA[rownum<=(#{page} * #{rows})]]>
				) 
					where RN>((#{page} - 1) * #{rows})
	</select>
	<select id="selectBhsdjhListcount1" parameterType="gcglbhsd" resultType="int">
	 	select count(*) from  PLAN_BHSD t1 left join SCK_BHSD  t2 on t1.SCKID=t2.SCKID 
	 	left join XMK_BHSD t3 on t2.xmkid=t3.id 
	 	left join (select max(jhid) jhid,sum(t.cgsdwzj) cgsdwzj,max(tbyf) tbyf,max(tbsj) tbsj,max(tbr) tbr,
	 	sum(stz) stz,max(cscyj) cscyj,sum(yhdk) yhdk,sum(gz) gz,sum(sz) sz from gcgl_cgs t  
	 	where tbyf=#{tbyf} group by jhid,t.tbyf) c on t1.id=c.jhid
		left join (select xmid jhid,WMSYS.WM_CONCAT(xdnf) xdsj from plan_zjxd group by xmid) xdjh on t1.id=xdjh.jhid
		left join (select 
	    (case when tb1.ztz&lt;=tb2.ztz then '已全部拨付'
	      else '未全部拨付' end) ljbfzt,tb1.xmid
	    from(select sum(pz.xdzj) ztz,xmid from plan_zjxd pz group by pz.xmid) tb1, 
	    (select sum(gc.cgsdwzj+gc.stz) ztz,jhid from gcgl_cgs gc group by gc.jhid) tb2
	    where tb1.xmid=tb2.jhid) tb3 on t1.id=tb3.xmid
	 	where t1.spzt='1' 
	 		<!-- <if test="xdsj != null and  xdsj != ''">
				and xdjh.xdsj like '%'||trim(#{xdsj})||'%'
			</if> -->
			<if test="xmnf != null and  xmnf != ''">
				and xdjh.xdsj like '%'||trim(#{xmnf})||'%'
			</if>
<!-- 			<if test="sfylrbwqk != null and  sfylrbwqk != ''"> -->
<!-- 					and t1.sfylrbwqk = #{sfylrbwqk} -->
<!-- 			</if> -->
			<if test="gydw != null and  gydw != ''">
					${gydw}
			</if>
<!-- 			<if test="gydwtj != null and  gydwtj != ''"> -->
<!-- 					${gydwtj} -->
<!-- 			</if> -->
			<if test="xzqhdm != null and  xzqhdm != ''">
					${xzqhdm}
			</if>
			<if test="kgzt != null and  kgzt != ''">
					and t1.kgzt like '%'||trim(#{kgzt})||'%'
			</if>
			<if test="jgzt != null and  jgzt != ''">
					and t1.jgzt like '%'||trim(#{jgzt})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="sdmc != null and  sdmc != ''">
					and t3.sdmc like '%'||trim(#{sdmc})||'%'
			</if>
			<if test="sddm != null and  sddm != ''">
			and t3.sddm like '%'||trim(#{sddm})||'%'
			</if>
			<if test="gldj != null and  gldj != ''">
					and t3.lxbm like trim(#{gldj})||'%'
			</if>
<!-- 			<if test="tsdq != null and  tsdq != ''"> -->
<!-- 					and t3.tsdq like '%'||trim(#{tsdq})||'%' -->
<!-- 			</if> -->
			<if test="ljbfzt != null and  ljbfzt != ''">
					<if test="ljbfzt =='已全部拨付'">
					and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%'
				</if>
				<if test="ljbfzt =='未全部拨付'">
					and tb3.ljbfzt like '%'||trim(#{ljbfzt})||'%' or tb3.ljbfzt is null
				</if>
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
				<if test="tiaojian =='未拨付'">
					and c.tbyf is null
				</if>
				<if test="tiaojian =='已拨付'">
					and c.tbyf is not null
				</if>
			</if>
			
	 </select>
</mapper>