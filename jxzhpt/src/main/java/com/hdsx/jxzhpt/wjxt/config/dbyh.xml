<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.dbyh">


 <select id="selectList1" statementType="CALLABLE" resultType="hashmap">  
    {call getRepItemMx()}  
  </select>  
<!--   <select id="selectList2" parameterType="zdxx" resultType="hashmap"> -->
<!-- 	select * from smOrg where sPcode = #{gydw} order by sOrgCode -->
<!-- </select> -->
  
<select id="selectList3" parameterType="zdxx" resultType="zdxx">
	select distinct D.iOrgID id from smOrg D inner join smOrg F on D.sPCode = F.sOrgCode where F.sPcode=#{gydw} or D.sPcode=#{gydw}
</select>
  <select id="selectList4" parameterType="zdxx" resultType="hashmap">
	select DepID iOrgID,ISNULL(SUM(mWorkNum),0) as mWorkNum,sItemCode from 
(select W.*,case when D.sPCode=#{gydw} then W.iOrgID else F.iOrgID end DepID
from wkWorkReal W left join smOrg D on W.iOrgID=D.iOrgID
left join smOrg F on D.sPcode=F.sOrgCode) wkWorkReal
where ${tiaojian} and iYear = #{nian} and iMonth = #{yue} group by wkWorkReal.sItemCode,DepID

</select>
  <select id="selectList5" parameterType="zdxx" resultType="hashmap">
	select ISNULL(SUM(mWorkNum),0) as mWorkNum,sItemCode from wkWorkReal 
	where ${tiaojian} and iYear = #{nian} and iMonth = #{yue} group by wkWorkReal.sItemCode

</select>

   <select id="selectxhbList4" parameterType="zdxx" resultType="hashmap">
	select DepID iOrgID,ISNULL(SUM(mNums),0) as mNums,sItemCode,iType from (select W.*,case when D.sPCode=#{gydw} then W.iOrgID else F.iOrgID end DepID
from wkStuffWork W left join smOrg D on W.iOrgID=D.iOrgID
left join smOrg F on D.sPcode=F.sOrgCode)wkStuffWork where ${tiaojian} and iYear = #{nian} and iMonth = #{yue} group by DepID,iType,sItemCode

</select>
  <select id="selectxhbList5" parameterType="zdxx" resultType="hashmap">
	select ISNULL(SUM(mNums),0) as mNums,sItemCode,iType from wkStuffWork 
	where ${tiaojian} and iYear = #{nian} and iMonth = #{yue} group by sItemCode,iType

</select>
  
  
  <insert id="insertYBBData" parameterType="hashMap">
		insert into YHTJ_YBB(id,ybyf,v_0,v_1,v_2,v_3,v_5,v_6,v_7,v_8,v_9,v_10,v_11,v_12,v_13,v_14,v_15,v_16,v_17,v_18,v_19,v_20,v_21,v_22,v_23,v_24,v_25,v_26,v_27,v_28,v_29,v_30,v_31,v_32,v_33,v_34,v_35,v_36,v_37,xh,v_38,v_39,v_40,v_4)
		values(#{id},#{ybyf},#{0},#{1},#{2},#{3},#{5},#{6},#{7},#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17},#{18},#{19},#{20},#{21},#{22},#{23},#{24},#{25},#{26},#{27},#{28},#{29},#{30},#{31},#{32},#{33},#{34},#{35},#{36},#{37},#{xh},#{38},#{39},#{40},#{4})
	</insert>
	<select id="selectybbbyYf" parameterType="String" resultType="hashmap">
		select * from YHTJ_YBB where ybyf=#{value}
	</select>
	<delete id="delete_ybb" parameterType="String">
		delete from YHTJ_YBB where ybyf=#{value}
	</delete>
	<select id="selectList2" parameterType="zdxx" resultType="hashmap">
		select * from YHTJ_YBB where ybyf=#{nian}||'-'||#{yue} order by to_number(xh)
	</select>
	
	 <insert id="insertXHBData" parameterType="hashMap">
		insert into YHTJ_CLXHB(id,ybyf,xh,v_0,v_1,v_2,v_3,v_4,v_5,v_6,v_7,v_8,v_9,v_10,v_11,v_12,v_13,v_14,v_15,v_16,v_17,v_18,v_19,v_20,v_21,v_22,v_23,v_24,v_25,v_26,v_27,v_28,v_29,v_30)
		values(#{id},#{ybyf},#{xh},#{0},#{1},#{2},#{3},#{4},#{5},#{6},#{7},#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17},#{18},#{19},#{20},#{21},#{22},#{23},#{24},#{25},#{26},#{27},#{28},#{29},#{30})
	</insert>
	<select id="selectxhbbyYf" parameterType="String" resultType="hashmap">
		select * from YHTJ_CLXHB where ybyf=#{value}
	</select>
	<select id="selectxhbList1" parameterType="zdxx" resultType="hashmap">  
    	select * from YHTJ_CLXHB where ybyf=#{nian}||'-'||#{yue} order by to_number(xh)
  </select> 
  <delete id="delete_xhb" parameterType="String">
		delete from YHTJ_CLXHB where ybyf=#{value}
	</delete>
	
	<insert id="insertFXBData" parameterType="hashMap">
		insert into YHTJ_FXB(id,ybyf,xh,v_0,v_1,v_2,v_3,v_4,v_5,v_6,v_7,v_8,v_9,v_10,v_11)
		values(#{id},#{ybyf},#{xh},#{0},#{1},#{2},#{3},#{4},#{5},#{6},#{7},#{8},#{9},#{10},#{11})
	</insert>
	<select id="selectfxbbyYf" parameterType="String" resultType="hashmap">
		select * from YHTJ_FXB where ybyf=#{value}
	</select>
	<select id="selectfxbList1" parameterType="zdxx" resultType="hashmap">  
   		select * from YHTJ_FXB where ybyf=#{nian}||'-'||#{yue} order by to_number(xh)
  	</select>  
  	<delete id="delete_fxb" parameterType="String">
		delete from YHTJ_FXB where ybyf=#{value}
	</delete>
	
	<insert id="insertPDBData" parameterType="hashMap">
		insert into YHTJ_PDB(id,ybyf,xh,v_0,v_1,v_2,v_3,v_4,v_5,v_6,v_7,v_8,v_9,v_10,v_11,v_12,v_13,v_14,v_15,v_16,v_17,v_18,v_19,v_20,v_21,v_22,v_23,v_24,v_25,v_26,v_27,v_28,v_29,v_30)
		values(#{id},#{ybyf},#{xh},#{0},#{1},#{2},#{3},#{4},#{5},#{6},#{7},#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17},#{18},#{19},#{20},#{21},#{22},#{23},#{24},#{25},#{26},#{27},#{28},#{29},#{30})
	</insert>
	<select id="selectpdbbyYf" parameterType="String" resultType="hashmap">
		select * from YHTJ_PDB where ybyf=#{value}
	</select>
	<select id="selectPdbList" statementType="CALLABLE" resultType="hashmap">  
   		select * from YHTJ_PDB where ybyf=#{nian}||'-'||#{yue} order by to_number(xh)
 	 </select>  
	<delete id="delete_pdb" parameterType="String">
		delete from YHTJ_PDB where ybyf=#{value}
	</delete>
	
	<insert id="insertYLBData" parameterType="hashMap">
		insert into YHTJ_YLB(id,ybyf,xh,v_0,v_1,v_2,v_3,v_4,v_5,v_6,v_7,v_8,v_9,v_10,v_11,v_12,v_13)
		values(#{id},#{ybyf},#{xh},#{0},#{1},#{2},#{3},#{4},#{5},#{6},#{7},#{8},#{9},#{10},#{11},#{12},#{13})
	</insert>
	<select id="selectylbbyYf" parameterType="String" resultType="hashmap">
		select * from YHTJ_YLB where ybyf=#{value}
	</select>
	 <select id="selectYlbList" statementType="CALLABLE" resultType="hashmap">  
    	select * from YHTJ_YLB where ybyf=#{nian}||'-'||#{yue} order by to_number(xh)
 	</select> 
 	<delete id="delete_ylb" parameterType="String">
		delete from YHTJ_YLB where ybyf=#{value}
	</delete>
</mapper>