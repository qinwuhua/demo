<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.wjgl">
	<insert id="uploadWjFile" parameterType="wjgl" >
		insert into zcwj_file(id,wjid,wjfile,wjname)
		values(#{id},#{wjid},#{wjfile},#{wjname})
	</insert>
	<delete id="deleteWjfile" parameterType="wjgl" >
		delete from zcwj_file where id=#{id}
	</delete>
	<select id="selectzcwjbyid" parameterType="string" resultType="wjgl">
		select * from ZCWJ_ZCWJ where id=#{value}
	</select>
	<select id="selectqtwjbyid" parameterType="string" resultType="wjgl">
		select * from ZCWJ_QTWJ where id=#{value}
	</select>
	<delete id="deleteWjfile1" parameterType="string" >
		delete from zcwj_file where wjid=#{value}
	</delete>
	<insert id="insertZcwj" parameterType="wjgl">
		insert into ZCWJ_ZCWJ(id,fbsj,fbr,wjmc,wjgy,jsdw,fbdw)
		values(#{id},to_char(sysdate,'yyyy-mm-dd'),#{fbr},#{wjmc},#{wjgy},#{jsdw},#{fbdw})
	</insert>
	<insert id="insertQtwj" parameterType="wjgl">
		insert into ZCWJ_QTWJ(id,fbsj,fbr,wjmc,wjgy,jsdw,fbdw)
		values(#{id},to_char(sysdate,'yyyy-mm-dd'),#{fbr},#{wjmc},#{wjgy},#{jsdw},#{fbdw})
	</insert>
	<insert id="insertJhwj" parameterType="wjgl">
		insert into ZCWJ_JHWJ(id,fbsj,fbr,wjmc,wjgy,fbdw)
		values(#{id},to_char(sysdate,'yyyy-mm-dd'),#{fbr},#{wjmc},#{wjgy},#{fbdw})
	</insert>
	<update id="updateZcwj" parameterType="wjgl">
		update ZCWJ_ZCWJ set wjmc=#{wjmc},wjgy=#{wjgy},jsdw=#{jsdw}
		where id=#{id}
	</update>
	<update id="updateQtwj" parameterType="wjgl">
		update ZCWJ_QTWJ set wjmc=#{wjmc},wjgy=#{wjgy},jsdw=#{jsdw}
		where id=#{id}
	</update>
	<update id="updateJhwj" parameterType="wjgl">
		update ZCWJ_JHWJ set wjmc=#{wjmc},wjgy=#{wjgy}
		where id=#{id}
	</update>
	<delete id="deleteZcwj" parameterType="wjgl">
		delete from ZCWJ_ZCWJ where id=#{id}
	</delete>
	<delete id="deleteQtwj" parameterType="wjgl">
		delete from ZCWJ_QTWJ where id=#{id}
	</delete>
	<delete id="deleteJhwj" parameterType="wjgl">
		delete from ZCWJ_JHWJ where id=#{id}
	</delete>
	<select id="selectzcwjlist" parameterType="wjgl" resultType="wjgl">
		select * from (
		select m.*,rownum rn from (
			select * from ZCWJ_ZCWJ 
			where 1=1
			<if test="jsdw != null and  jsdw != ''">
			and trim(#{jsdw}) like '%'||fbdw||'%'
			</if>
			<if test="wjmc != null and  wjmc != ''">
			and wjmc like '%'||#{wjmc}||'%'
			</if>
			<if test="kssj != null  and kssj != ''">
					and to_date(fbsj,'yyyy-mm-dd') >= to_date(#{kssj},'yyyy-mm-dd')
			</if>
			<if test="jssj != null and jssj != ''">
					<![CDATA[and to_date(fbsj,'yyyy-mm-dd') <= to_date(#{jssj},'yyyy-mm-dd')]]>
			</if>
		order by fbsj desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	<select id="selectzcwjlistCount" parameterType="wjgl" resultType="int">
		select count(*) from ZCWJ_ZCWJ 
			where 1=1
			<if test="jsdw != null and  jsdw != ''">
			and trim(#{jsdw}) like '%'||fbdw||'%'
			</if>
			<if test="wjmc != null and  wjmc != ''">
				and wjmc like '%'||#{wjmc}||'%'
			</if>
			<if test="kssj != null  and kssj != ''">
					and to_date(fbsj,'yyyy-mm-dd') >= to_date(#{kssj},'yyyy-mm-dd')
			</if>
			<if test="jssj != null and jssj != ''">
					<![CDATA[and to_date(fbsj,'yyyy-mm-dd') <= to_date(#{jssj},'yyyy-mm-dd')]]>
			</if>
	</select>
	<select id="selectqtwjlist" parameterType="wjgl" resultType="wjgl">
		select * from (
		select m.*,rownum rn from (
			select * from ZCWJ_QTWJ 
			where 1=1
			<if test="jsdw != null and  jsdw != ''">
			and (jsdw like '%'||trim(#{jsdw})||'%' or fbdw like '%'||trim(#{jsdw})||'%')
			</if>
			<if test="kssj != null  and kssj != ''">
					and to_date(fbsj,'yyyy-mm-dd') >= to_date(#{kssj},'yyyy-mm-dd')
			</if>
			<if test="jssj != null and jssj != ''">
					<![CDATA[and to_date(fbsj,'yyyy-mm-dd') <= to_date(#{jssj},'yyyy-mm-dd')]]>
			</if>
		order by fbsj desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	<select id="selectjhwjlist" parameterType="wjgl" resultType="wjgl">
		select * from (
		select m.*,rownum rn from (
			select * from ZCWJ_JHWJ 
			where 1=1
			<if test="kssj != null  and kssj != ''">
					and to_date(fbsj,'yyyy-mm-dd') >= to_date(#{kssj},'yyyy-mm-dd')
			</if>
			<if test="jssj != null and jssj != ''">
					<![CDATA[and to_date(fbsj,'yyyy-mm-dd') <= to_date(#{jssj},'yyyy-mm-dd')]]>
			</if>
		order by fbsj desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
		
	</select>
	<select id="selectjhwjlistCount" parameterType="wjgl" resultType="int">
		select count(*) from ZCWJ_JHWJ 
			where 1=1
			<if test="kssj != null  and kssj != ''">
					and to_date(fbsj,'yyyy-mm-dd') >= to_date(#{kssj},'yyyy-mm-dd')
			</if>
			<if test="jssj != null and jssj != ''">
					<![CDATA[and to_date(fbsj,'yyyy-mm-dd') <= to_date(#{jssj},'yyyy-mm-dd')]]>
			</if>
	</select>
	<select id="selectqtwjlistCount" parameterType="wjgl" resultType="int">
		select count(*) from ZCWJ_QTWJ 
			where 1=1
			<if test="jsdw != null and  jsdw != ''">
			and (jsdw like '%'||trim(#{jsdw})||'%' or fbdw like '%'||trim(#{jsdw})||'%')
			</if>
			<if test="kssj != null  and kssj != ''">
					and to_date(fbsj,'yyyy-mm-dd') >= to_date(#{kssj},'yyyy-mm-dd')
			</if>
			<if test="jssj != null and jssj != ''">
					<![CDATA[and to_date(fbsj,'yyyy-mm-dd') <= to_date(#{jssj},'yyyy-mm-dd')]]>
			</if>
	</select>
	
	<select id="selectWjfile" parameterType="wjgl" resultType="wjgl">
		select id,wjid,wjname from ZCWJ_FILE where wjid=#{wjid}
	</select>
	<select id="selectWjById" parameterType="wjgl" resultType="wjgl">
		select * from ZCWJ_FILE where id=#{id}
	</select>
</mapper>