<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.xmbb">
	<select id="getptgxXzqh1" parameterType="xmbb" resultType="hashmap">
	select distinct(substr(t1.xzqhdm,0,4)) xzqhdm,substr(t1.xzqhmc,0,3) xzqhmc
	from PLAN_LX_GCGJ t1 left join PLAN_GCGJ t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1 and (t1.lxbm like 'G%' or t1.lxbm like 'S%') and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="qxkg != null and  qxkg != ''">
			and t2.sfqxkg  like '%'||trim(#{qxkg})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	</select>
	<select id="getptgxXzqh2" parameterType="xmbb" resultType="hashmap">
	select distinct(substr(t1.xzqhdm,0,4)) xzqhdm,substr(t1.xzqhmc,0,3) xzqhmc
	from PLAN_LX_GCSJ t1 left join PLAN_GCSJ t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid
	where 1=1 and (t1.lxbm like 'G%' or t1.lxbm like 'S%') and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="qxkg != null and  qxkg != ''">
			and t2.sfqxkg  like '%'||trim(#{qxkg})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	</select>
	<select id="selectEx1" parameterType="xmbb" resultType="elist">
	select sum(t5.v_9) v_9,sum(t5.v_10) v_10,sum(t5.v_12) v_12,sum(t5.v_13) v_13,
	sum(t5.v_15) v_15,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18
	from (
	select 
			t1.lxbm||t1.lxmc v_1,t1.xzqhmc v_2,t2.sbnf v_4,t1.qdzh v_5,t1.zdzh v_6,t1.yhlc v_7,t2.gsztz v_8,t2.PFZTZ v_9,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_10,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_12,
			t2.pfztz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_13,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_14,
			(select sum(bywcdc) from gcgl_gcgzgj where jhid=t2.id)  v_15,(select sum(bywcjc) from gcgl_gcgzgj where jhid=t2.id)  v_16,(select sum(bywcmc) from gcgl_gcgzgj where jhid=t2.id) v_17,
			(t1.yhlc-(select sum(bywcmc) from gcgl_gcgzgj where jhid=t2.id)) v_18,
			to_char(t2.sjkgsj,'yyyy-mm-dd')v_19,t2.sfqxkg v_20,
			(select max(kgdl) from gcgl_gcgzgj where jhid=t2.id) v_21,t2.sjwgsj v_22,
			t2.yjwgsj v_23,t2.bz v_24,t2.jhxdwh v_25
				
	from PLAN_LX_GCGJ t1 left join PLAN_GCGJ t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1 and (t1.lxbm like 'G%' or t1.lxbm like 'S%')  and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="qxkg != null and  qxkg != ''">
			and t2.sfqxkg  like '%'||trim(#{qxkg})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>) t5
	</select>
	<select id="selectelist1" parameterType="xmbb" resultType="elist">
	select 
			t1.lxbm||t1.lxmc v_1,t1.xzqhmc v_2,t2.sbnf v_4,t1.qdzh v_5,t1.zdzh v_6,t1.yhlc v_7,t2.gsztz v_8,t2.PFZTZ v_9,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_10,'0' v_11,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_12,
			t2.pfztz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_13,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_14,
			(select sum(bywcdc) from gcgl_gcgzgj where jhid=t2.id)  v_15,(select sum(bywcjc) from gcgl_gcgzgj where jhid=t2.id)  v_16,(select sum(bywcmc) from gcgl_gcgzgj where jhid=t2.id) v_17,
			(t1.yhlc-(select sum(bywcmc) from gcgl_gcgzgj where jhid=t2.id)) v_18,
			to_char(t2.sjkgsj,'yyyy-mm-dd')v_19,t2.sfqxkg v_20,
			(select max(kgdl) from gcgl_gcgzgj where jhid=t2.id) v_21,to_char(t2.sjwgsj,'yyyy-mm-dd') v_22,
			to_char(t2.yjwgsj,'yyyy-mm-dd') v_23,t2.bz v_24,t2.jhxdwh v_25
				
	from PLAN_LX_GCGJ t1 left join PLAN_GCGJ t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1 and (t1.lxbm like 'G%' or t1.lxbm like 'S%')  and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="qxkg != null and  qxkg != ''">
			and t2.sfqxkg  like '%'||trim(#{qxkg})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	</select>
	<select id="selectEx2" parameterType="xmbb" resultType="elist">
	select sum(t5.v_9) v_9,sum(t5.v_10) v_10,sum(t5.v_12) v_12,sum(t5.v_13) v_13,
	sum(t5.v_15) v_15,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18
	from (
	select 
			t1.lxbm||t1.lxmc v_1,t1.xzqhmc v_2,t2.jhnf v_4,t1.qdzh v_5,t1.zdzh v_6,t1.xmlc v_7,t2.gsztz v_8,t2.PFTZ v_9,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_10,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_12,
			t2.pftz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_13,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_14,
			(select sum(dcwcqk) from gcgl_gcgzsj where jhid=t2.id) v_15,(select sum(jcwcqk) from gcgl_gcgzsj where jhid=t2.id) v_16,(select sum(LQLMWCQK)+sum(SNLMWCQK) from gcgl_gcgzsj where jhid=t2.id) v_17,
			(t1.xmlc-(select sum(LQLMWCQK)+sum(SNLMWCQK) from gcgl_gcgzsj where jhid=t2.id)) v_18,
			to_char(t2.sjkgsj,'yyyy-mm-dd')v_19,t2.sfqxkg v_20,
			(select max(kgdl) from gcgl_gcgzgj where jhid=t2.id) v_21,t2.sjwgsj v_22,
			t2.yjwgsj v_23,t1.bz v_24,t2.jhxdwh v_25
				
	from PLAN_LX_GCSJ t1 left join PLAN_GCSJ t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1 and (t1.lxbm like 'G%' or t1.lxbm like 'S%')  and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="qxkg != null and  qxkg != ''">
			and t2.sfqxkg  like '%'||trim(#{qxkg})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>) t5
	</select>
	<select id="selectelist2" parameterType="xmbb" resultType="elist">
	
	select 
			t1.lxbm||t1.lxmc v_1,t1.xzqhmc v_2,t2.jhnf v_4,t1.qdzh v_5,t1.zdzh v_6,t1.xmlc v_7,t2.gsztz v_8,t2.PFTZ v_9,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_10,'0' v_11,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_12,
			t2.pftz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_13,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_14,
			(select sum(dcwcqk) from gcgl_gcgzsj where jhid=t2.id) v_15,(select sum(jcwcqk) from gcgl_gcgzsj where jhid=t2.id) v_16,(select sum(LQLMWCQK)+sum(SNLMWCQK) from gcgl_gcgzsj where jhid=t2.id) v_17,
			(t1.xmlc-(select sum(LQLMWCQK)+sum(SNLMWCQK) from gcgl_gcgzsj where jhid=t2.id)) v_18,
			to_char(t2.sjkgsj,'yyyy-mm-dd')v_19,t2.sfqxkg v_20,
			(select max(kgdl) from gcgl_gcgzgj where jhid=t2.id) v_21,to_char(t2.sjwgsj,'yyyy-mm-dd') v_22,
			to_char(t2.yjwgsj,'yyyy-mm-dd') v_23,t1.bz v_24,t2.jhxdwh v_25
				
	from PLAN_LX_GCSJ t1 left join PLAN_GCSJ t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1 and (t1.lxbm like 'G%' or t1.lxbm like 'S%')  and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="qxkg != null and  qxkg != ''">
			and t2.sfqxkg  like '%'||trim(#{qxkg})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	</select>
	<!-- yh -->
	<select id="getYhxzqh" parameterType="xmbb" resultType="hashmap">
	select distinct(substr(t1.xzqhdm,0,4)) xzqhdm,substr(t1.xzqhmc,0,3) xzqhmc
	from PLAN_LX_YHDZX t1 left join PLAN_YHDZX t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1  and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	</select>
	<select id="getYhHj" parameterType="xmbb" resultType="elist">
	select sum(t5.v_10) v_10,sum(t5.v_11) v_11,sum(t5.v_12) v_12,sum(t5.v_13) v_13,sum(t5.v_14) v_14,
	sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_21) v_21
	from(
	select 
	t1.xzqhmc v_1,t1.lxbm||t1.lxmc||'('||t1.qdzh||'-'||t1.zdzh||')' v_3,t2.classify v_4,
	t2.sbnf v_5,t1.qdzh v_6,t1.zdzh v_7,t1.hdlc v_8,t2.gys v_9,t2.totalinvest v_10,
	(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_11,'0' v_12,
	(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_13,
	t2.totalinvest-(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_14,
	(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
	(select sum(bywcdc) from gcgl_yhdzx where jhid=t2.id) v_16,(select sum(bywcjc) from gcgl_yhdzx where jhid=t2.id) v_17,to_char(t2.SJKGSJ,'yyyy-mm-dd') v_18,
	to_char(t2.SJWGSJ,'yyyy-mm-dd') v_19,
	(select sum(kgdl) from gcgl_yhdzx where jhid=t2.id) v_20,
	(select sum(bywcmc) from gcgl_yhdzx where jhid=t2.id) v_21,
	t2.PLANDOWNNUMBER v_23
	from PLAN_LX_YHDZX t1 left join PLAN_YHDZX t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1  and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="tiaojian != null and  tiaojian != ''">
			and t1.lxbm  like (#{tiaojian})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	) t5
	</select>
	<select id="getyhlist" parameterType="xmbb" resultType="elist">
	select 
	t1.xzqhmc v_1,t1.lxbm||t1.lxmc||'('||t1.qdzh||'-'||t1.zdzh||')' v_3,t2.classify v_4,
	t2.sbnf v_5,t1.qdzh v_6,t1.zdzh v_7,t1.hdlc v_8,t2.gys v_9,t2.totalinvest v_10,
	(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_11,'0' v_12,
	(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_13,
	t2.totalinvest-(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_14,
	(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
	(select sum(bywcdc) from gcgl_yhdzx where jhid=t2.id) v_16,(select sum(bywcjc) from gcgl_yhdzx where jhid=t2.id) v_17,to_char(t2.SJKGSJ,'yyyy-mm-dd') v_18,
	to_char(t2.SJWGSJ,'yyyy-mm-dd') v_19,
	(select sum(kgdl) from gcgl_yhdzx where jhid=t2.id) v_20,
	(select sum(bywcmc) from gcgl_yhdzx where jhid=t2.id) v_21,
	t2.PLANDOWNNUMBER v_23
	from PLAN_LX_YHDZX t1 left join PLAN_YHDZX t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1  and t3.sfzj='0'
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="tiaojian != null and  tiaojian != ''">
			and t1.lxbm  like (#{tiaojian})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	</select>
	
	<select id="getYhHj1" parameterType="xmbb" resultType="elist">
	select sum(t5.v_10) v_10,sum(t5.v_11) v_11,sum(t5.v_12) v_12,sum(t5.v_13) v_13,sum(t5.v_14) v_14,
	sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_21) v_21
	from(
	select 
	t1.xzqhmc v_1,t1.lxbm||t1.lxmc||'('||t1.qdzh||'-'||t1.zdzh||')' v_3,t2.classify v_4,
	t2.sbnf v_5,t1.qdzh v_6,t1.zdzh v_7,t1.hdlc v_8,t2.gys v_9,t2.totalinvest v_10,
	(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_11,'0' v_12,
	(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_13,
	t2.totalinvest-(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_14,
	(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
	(select sum(bywcdc) from gcgl_yhdzx where jhid=t2.id) v_16,(select sum(bywcjc) from gcgl_yhdzx where jhid=t2.id) v_17,to_char(t2.SJKGSJ,'yyyy-mm-dd') v_18,
	to_char(t2.SJWGSJ,'yyyy-mm-dd') v_19,
	(select sum(kgdl) from gcgl_yhdzx where jhid=t2.id) v_20,
	(select sum(bywcmc) from gcgl_yhdzx where jhid=t2.id) v_21,
	t2.PLANDOWNNUMBER v_23
	from PLAN_LX_YHDZX t1 left join PLAN_YHDZX t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1  and t3.sfzj='0' and (t1.lxbm like 'X%' or t1.lxbm like 'Y%')
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	) t5
	</select>
	<select id="getyhlist1" parameterType="xmbb" resultType="elist">
	select 
	t1.xzqhmc v_1,t1.lxbm||t1.lxmc||'('||t1.qdzh||'-'||t1.zdzh||')' v_3,t2.classify v_4,
	t2.sbnf v_5,t1.qdzh v_6,t1.zdzh v_7,t1.hdlc v_8,t2.gys v_9,t2.totalinvest v_10,
	(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_11,'0' v_12,
	(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_13,
	t2.totalinvest-(select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) v_14,
	(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
	(select sum(bywcdc) from gcgl_yhdzx where jhid=t2.id) v_16,(select sum(bywcjc) from gcgl_yhdzx where jhid=t2.id) v_17,to_char(t2.SJKGSJ,'yyyy-mm-dd') v_18,
	to_char(t2.SJWGSJ,'yyyy-mm-dd') v_19,
	(select sum(kgdl) from gcgl_yhdzx where jhid=t2.id) v_20,
	(select sum(bywcmc) from gcgl_yhdzx where jhid=t2.id) v_21,
	t2.PLANDOWNNUMBER v_23
	from PLAN_LX_YHDZX t1 left join PLAN_YHDZX t2 on t1.jhid=t2.id left join plan_zjxd t3 on t2.id=t3.xmid 
	where 1=1  and t3.sfzj='0' and (t1.lxbm like 'X%' or t1.lxbm like 'Y%')
	<if test="gydw != null and  gydw != ''">
			and t1.gydwdm like '%'||trim(#{gydw})||'%'
	</if>
	<if test="xzqh != null and  xzqh != ''">
			and t1.xzqhdm like '%'||trim(#{xzqh})||'%'
	</if>
	<if test="jhxdnf != null and  jhxdnf != ''">
			and t3.xdnf in (${jhxdnf})
	</if>
	<if test="kgzt != null and  kgzt != ''">
			and t2.kgzt  like '%'||trim(#{kgzt})||'%'
	</if>
	<if test="jgzt != null and  jgzt != ''">
			and t2.jgzt  like '%'||trim(#{jgzt})||'%'
	</if>
	<if test="ljbf != null and  ljbf != ''">
			and (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id) ${ljbf}
	</if>
	<if test="wbf != null and  wbf != ''">
			and ((select sum(xdzj) from plan_zjxd where xmid=t2.id) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t2.id)) ${wbf}
	</if>
	</select>
	<select id="getlwwq" parameterType="xmbb" resultType="elist">
		select sum(t6.v_9) v_9,sum(t6.v_10) v_10,sum(t6.v_11) v_11,sum(t6.v_12) v_12,sum(t6.v_13) v_13,sum(t6.v_14) v_14,sum(t6.v_16) v_16
		from(
		select 
			substr(t3.xzqhmc,0,3) v_1,t3.tsdq v_2,t3.lxbm||t3.lxmc v_3,t2.jsxz v_4,t3.qlzxzh v_5,t3.kjzc v_7,
			t1.sbnf v_8,t1.pfztz v_9,t1.gys v_10,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_11,'0' v_12,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_13,
			t1.pfztz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_14,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
			t3.qlqc v_16,to_char(t1.SJKGSJ,'yyyy-mm-dd') v_17,to_char(t1.SJWGSJ,'yyyy-mm-dd') v_18,
			to_char(t1.YJJGSJ,'yyyy-mm-dd') v_19,
			t1.pfwh v_21
		from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id left join plan_zjxd t4 on t1.id=t4.xmid 
		where 1=1  and t4.sfzj='0'
		<if test="tsdq != null and  tsdq != ''">
			and t3.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="gydw != null and  gydw != ''">
			and t3.gydwbm like '%'||trim(#{gydw})||'%'
		</if>
		<if test="xzqh != null and  xzqh != ''">
				and t3.xzqhdm like '%'||trim(#{xzqh})||'%'
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and t4.xdnf in (${jhxdnf})
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t1.kgzt  like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t1.jgzt  like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				and (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) ${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				and ((select sum(xdzj) from plan_zjxd where xmid=t1.sckid) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid)) ${wbf}
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and (t3.lxbm  like '%'||trim(#{jgzt})||'%' or t3.lxmc  like '%'||trim(#{jgzt})||'%')
		</if>) t6
	</select>
	<select id="getlwwqlist" parameterType="xmbb" resultType="elist">
		select 
			substr(t3.xzqhmc,0,3) v_1,t3.tsdq v_2,t3.qlbh||t3.qlmc v_3,t2.jsxz v_4,t3.qlzxzh v_5,t3.kjzc v_7,
			t1.sbnf v_8,t1.pfztz v_9,t1.gys v_10,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_11,'0' v_12,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_13,
			t1.pfztz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_14,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
			t3.qlqc v_16,to_char(t1.SJKGSJ,'yyyy-mm-dd') v_17,to_char(t1.SJWGSJ,'yyyy-mm-dd') v_18,
			to_char(t1.YJJGSJ,'yyyy-mm-dd') v_19,
			t1.pfwh v_21
		from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id left join plan_zjxd t4 on t1.id=t4.xmid 
		where 1=1  and t4.sfzj='0'
		<if test="gydw != null and  gydw != ''">
			and t3.gydwbm like '%'||trim(#{gydw})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
			and t3.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xzqh != null and  xzqh != ''">
				and t3.xzqhdm like '%'||trim(#{xzqh})||'%'
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and t4.xdnf in (${jhxdnf})
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t1.kgzt  like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t1.jgzt  like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				and (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) ${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				and ((select sum(xdzj) from plan_zjxd where xmid=t1.sckid) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid)) ${wbf}
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and (t3.lxbm  like '%'||trim(#{jgzt})||'%' or t3.lxmc  like '%'||trim(#{jgzt})||'%')
		</if>
	</select>
	<select id="getlwab" parameterType="xmbb" resultType="elist">
		select sum(t6.v_9) v_9,sum(t6.v_10) v_10,sum(t6.v_11) v_11,sum(t6.v_12) v_12,sum(t6.v_13) v_13,sum(t6.v_14) v_14,sum(t6.v_16) v_16
		from(
		select 
			substr(t3.xzqhmc,0,3) v_1,t3.tsdq v_2,t3.lxbm||t3.lxmc v_3,t2.jsxz v_4,t3.qdzh v_5,t3.zdzh v_6,t3.qzlc v_7,
			t1.jhnf v_8,t1.pfztz v_9,t1.gys v_10,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_11,'0' v_12,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_13,
			t1.pfztz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_14,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
			t3.yhlc v_16,to_char(t1.SJKGSJ,'yyyy-mm-dd') v_17,to_char(t1.SJWGSJ,'yyyy-mm-dd') v_18,
			to_char(t1.YJWGSJ,'yyyy-mm-dd') v_19,
			t1.pfwh v_21
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id  left join plan_zjxd t4 on t1.id=t4.xmid 
		where 1=1  and t4.sfzj='0'
		<if test="gydw != null and  gydw != ''">
			and t3.gydwbm like '%'||trim(#{gydw})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
			and t3.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xzqh != null and  xzqh != ''">
				and t3.xzqhdm like '%'||trim(#{xzqh})||'%'
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and t4.xdnf in (${jhxdnf})
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t1.kgzt  like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t1.jgzt  like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				and (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) ${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				and ((select sum(xdzj) from plan_zjxd where xmid=t1.sckid) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid)) ${wbf}
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and (t3.lxbm  like '%'||trim(#{jgzt})||'%' or t3.lxmc  like '%'||trim(#{jgzt})||'%')
		</if>) t6
	</select>
	<select id="getlwablist" parameterType="xmbb" resultType="elist">

		select 
			substr(t3.xzqhmc,0,3) v_1,t3.tsdq v_2,t3.lxbm||t3.lxmc v_3,t2.jsxz v_4,t3.qdzh v_5,t3.zdzh v_6,t3.qzlc v_7,
			t1.jhnf v_8,t1.pfztz v_9,t1.gys v_10,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_11,'0' v_12,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_13,
			t1.pfztz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_14,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
			t3.yhlc v_16,to_char(t1.SJKGSJ,'yyyy-mm-dd') v_17,to_char(t1.SJWGSJ,'yyyy-mm-dd') v_18,
			to_char(t1.YJWGSJ,'yyyy-mm-dd') v_19,
			t1.pfwh v_21
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id  left join plan_zjxd t4 on t1.id=t4.xmid 
		where 1=1  and t4.sfzj='0'
		<if test="gydw != null and  gydw != ''">
			and t3.gydwbm like '%'||trim(#{gydw})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
			and t3.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xzqh != null and  xzqh != ''">
				and t3.xzqhdm like '%'||trim(#{xzqh})||'%'
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and t4.xdnf in (${jhxdnf})
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t1.kgzt  like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t1.jgzt  like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				and (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) ${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				and ((select sum(xdzj) from plan_zjxd where xmid=t1.sckid) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid)) ${wbf}
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and (t3.lxbm  like '%'||trim(#{jgzt})||'%' or t3.lxmc  like '%'||trim(#{jgzt})||'%')
		</if>
	</select>
	
	<select id="getlwzh" parameterType="xmbb" resultType="elist">
		select sum(t6.v_9) v_9,sum(t6.v_10) v_10,sum(t6.v_11) v_11,sum(t6.v_12) v_12,sum(t6.v_13) v_13,sum(t6.v_14) v_14,sum(t6.v_16) v_16
		from(
		select 
			substr(t3.xzqhmc,0,3) v_1,t3.tsdq v_2,t3.lxbm||t3.lxmc v_3,t2.jsxz v_4,t3.qdzh v_5,t3.zdzh v_6,t3.qzlc v_7,
			t1.SBNF v_8,t1.pfztz v_9,t1.gys v_10,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_11,'0' v_12,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_13,
			t1.pfztz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_14,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
			t3.yhlc v_16,to_char(t1.SJKGSJ,'yyyy-mm-dd') v_17,to_char(t1.SJWGSJ,'yyyy-mm-dd') v_18,
			to_char(t1.YJWGSJ,'yyyy-mm-dd') v_19,
			t1.pfwh v_21
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id  left join plan_zjxd t4 on t1.id=t4.xmid 
		where 1=1  and t4.sfzj='0'
		<if test="gydw != null and  gydw != ''">
			and t3.gydwbm like '%'||trim(#{gydw})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
			and t3.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xzqh != null and  xzqh != ''">
				and t3.xzqhdm like '%'||trim(#{xzqh})||'%'
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and t4.xdnf in (${jhxdnf})
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t1.kgzt  like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t1.jgzt  like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				and (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) ${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				and ((select sum(xdzj) from plan_zjxd where xmid=t1.sckid) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid)) ${wbf}
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and (t3.lxbm  like '%'||trim(#{jgzt})||'%' or t3.lxmc  like '%'||trim(#{jgzt})||'%')
		</if>) t6
	</select>
	
	<select id="getlwzhlist" parameterType="xmbb" resultType="elist">
		
		select 
			substr(t3.xzqhmc,0,3) v_1,t3.tsdq v_2,t3.lxbm||t3.lxmc v_3,t2.jsxz v_4,t3.qdzh v_5,t3.zdzh v_6,t3.qzlc v_7,
			t1.SBNF v_8,t1.pfztz v_9,t1.gys v_10,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_11,'0' v_12,
			(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_13,
			t1.pfztz-(select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) v_14,
			(case when kgzt='0' then '未开工' when kgzt='1' and jgzt='0' then '在建' when jgzt='1' then '竣工' end) v_15,
			t3.yhlc v_16,to_char(t1.SJKGSJ,'yyyy-mm-dd') v_17,to_char(t1.SJWGSJ,'yyyy-mm-dd') v_18,
			to_char(t1.YJWGSJ,'yyyy-mm-dd') v_19,
			t1.pfwh v_21
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id  left join plan_zjxd t4 on t1.id=t4.xmid 
		where 1=1  and t4.sfzj='0'
		<if test="gydw != null and  gydw != ''">
			and t3.gydwbm like '%'||trim(#{gydw})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
			and t3.tsdq like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="xzqh != null and  xzqh != ''">
				and t3.xzqhdm like '%'||trim(#{xzqh})||'%'
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and t4.xdnf in (${jhxdnf})
		</if>
		<if test="kgzt != null and  kgzt != ''">
				and t1.kgzt  like '%'||trim(#{kgzt})||'%'
		</if>
		<if test="jgzt != null and  jgzt != ''">
				and t1.jgzt  like '%'||trim(#{jgzt})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				and (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid) ${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				and ((select sum(xdzj) from plan_zjxd where xmid=t1.sckid) - (select sum(cgsdwzj) from gcgl_cgs where jhid=t1.sckid)) ${wbf}
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and (t3.lxbm  like '%'||trim(#{jgzt})||'%' or t3.lxmc  like '%'||trim(#{jgzt})||'%')
		</if>
	</select>
	<select id="gettsdq" resultType="treenode" parameterType="String">
		select 
		 distinct(t3.name) id,t3.name text
		from XTGL_TSDQ t3 left join XTGL_XZQHTSDQ t2  on t2.parent=t3.id left join XTGL_XZQH t1  on t1.id=t2.xzqhdm
		where t1.id like '%'||#{xzqh}||'%' and t3.name not like '%直管%'
		
		and t3.state not like '禁用'
	</select>
	
	<!-- 重做 -->
	<!-- ptgx -->
	<select id="getptgxlist1" parameterType="xmbb" resultType="elist">
		select decode(substr(xmlx,1,1),'1','一','二') v_0,' ' xmlx,decode(substr(xmlx,1,1),'1','普通国省道改造建设项目','红色旅游公路项目') v_2,' ' xzqhmc,' ' xzqhdm,' ' tsdq,' ' xdnf,' ' qdzh,' ' zdzh,
    	decode(sum(yhlc),null,' ',sum(yhlc)) v_11,sum(sgtlc) v_14,decode(sum(pfztz),null,' ',sum(pfztz)) v_15,sum(btz) v_16,sum(gz) v_17,sum(sz) v_18, sum(zq) v_19,sum(rys) v_20,sum(dk) v_21,sum(jl) v_22,sum(qt) v_23,
        sum(bnbtz) v_24,sum(bngz) v_25,sum(bnsz) v_26,sum(bnzq) v_27,sum(bnrys) v_28,sum(bndk) v_29,sum(bnjl) v_30,sum(bnqt) v_31,
        sum(ljbtz) v_32,sum(ljgz) v_33,sum(ljsz) v_34,sum(ljzq) v_35,sum(ljrys) v_36,sum(ljdk) v_37,sum(ljjl) v_38,sum(ljqt) v_39,
        sum(wbtz) v_40,sum(wgz) v_41,sum(wsz) v_42,sum(wzq) v_43,sum(wrys) v_44,sum(wdk) v_45,sum(wjl) v_46,sum(wqt) v_47,' ' jszt,decode(sum(dc),null,' ',sum(dc)) v_49,
        decode(sum(jc),null,' ',sum(jc)) v_50,decode(sum(wglc),null,' ',sum(wglc)) v_51,decode(sum(wkglc),null,' ',sum(wkglc)) v_52,' ' sjkgsj,' ' sfqxkg,' ' kgdl,' ' sjwgsj,' ' yjwgsj,' ' qksm,' ' xdwh,' ' xgcsyj,' ' cscyj,' ' gydw,count(*) xmgs
        from  gljsxdjh_gsdgzxm
        where 1=1
   		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="qxkg != null and  qxkg != ''">
				and sfqxkg  like '%'||trim(#{qxkg})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
		group by substr(xmlx,1,1) 
		order by substr(xmlx,1,1)
	</select>
	<select id="getptgxlist2" parameterType="xmbb" resultType="elist">
		select decode(substr(xmlx,0,2),'11','（一）','12','（二）','13','（三）','21','二','') v_0,min(xmlx) xmlx,min(substr(xmlx,3)) v_2,' ' xzqhmc,' ' xzqhdm,' ' tsdq,' ' xdnf,' ' qdzh,' ' zdzh,
	   decode(sum(yhlc),null,' ',sum(yhlc)) v_11,sum(sgtlc) v_14,decode(sum(pfztz),null,' ',sum(pfztz)) v_15,sum(btz) v_16,sum(gz) v_17,sum(sz) v_18, sum(zq) v_19,sum(rys) v_20,sum(dk) v_21,sum(jl) v_22,sum(qt) v_23,
       sum(bnbtz) v_24,sum(bngz) v_25,sum(bnsz) v_26,sum(bnzq) v_27,sum(bnrys) v_28,sum(bndk) v_29,sum(bnjl) v_30,sum(bnqt) v_31,
       sum(ljbtz) v_32,sum(ljgz) v_33,sum(ljsz) v_34,sum(ljzq) v_35,sum(ljrys) v_36,sum(ljdk) v_37,sum(ljjl) v_38,sum(ljqt) v_39,
       sum(wbtz) v_40,sum(wgz) v_41,sum(wsz) v_42,sum(wzq) v_43,sum(wrys) v_44,sum(wdk) v_45,sum(wjl) v_46,sum(wqt) v_47,' ' jszt,decode(sum(dc),null,' ',sum(dc)) v_49,
       decode(sum(jc),null,' ',sum(jc)) v_50,decode(sum(wglc),null,' ',sum(wglc)) v_51,decode(sum(wkglc),null,' ',sum(wkglc)) v_52,' ' sjkgsj,' ' sfqxkg,' ' kgdl,' ' sjwgsj,' ' yjwgsj,' ' qksm,' ' xdwh,' ' xgcsyj,' ' cscyj,' ' gydw,count(*) xmgs
       from  gljsxdjh_gsdgzxm
       where 1=1
   		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="qxkg != null and  qxkg != ''">
				and sfqxkg  like '%'||trim(#{qxkg})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
		group by xmlx order by substr(xmlx,0,2)
	</select>
	<select id="getptgxlist3" parameterType="xmbb" resultType="elist">
		 select ' ' xh,min(xmlx) xmlx,decode(instr(max(xzqhmc), '市'),0,max(xzqhmc),substr(min(xzqhmc), 0, instr(max(xzqhmc), '市')))||'小计' v_2,' ' xzqhmc,substr(xzqhdm,0,4) xzqhdm,' ' tsdq,' ' xdnf,' ' qdzh,' ' zdzh,
		  decode(sum(yhlc),null,' ',sum(yhlc)) v_11,sum(sgtlc) v_14,decode(sum(pfztz),null,' ',sum(pfztz)) v_15,sum(btz) v_16,sum(gz) v_17,sum(sz) v_18, sum(zq) v_19,sum(rys) v_20,sum(dk) v_21,sum(jl) v_22,sum(qt) v_23,
       sum(bnbtz) v_24,sum(bngz) v_25,sum(bnsz) v_26,sum(bnzq) v_27,sum(bnrys) v_28,sum(bndk) v_29,sum(bnjl) v_30,sum(bnqt) v_31,
       sum(ljbtz) v_32,sum(ljgz) v_33,sum(ljsz) v_34,sum(ljzq) v_35,sum(ljrys) v_36,sum(ljdk) v_37,sum(ljjl) v_38,sum(ljqt) v_39,
       sum(wbtz) v_40,sum(wgz) v_41,sum(wsz) v_42,sum(wzq) v_43,sum(wrys) v_44,sum(wdk) v_45,sum(wjl) v_46,sum(wqt) v_47,' ' jszt,decode(sum(dc),null,' ',sum(dc)) v_49,
      decode(sum(jc),null,' ',sum(jc)) v_50,decode(sum(wglc),null,' ',sum(wglc)) v_51,decode(sum(wkglc),null,' ',sum(wkglc)) v_52,' ' sjkgsj,' ' sfqxkg,' ' kgdl,' ' sjwgsj,' ' yjwgsj,' ' qksm,' ' xdwh,' ' xgcsyj,' ' cscyj,' ' gydw,count(*) xmgs
       from  gljsxdjh_gsdgzxm
       where 1=1
   		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="qxkg != null and  qxkg != ''">
				and sfqxkg  like '%'||trim(#{qxkg})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
		group by xmlx,substr(xzqhdm,0,4)
		order by substr(xmlx,0,2),substr(xzqhdm,0,4)
	</select>
	<select id="getptgxlist4" parameterType="xmbb" resultType="elist">
		select decode(xmlx,null,' ',xmlx) xmlx,xmbm v_1,decode(xmmc,null,' ',xmmc) v_2,jsxz v_3,decode(xzqhmc,null,' ',xzqhmc) v_4,xsq v_5,decode(xzqhdm,null,' ',xzqhdm) xzqhdm,decode(tsdq,null,' ',tsdq) v_6,
    decode(xdnf,null,' ',xdnf) v_7,scxdnf v_8,decode(qdzh,null,' ',qdzh) v_9,decode(zdzh,null,' ',zdzh) v_10,decode(yhlc,null,' ',yhlc) v_11,sgtqd v_12,sgtzd v_13,sgtlc v_14,decode(pfztz,null,' ',pfztz) v_15,
    btz v_16,gz v_17,sz v_18, zq v_19,rys v_20,dk v_21,jl v_22,qt v_23,
       bnbtz v_24,bngz v_25,bnsz v_26,bnzq v_27,bnrys v_28,bndk v_29,bnjl v_30,bnqt v_31,
       ljbtz v_32,ljgz v_33,ljsz v_34,ljzq v_35,ljrys v_36,ljdk v_37,ljjl v_38,ljqt v_39,
       wbtz v_40,wgz v_41,wsz v_42,wzq v_43,wrys v_44,wdk v_45,wjl v_46,wqt v_47,  
    decode(jszt,null,' ',jszt) v_48,decode(dc,null,' ',dc) v_49,
    decode(jc,null,' ',jc) v_50,decode(wglc,null,' ',wglc) v_51,decode(wkglc,null,' ',wkglc) v_52,decode(sjkgsj,null,' ',sjkgsj) v_53,decode(sfqxkg,null,' ',sfqxkg) v_54,
    decode(kgdl,null,' ',kgdl) v_55,decode(sjwgsj,null,' ',sjwgsj) v_56,decode(yjwgsj,null,' ',yjwgsj) v_57,decode(qksm,null,' ',qksm) v_58,decode(xdwh,null,' ',xdwh) v_59,
    decode(xgcsyj,null,' ',xgcsyj) v_60,decode(cscyj,null,' ',cscyj) v_61,decode(gydw,null,' ',gydw) gydw,decode(t.id,null,' ',t.id) id,' 'xh,m.sl xmgs,m.sl from gljsxdjh_gsdgzxm t,
    (select id,count(*) sl from gljsxdjh_gsdgzxm
		<if test="jhxdnf != null and  jhxdnf != ''">
				where xdnf in (${jhxdnf}) 
		</if>  group by id) m where t.id=m.id
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="qxkg != null and  qxkg != ''">
				and sfqxkg  like '%'||trim(#{qxkg})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
		order by substr(xmlx,0,2),substr(xzqhdm,0,4),xmmc,xdnf
	</select>
	<!-- 养护大中修重做 -->
	<select id="getyhbblist1" parameterType="xmbb" resultType="elist">
		select '是' hb,'全省合计' xzqhmc,' ' v_0,' ' xmmc,' ' gcfl,' ' xdnf,' ' qdzh,' ' zdzh,decode(sum(jhlc),null,' ',sum(jhlc)) v_10,decode(sum(gys),null,' ',sum(gys)) v_11,
		sum(btz) v_12,sum(gz) v_13,sum(sz) v_14, sum(zq) v_15,sum(rys) v_16,sum(dk) v_17,sum(jl) v_18,sum(qt) v_19,
		sum(bnbtz) v_20,sum(bngz) v_21,sum(bnsz) v_22,sum(bnzq) v_23,sum(bnrys) v_24,sum(bndk) v_25,sum(bnjl) v_26,sum(bnqt) v_27,
		sum(ljbtz) v_28,sum(ljgz) v_29,sum(ljsz) v_30,sum(ljzq) v_31,sum(ljrys) v_32,sum(ljdk) v_33,sum(ljjl) v_34,sum(ljqt) v_35,
		sum(wbtz) v_36,sum(wgz) v_37,sum(wsz) v_38,sum(wzq) v_39,sum(wrys) v_40,sum(wdk) v_41,sum(wjl) v_42,sum(wqt) v_43,
		' ' jszt,decode(sum(dc),null,' ',sum(dc)) v_45,
      	decode(sum(jc),null,' ',sum(jc)) v_46,' ' kgrq,' ' wgrq,' ' kgdl,decode(sum(wglc),null,' ',sum(wglc)) v_50,' ' qksm,' ' jhxdwh,' ' xgcsyj,' ' cscyj
      	from stcyhdzx_gcxmjzb
    	where 1=1
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
	</select>
	<select id="getyhbblist2" parameterType="xmbb" resultType="elist">
		select '是' hb,min(xzqhdm) xzqhdm,min(sqs)||'合计' v_0,' ' xmmc,' ' gcfl,' ' xdnf,' ' qdzh,' ' zdzh,decode(sum(jhlc),null,' ',sum(jhlc)) v_10,decode(sum(gys),null,' ',sum(gys)) v_11,
		sum(btz) v_12,sum(gz) v_13,sum(sz) v_14, sum(zq) v_15,sum(rys) v_16,sum(dk) v_17,sum(jl) v_18,sum(qt) v_19,
		sum(bnbtz) v_20,sum(bngz) v_21,sum(bnsz) v_22,sum(bnzq) v_23,sum(bnrys) v_24,sum(bndk) v_25,sum(bnjl) v_26,sum(bnqt) v_27,
		sum(ljbtz) v_28,sum(ljgz) v_29,sum(ljsz) v_30,sum(ljzq) v_31,sum(ljrys) v_32,sum(ljdk) v_33,sum(ljjl) v_34,sum(ljqt) v_35,
		sum(wbtz) v_36,sum(wgz) v_37,sum(wsz) v_38,sum(wzq) v_39,sum(wrys) v_40,sum(wdk) v_41,sum(wjl) v_42,sum(wqt) v_43,
		' ' jszt,decode(sum(dc),null,' ',sum(dc)) v_45,
      	decode(sum(jc),null,' ',sum(jc)) v_46,' ' kgrq,' ' wgrq,' ' kgdl,decode(sum(wglc),null,' ',sum(wglc)) v_50,' ' qksm,' ' jhxdwh,' ' xgcsyj,' ' cscyj
      	from stcyhdzx_gcxmjzb
    	where 1=1
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
		group by substr(xzqhdm,0,4) order by substr(xzqhdm,0,4)
	</select>
	<select id="getyhbblist3" parameterType="xmbb" resultType="elist">
		select '是1' hb,min(xzqhdm) xzqhdm,dllx xzqhmc,substr(dllx,2,length(dllx)) v_1,' ' xmmc,' ' gcfl,' ' xdnf,' ' qdzh,' ' zdzh,decode(sum(jhlc),null,' ',sum(jhlc)) v_10,decode(sum(gys),null,' ',sum(gys)) v_11,
		sum(btz) v_12,sum(gz) v_13,sum(sz) v_14, sum(zq) v_15,sum(rys) v_16,sum(dk) v_17,sum(jl) v_18,sum(qt) v_19,
		sum(bnbtz) v_20,sum(bngz) v_21,sum(bnsz) v_22,sum(bnzq) v_23,sum(bnrys) v_24,sum(bndk) v_25,sum(bnjl) v_26,sum(bnqt) v_27,
		sum(ljbtz) v_28,sum(ljgz) v_29,sum(ljsz) v_30,sum(ljzq) v_31,sum(ljrys) v_32,sum(ljdk) v_33,sum(ljjl) v_34,sum(ljqt) v_35,
		sum(wbtz) v_36,sum(wgz) v_37,sum(wsz) v_38,sum(wzq) v_39,sum(wrys) v_40,sum(wdk) v_41,sum(wjl) v_42,sum(wqt) v_43,
		' ' jszt,decode(sum(dc),null,' ',sum(dc)) v_45,
      	decode(sum(jc),null,' ',sum(jc)) v_46,' ' kgrq,' ' wgrq,' ' kgdl,decode(sum(wglc),null,' ',sum(wglc)) v_50,' ' qksm,' ' jhxdwh,' ' xgcsyj,' ' cscyj
      	from stcyhdzx_gcxmjzb
    	where 1=1
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
		group by substr(xzqhdm,0,4),dllx order by substr(xzqhdm,0,4),substr(dllx,0,1)
	</select>
	<select id="getyhbblist4" parameterType="xmbb" resultType="elist">
		select 
      	decode(dllx,null,' ',dllx) dllx,decode(xzqhmc,null,' ',xzqhmc) xzqhmc,decode(xzqhdm,null,' ',xzqhdm) xzqhdm,decode(gydw,null,' ',gydw) gydw,
      	xmbm v_1,sqs v_2,xsq v_3,
        decode(tsdq,null,' ',tsdq) v_4,decode(xmmc,null,' ',xmmc) v_5,decode(gcfl,null,' ',gcfl) v_6,decode(xdnf,null,' ',xdnf) v_7,
        decode(qdzh,null,' ',qdzh) v_8,decode(zdzh,null,' ',zdzh) v_9,decode(jhlc,null,' ',jhlc) v_10,decode(gys,null,' ',gys) v_11,
        btz v_12,gz v_13,sz v_14, zq v_15,rys v_16,dk v_17,jl v_18,qt v_19,
        bnbtz v_20,bngz v_21,bnsz v_22,bnzq v_23,bnrys v_24,bndk v_25,bnjl v_26,bnqt v_27,
        ljbtz v_28,ljgz v_29,ljsz v_30,ljzq v_31,ljrys v_32,ljdk v_33,ljjl v_34,ljqt v_35,
        wbtz v_36,wgz v_37,wsz v_38,wzq v_39,wrys v_40,wdk v_41,wjl v_42,wqt v_43,
        decode(jszt,null,' ',jszt) v_44,
        decode(dc,null,' ',dc) v_45,decode(jc,null,' ',jc) v_46,decode(kgrq,null,' ',kgrq) v_47,decode(wgrq,null,' ',wgrq) v_48,
        decode(kgdl,null,' ',kgdl) v_49,decode(wglc,null,' ',wglc) v_50,decode(qksm,null,' ',qksm) v_51,decode(jhxdwh,null,' ',jhxdwh) v_52,
        decode(xgcsyj,null,' ',xgcsyj) v_53,decode(cscyj,null,' ',cscyj) v_54,' ' hb
    	from stcyhdzx_gcxmjzb
    	where 1=1
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
		order by substr(xzqhdm,0,4),substr(dllx,0,1)
	</select>
	
	<!-- 路网重做 -->
	<select id="getlwbblist1" parameterType="xmbb" resultType="elist">
		select 
 		xmlx,substr(xmlx,0,1) xh1,substr(xmlx,2,2) v_0,'是' hb,substr(xmlx,4) v_1,decode(sum(yhlc),null,' ',sum(yhlc)) v_8,
       sum(btz) v_10,sum(gz) v_11,sum(sz) v_12, sum(zq) v_13,sum(rys) v_14,sum(dk) v_15,sum(jl) v_16,sum(qt) v_17,
       sum(gys) v_18,
       sum(bnbtz) v_19,sum(bngz) v_20,sum(bnsz) v_21,sum(bnzq) v_22,sum(bnrys) v_23,sum(bndk) v_24,sum(bnjl) v_25,sum(bnqt) v_26,
       sum(ljbtz) v_27,sum(ljgz) v_28,sum(ljsz) v_29,sum(ljzq) v_30,sum(ljrys) v_31,sum(ljdk) v_32,sum(ljjl) v_33,sum(ljqt) v_34,
       sum(wbtz) v_35,sum(wgz) v_36,sum(wsz) v_37,sum(wzq) v_38,sum(wrys) v_39,sum(wdk) v_40,sum(wjl) v_41,sum(wqt) v_42,
       ' ' jszt,decode(sum(wglc),null,' ',sum(wglc)) v_44
     	from lwjggz_gcxmjzb
     	where 1=1
 		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
		group by xmlx 
		order by xh1
	</select>
	<select id="getlwbblist2" parameterType="xmbb" resultType="elist">
	 select 
      decode(xmlx,null,' ',xmlx) xmlx, decode(xzqhmc,null,' ',xzqhmc) xzqhmc, decode(xzqhdm,null,' ',xzqhdm) xzqhdm, 
          sqs v_1,xsq v_2,decode(tsdq,null,' ',tsdq) v_3,
        decode(xmmc,null,' ',xmmc) v_4, decode(jsxz,null,' ',jsxz) v_5, decode(qdzh,null,' ',qdzh) v_6, decode(zdzh,null,' ',zdzh) v_7,
          decode(yhlc,null,' ',yhlc) v_8, decode(xdnf,null,' ',xdnf) v_9,
          btz v_10,gz v_11,sz v_12, zq v_13,rys v_14,dk v_15,jl v_16,qt v_17,
       gys v_18,
       bnbtz v_19,bngz v_20,bnsz v_21,bnzq v_22,bnrys v_23,bndk v_24,bnjl v_25,bnqt v_26,
       ljbtz v_27,ljgz v_28,ljsz v_29,ljzq v_30,ljrys v_31,ljdk v_32,ljjl v_33,ljqt v_34,
       wbtz v_35,wgz v_36,wsz v_37,wzq v_38,wrys v_39,wdk v_40,wjl v_41,wqt v_42,
       decode(jszt,null,' ',jszt) v_43, decode(wglc,null,' ',wglc) v_44,
       kgrq v_45, wgrq v_46,yjrq v_47, decode(qksm,null,' ',qksm) v_48,
       decode(jhxdwh,null,' ',jhxdwh) v_49, decode(xgcsyj,null,' ',xgcsyj) v_50, decode(cscyj,null,' ',cscyj) v_51, decode(gydw,null,' ',gydw) gydw,' '  hb
	  from lwjggz_gcxmjzb 
	  where 1=1
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqh != null and  xzqh != ''">
				${xzqh}
		</if>
		<if test="jhxdnf != null and  jhxdnf != ''">
				and xdnf in (${jhxdnf})
		</if>
		<if test="jszt != null and  jszt != ''">
				and jszt  like '%'||trim(#{jszt})||'%'
		</if>
		<if test="tsdq != null and  tsdq != ''">
				and tsdq  like '%'||trim(#{tsdq})||'%'
		</if>
		<if test="ljbf != null and  ljbf != ''">
				${ljbf}
		</if>
		<if test="wbf != null and  wbf != ''">
				 ${wbf}
		</if>
	 	order by substr(xzqhdm,0,4),xmlx
	</select>
	
	<select id="setjhxdwh" resultType="treenode" parameterType="String">
		select distinct xdwh id,xdwh text from ${value} where xdwh is not null order by xdwh desc
	</select>
	
	<select id="getPtgxtz" parameterType="string" resultType="elist">
		select * from ZJHZ_TZ
	</select>
</mapper>
