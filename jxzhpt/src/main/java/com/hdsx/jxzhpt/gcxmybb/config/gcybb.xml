<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.gcybb">
	<select id="getWqgzybb" parameterType="gcglwqgz" resultType="hashmap">
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf desc
	</select>
	
	<select id="getWqgzxzqh" parameterType="gcglwqgz" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getWqgznf" parameterType="gcglwqgz" resultType="hashmap">
		select t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf 
	</select>
		<select id="getwqgzlist1" parameterType="gcglwqgz" resultType="elist">
		select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27
		from(
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf
			) t5
			where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			
	</select>
	
	<select id="getwqgzlist3" parameterType="gcglwqgz" resultType="elist">
		select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27
		from(
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf
			) t5
			where 1=1
			
			
	</select>
	<select id="getwqgzlist4" parameterType="gcglwqgz" resultType="elist">
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,(case when t3.akjfl='大桥' then '大桥' else '' end) v_11,(case when t3.akjfl='小桥' then '小桥' else '' end) v_12,t3.xjgjnd v_13,(case when t3.pddj='四类' then '四类' else '' end) v_14,(case when t3.pddj='五类' then '五类' else '' end) v_15,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			order by t3.xzqhmc
	</select>
	<!-- 安保 -->
	<select id="getabgcybb" parameterType="gcglabgc" resultType="hashmap">
		select t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,t1.JHKGSJ v_13,t1.JHWGSJ v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	
	<select id="getabgclist1" parameterType="gcglabgc" resultType="elist">
	select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_11) v_11,sum(t5.v_12) v_12,sum(t5.v_15) v_15,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27,sum(t5.v_28) v_28,sum(t5.v_29) v_29
	from(
		select  
		t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,t1.JHKGSJ v_13,t1.JHWGSJ v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30,t3.xmnf	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			) t5 where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
	</select>
	
	<select id="getAbgcxzqh" parameterType="gcglabgc" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getAbgcnf" parameterType="gcglabgc" resultType="hashmap">
		select t3.xmnf
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf
	</select>
	<select id="getabgclist4" parameterType="gcglabgc" resultType="elist">
		select t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,to_char(t1.jhkgsj,'YYYY') v_13,to_char(t1.JHWGSJ,'YYYY')  v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
	</select>
	
	<!-- 灾害 -->
	<select id="getzhfzybb" parameterType="gcglzhfz" resultType="hashmap">
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getzhfzlist1" parameterType="gcglzhfz" resultType="elist">
	select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_10) v_10,sum(t5.v_11) v_11,sum(t5.v_12) v_12,sum(t5.v_13) v_13,sum(t5.v_14) v_14,sum(t5.v_15) v_15,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20
	from(
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			) t5 where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
	</select>
	<select id="getZhfznf" parameterType="gcglzhfz" resultType="hashmap">
		select t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf
	</select>
	<select id="getZhfzxzqh" parameterType="gcglzhfz" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getzhfzlist2" parameterType="gcglzhfz" resultType="elist">
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
	</select>
</mapper>