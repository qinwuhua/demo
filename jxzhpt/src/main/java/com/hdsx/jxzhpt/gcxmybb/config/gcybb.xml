<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.gcybb">
	<select id="getWqgzybb" parameterType="gcglwqgz" resultType="hashmap">
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf desc
	</select>
	
	<select id="getWqgzxzqh" parameterType="gcglwqgz" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getWqgznf" parameterType="gcglwqgz" resultType="hashmap">
		select t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf 
	</select>
		<select id="getwqgzlist1" parameterType="gcglwqgz" resultType="elist">
		select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27
		from(
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf
			) t5
			where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			
	</select>
	
	<select id="getwqgzlist3" parameterType="gcglwqgz" resultType="elist">
		select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27
		from(
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf
			) t5
			where 1=1
			
			
	</select>
	<select id="getwqgzlist4" parameterType="gcglwqgz" resultType="elist">
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,(case when t3.akjfl='大桥' then '大桥' else '' end) v_11,(case when t3.akjfl='小桥' then '小桥' else '' end) v_12,t3.xjgjnd v_13,(case when t3.pddj='四类' then '四类' else '' end) v_14,(case when t3.pddj='五类' then '五类' else '' end) v_15,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			order by t3.xzqhmc
	</select>
	<!-- 安保 -->
	<select id="getabgcybb" parameterType="gcglabgc" resultType="hashmap">
		select t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,t1.JHKGSJ v_13,t1.JHWGSJ v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	
	<select id="getabgclist1" parameterType="gcglabgc" resultType="elist">
	select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_11) v_11,sum(t5.v_12) v_12,sum(t5.v_15) v_15,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27,sum(t5.v_28) v_28,sum(t5.v_29) v_29
	from(
		select  
		t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,t1.JHKGSJ v_13,t1.JHWGSJ v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30,t3.xmnf	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			) t5 where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
	</select>
	
	<select id="getAbgcxzqh" parameterType="gcglabgc" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getAbgcnf" parameterType="gcglabgc" resultType="hashmap">
		select t3.xmnf
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf
	</select>
	<select id="getabgclist4" parameterType="gcglabgc" resultType="elist">
		select t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,to_char(t1.jhkgsj,'YYYY') v_13,to_char(t1.JHWGSJ,'YYYY')  v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
	</select>
	
	<!-- 灾害 -->
	<select id="getzhfzybb" parameterType="gcglzhfz" resultType="hashmap">
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getzhfzlist1" parameterType="gcglzhfz" resultType="elist">
	select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_10) v_10,sum(t5.v_11) v_11,sum(t5.v_12) v_12,sum(t5.v_13) v_13,sum(t5.v_14) v_14,sum(t5.v_15) v_15,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20
	from(
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			) t5 where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
	</select>
	<select id="getZhfznf" parameterType="gcglzhfz" resultType="hashmap">
		select t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf
	</select>
	<select id="getZhfzxzqh" parameterType="gcglzhfz" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getzhfzlist2" parameterType="gcglzhfz" resultType="elist">
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
	</select>
	<!-- 水毁 -->
	<select id="getShybb" parameterType="gcglsh" resultType="hashmap">
		select t1.lxmc v_0,t2.SFGYHBM v_1,t1.XZQHMC v_2,t1.lxbm v_3,t1.qdzh||'-'||t1.zdzh v_4,t1.qzlc v_5,
		t1.yhlc v_6,t2.SJKGSJ v_9,t1.YLMLX v_10,t2.SJLMLX v_11,t2.DC v_12,t3.BYWCDC v_13,
		(select sum(BYWCDC) from GCGL_SH where  jhid=t2.id and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_14,
		(select sum(BYWCDC) from GCGL_SH where  jhid=t2.id and sbyf &lt;= #{sbyf}) v_15,
		t2.JC v_17,t3.BYWCJC v_18,
		(select sum(BYWCJC) from GCGL_SH where  jhid=t2.id and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWCJC) from GCGL_SH where  jhid=t2.id and sbyf &lt;= #{sbyf}) v_20,
		t2.MC v_22,t3.BYWCMC v_23,
		(select sum(BYWCMC) from GCGL_SH where  jhid=t2.id and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(BYWCMC) from GCGL_SH where  jhid=t2.id and sbyf &lt;= #{sbyf}) v_25,
		t2.pfztz v_27,t2.pfztz v_28,
		(select WC_BTZ from GCGL_SH where  jhid=t2.id and sbyf=#{sbyf}) v_29,
		(select sum(WC_BTZ) from GCGL_SH where  jhid=t2.id and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_30,
		(select sum(WC_BTZ) from GCGL_SH where  jhid=t2.id and sbyf &lt;= #{sbyf}) v_31,
		(case when t2.kgzt='0' then '未开工' when t2.kgzt='1' and t2.jgzt='0' then '在建' when t2.jgzt='1' then '完工' else '' end) v_33,
		t1.bz v_34,t2.SJWGSJ,t2.sbnf
		from PLAN_LX_SHUIH t1 left join PLAN_SHUIH t2 on t1.jhid=t2.id left join gcgl_sh t3 on t3.jhid=t2.id
		where t2.id in (select jhid from GCGL_SH where sbyf=#{sbyf})
		<if test="gydw != null and  gydw != ''">
				and t1.gydwdm like '%'||trim(#{gydw})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				and t2.sbnf like '%'||trim(#{sbnf})||'%'
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				and t1.xzqhdm like '%'||trim(#{xzqhdm})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and t1.lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and t1.lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="sbyf != null and  sbyf != ''">
				and t3.sbyf like '%'||trim(#{sbyf})||'%'
		</if>
	</select>
	<!-- 危桥重做 -->
	<select id="getwqgzbblist1" parameterType="gcglwqgz" resultType="hashmap">
		select
			' ' qlmc,'总计' qldm,' ' qlzxzh,' ' lxbm,' ' lxmc,' ' jsdj,sum(qlqc) qlqc,sum(kjzc) kjzc,sum(dkzdkj) dkzdkj,sum(qlqk) qlqk,' ' sbjgxs,' ' dq,' ' zq,
			' ' xjgjnd,' ' sl,' ' wl,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' yyjgqk,
			' ' yygjqk,' ' yycjqk,' ' zjgqk,' ' zgjqk,' ' zcjqk,' ' jsxz,' ' jhkgn,' ' jhwgn,' ' jsnr
		from
			(select
        xm.qlmc,xm.qlbh qldm,xm.qlzxzh,xm.lxbm,xm.lxmc,xm.jsdj,sc.scqlqc qlqc,xm.kjzc,xm.dkzdkj,sc.scqlqk qlqk,xm.sbjgxs,decode(xm.akjfl,'大桥','大桥',' ') dq,decode(xm.akjfl,'大桥',' ','中桥') zq,
        xm.xjgjnd,decode(xm.pddj,'四类','四类',' ') sl,decode(xm.pddj,'五类','五类',' ') wl,zj1.bnhj,zj1.bnbtz,zj1.bnstz,
        jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,decode(substr(sc.jsxz,0,2),'加固'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yyjgqk,
        decode(substr(sc.jsxz,0,2),'改建'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yygjqk，decode(substr(sc.jsxz,-2),'重建'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yycjqk,decode(substr(sc.jsxz,0,2),'加固'，round(jz3.kghj/p.pfztz,4)*100,0) zjgqk,
        decode(substr(sc.jsxz,0,2),'改建'，round(jz3.kghj/p.pfztz,4)*100,0) zgjqk，decode(substr(sc.jsxz,-2),'重建'，round(jz3.kghj/p.pfztz,4)*100,0) zcjqk,sc.jsxz,to_char(p.jhkgsj,'yyyy') jhkgn,
        to_char(p.jhwgsj,'yyyy') jhwgn,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,xm.qlmc||'('||xm.qlzxzh||')' xmmc
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz p,
      (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
      (select jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_wqgz jz where jz.sbyf=#{sbyf}) jz1,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
      (select jhid,sbyf from gcgl_wqgz where sbyf=#{sbyf} group by jhid,sbyf) y
      where xm.id=sc.xmkid and sc.sckid=p.sckid(+) and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id and y.sbyf is not null) 
		where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="qlmc != null and  qlmc != ''">
				and xmmc like '%'||trim(#{qlmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
	</select>
	<select id="getwqgzbblist2" parameterType="gcglwqgz" resultType="hashmap">
		select
			' ' qlmc,decode(instr(max(xzqhmc), '市'),0,max(xzqhmc),substr(min(xzqhmc), 0, instr(max(xzqhmc), '市')))||'合计' qldm,' ' qlzxzh,' ' lxbm,' ' lxmc,' ' jsdj,sum(qlqc) qlqc,sum(kjzc) kjzc,sum(dkzdkj) dkzdkj,sum(qlqk) qlqk,' ' sbjgxs,' ' dq,' ' zq,
			' ' xjgjnd,' ' sl,' ' wl,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' yyjgqk,
			' ' yygjqk,' ' yycjqk,' ' zjgqk,' ' zgjqk,' ' zcjqk,' ' jsxz,' ' jhkgn,' ' jhwgn,' ' jsnr,substr(xzqhdm,0,4) xzqh
		from
			(select
        xm.qlmc,xm.qlbh qldm,xm.qlzxzh,xm.lxbm,xm.lxmc,xm.jsdj,sc.scqlqc qlqc,xm.kjzc,xm.dkzdkj,sc.scqlqk qlqk,xm.sbjgxs,decode(xm.akjfl,'大桥','大桥',' ') dq,decode(xm.akjfl,'大桥',' ','中桥') zq,
        xm.xjgjnd,decode(xm.pddj,'四类','四类',' ') sl,decode(xm.pddj,'五类','五类',' ') wl,zj1.bnhj,zj1.bnbtz,zj1.bnstz,
        jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,decode(substr(sc.jsxz,0,2),'加固'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yyjgqk,
        decode(substr(sc.jsxz,0,2),'改建'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yygjqk，decode(substr(sc.jsxz,-2),'重建'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yycjqk,decode(substr(sc.jsxz,0,2),'加固'，round(jz3.kghj/p.pfztz,4)*100,0) zjgqk,
        decode(substr(sc.jsxz,0,2),'改建'，round(jz3.kghj/p.pfztz,4)*100,0) zgjqk，decode(substr(sc.jsxz,-2),'重建'，round(jz3.kghj/p.pfztz,4)*100,0) zcjqk,sc.jsxz,to_char(p.jhkgsj,'yyyy') jhkgn,
        to_char(p.jhwgsj,'yyyy') jhwgn,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,xm.qlmc||'('||xm.qlzxzh||')' xmmc
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz p,
      (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
      (select jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_wqgz jz where jz.sbyf=#{sbyf}) jz1,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
      (select jhid,sbyf from gcgl_wqgz where sbyf=#{sbyf} group by jhid,sbyf) y
      where xm.id=sc.xmkid and sc.sckid=p.sckid(+) and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id and y.sbyf is not null) 
		where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="qlmc != null and  qlmc != ''">
				and xmmc like '%'||trim(#{qlmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4) order by substr(xzqhdm,0,4)
	</select>
	<select id="getwqgzbblist3" parameterType="gcglwqgz" resultType="hashmap">
		select
			' ' qlmc,xdnf||'年项目' qldm,' ' qlzxzh,' ' lxbm,' ' lxmc,' ' jsdj,sum(qlqc) qlqc,sum(kjzc) kjzc,sum(dkzdkj) dkzdkj,sum(qlqk) qlqk,' ' sbjgxs,' ' dq,' ' zq,
			' ' xjgjnd,' ' sl,' ' wl,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' yyjgqk,
			' ' yygjqk,' ' yycjqk,' ' zjgqk,' ' zgjqk,' ' zcjqk,' ' jsxz,' ' jhkgn,' ' jhwgn,' ' jsnr,xdnf,substr(xzqhdm,0,4) xzqh
		from
			(select
        xm.qlmc,xm.qlbh qldm,xm.qlzxzh,xm.lxbm,xm.lxmc,xm.jsdj,sc.scqlqc qlqc,xm.kjzc,xm.dkzdkj,sc.scqlqk qlqk,xm.sbjgxs,decode(xm.akjfl,'大桥','大桥',' ') dq,decode(xm.akjfl,'大桥',' ','中桥') zq,
        xm.xjgjnd,decode(xm.pddj,'四类','四类',' ') sl,decode(xm.pddj,'五类','五类',' ') wl,zj1.bnhj,zj1.bnbtz,zj1.bnstz,
        jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,decode(substr(sc.jsxz,0,2),'加固'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yyjgqk,
        decode(substr(sc.jsxz,0,2),'改建'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yygjqk，decode(substr(sc.jsxz,-2),'重建'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yycjqk,decode(substr(sc.jsxz,0,2),'加固'，round(jz3.kghj/p.pfztz,4)*100,0) zjgqk,
        decode(substr(sc.jsxz,0,2),'改建'，round(jz3.kghj/p.pfztz,4)*100,0) zgjqk，decode(substr(sc.jsxz,-2),'重建'，round(jz3.kghj/p.pfztz,4)*100,0) zcjqk,sc.jsxz,to_char(p.jhkgsj,'yyyy') jhkgn,
        to_char(p.jhwgsj,'yyyy') jhwgn,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,xm.qlmc||'('||xm.qlzxzh||')' xmmc
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz p,
      (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
      (select jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_wqgz jz where jz.sbyf=#{sbyf}) jz1,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
      (select jhid,sbyf from gcgl_wqgz where sbyf=#{sbyf} group by jhid,sbyf) y
      where xm.id=sc.xmkid and sc.sckid=p.sckid(+) and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id and y.sbyf is not null) 
		where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="qlmc != null and  qlmc != ''">
				and xmmc like '%'||trim(#{qlmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4),xdnf order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getwqgzbblist4" parameterType="gcglwqgz" resultType="hashmap">
		select
			substr(xzqhdm,0,4) xzqh,t.*
		from
			(select
        xm.qlmc,xm.qlbh qldm,xm.qlzxzh,xm.lxbm,xm.lxmc,xm.jsdj,sc.scqlqc qlqc,xm.kjzc,xm.dkzdkj,sc.scqlqk qlqk,xm.sbjgxs,decode(xm.akjfl,'大桥','大桥',' ') dq,decode(xm.akjfl,'大桥',' ','中桥') zq,
        xm.xjgjnd,decode(xm.pddj,'四类','四类',' ') sl,decode(xm.pddj,'五类','五类',' ') wl,zj1.bnhj,zj1.bnbtz,zj1.bnstz,
        jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,decode(substr(sc.jsxz,0,2),'加固'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yyjgqk,
        decode(substr(sc.jsxz,0,2),'改建'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yygjqk，decode(substr(sc.jsxz,-2),'重建'，round(jz2.yyhj/zj1.bnhj,4)*100,0) yycjqk,decode(substr(sc.jsxz,0,2),'加固'，round(jz3.kghj/p.pfztz,4)*100,0) zjgqk,
        decode(substr(sc.jsxz,0,2),'改建'，round(jz3.kghj/p.pfztz,4)*100,0) zgjqk，decode(substr(sc.jsxz,-2),'重建'，round(jz3.kghj/p.pfztz,4)*100,0) zcjqk,sc.jsxz,to_char(p.jhkgsj,'yyyy') jhkgn,
        to_char(p.jhwgsj,'yyyy') jhwgn,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,xm.qlmc||'('||xm.qlzxzh||')' xmmc
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz p,
      (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
      (select jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_wqgz jz where jz.sbyf=#{sbyf}) jz1,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
      (select jhid,sbyf from gcgl_wqgz where sbyf=#{sbyf} group by jhid,sbyf) y
      where xm.id=sc.xmkid and sc.sckid=p.sckid(+) and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id and y.sbyf is not null) t
		where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="qlmc != null and  qlmc != ''">
				and xmmc like '%'||trim(#{qlmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getabgcbblist1" parameterType="gcglabgc" resultType="hashmap">
		select
			 ' ' lxbm,'总计' lxmc,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,sum(jhc) jhc,sum(jhgl) jhgl,' ' jhkgn,' ' jhwgn,sum(bywcc) bywcc,sum(bywcgl) bywcgl,
			sum(yywcc) yywcc,sum(yywcgl) yywcgl,sum(kgwcc) kgwcc,sum(kgwcgl) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr
		from(
        select
          xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,p.jhwc_c jhc,sc.scyhlc jhgl,to_char(p.jhkgsj,'yyyy') jhkgn,
          to_char(p.jhwgsj,'yyyy') jhwgn,jz1.bywcc,jz1.bywcgl,jz2.yywcc,jz2.yywcgl,jz3.kgwcc,jz3.kgwcgl,
          jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
          xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
        from xmk_abgc xm,sck_abgc sc,plan_abgc p,
        (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
        (select jz.bywc_c bywcc,jz.bywc_gl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_abgc jz where jz.sbyf=#{sbyf}) jz1,
        (select sum(jz.bywc_c) yywcc,sum(jz.bywc_gl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
        (select sum(jz.bywc_c) kgwcc,sum(jz.bywc_gl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
        (select jhid,sbyf from gcgl_abgc where sbyf=#{sbyf} group by jhid,sbyf) y
        where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id and y.sbyf is not null
      ) 
			where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
	</select>
	<select id="getabgcbblist2" parameterType="gcglabgc" resultType="hashmap">
		select
			 ' ' lxbm,decode(instr(max(xzqhmc), '市'),0,max(xzqhmc),substr(min(xzqhmc), 0, instr(max(xzqhmc), '市')))||'合计' lxmc,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,sum(jhc) jhc,sum(jhgl) jhgl,' ' jhkgn,' ' jhwgn,sum(bywcc) bywcc,sum(bywcgl) bywcgl,
			sum(yywcc) yywcc,sum(yywcgl) yywcgl,sum(kgwcc) kgwcc,sum(kgwcgl) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr,substr(xzqhdm,0,4) xzqh
		from(
        select
          xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,p.jhwc_c jhc,sc.scyhlc jhgl,to_char(p.jhkgsj,'yyyy') jhkgn,
          to_char(p.jhwgsj,'yyyy') jhwgn,jz1.bywcc,jz1.bywcgl,jz2.yywcc,jz2.yywcgl,jz3.kgwcc,jz3.kgwcgl,
          jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
          xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
        from xmk_abgc xm,sck_abgc sc,plan_abgc p,
        (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
        (select jz.bywc_c bywcc,jz.bywc_gl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_abgc jz where jz.sbyf=#{sbyf}) jz1,
        (select sum(jz.bywc_c) yywcc,sum(jz.bywc_gl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
        (select sum(jz.bywc_c) kgwcc,sum(jz.bywc_gl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
        (select jhid,sbyf from gcgl_abgc where sbyf=#{sbyf} group by jhid,sbyf) y
        where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id and y.sbyf is not null
      ) 
			where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4) order by substr(xzqhdm,0,4)
	</select>
	<select id="getabgcbblist3" parameterType="gcglabgc" resultType="hashmap">
		select
			 ' ' lxbm,xdnf||'年项目' lxmc,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,sum(jhc) jhc,sum(jhgl) jhgl,' ' jhkgn,' ' jhwgn,sum(bywcc) bywcc,sum(bywcgl) bywcgl,
			sum(yywcc) yywcc,sum(yywcgl) yywcgl,sum(kgwcc) kgwcc,sum(kgwcgl) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr,substr(xzqhdm,0,4) xzqh,xdnf
		from(
        select
          xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,p.jhwc_c jhc,sc.scyhlc jhgl,to_char(p.jhkgsj,'yyyy') jhkgn,
          to_char(p.jhwgsj,'yyyy') jhwgn,jz1.bywcc,jz1.bywcgl,jz2.yywcc,jz2.yywcgl,jz3.kgwcc,jz3.kgwcgl,
          jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
          xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
        from xmk_abgc xm,sck_abgc sc,plan_abgc p,
        (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
        (select jz.bywc_c bywcc,jz.bywc_gl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_abgc jz where jz.sbyf=#{sbyf}) jz1,
        (select sum(jz.bywc_c) yywcc,sum(jz.bywc_gl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
        (select sum(jz.bywc_c) kgwcc,sum(jz.bywc_gl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
        (select jhid,sbyf from gcgl_abgc where sbyf=#{sbyf} group by jhid,sbyf) y
        where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id and y.sbyf is not null
      ) 
			where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4),xdnf order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getabgcbblist4" parameterType="gcglabgc" resultType="hashmap">
		select
			substr(xzqhdm,0,4) xzqh,tt.*
		from(
        select
          xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,p.jhwc_c jhc,sc.scyhlc jhgl,to_char(p.jhkgsj,'yyyy') jhkgn,
          to_char(p.jhwgsj,'yyyy') jhwgn,jz1.bywcc,jz1.bywcgl,jz2.yywcc,jz2.yywcgl,jz3.kgwcc,jz3.kgwcgl,
          jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
          xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
        from xmk_abgc xm,sck_abgc sc,plan_abgc p,
        (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
        (select jz.bywc_c bywcc,jz.bywc_gl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_abgc jz where jz.sbyf=#{sbyf}) jz1,
        (select sum(jz.bywc_c) yywcc,sum(jz.bywc_gl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
        (select sum(jz.bywc_c) kgwcc,sum(jz.bywc_gl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
        (select jhid,sbyf from gcgl_abgc where sbyf=#{sbyf} group by jhid,sbyf) y
        where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id and y.sbyf is not null
      ) 	tt
			where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getzhfzbblist1" parameterType="gcglzhfz" resultType="hashmap">
		select
			' ' lxbm,'总计' lxmc,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,sum(bywcgl) bywcgl,
			sum(yywcgl) yywcgl,sum(kgwcgl) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr
		from  (
		      select
		      xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,jz1.bywcgl,jz2.yywcgl,jz3.kgwcgl,
		      jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
		      xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
		    from xmk_zhfz xm,sck_zhfz sc,plan_zhfz p,
		    (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
		    (select jz.bywcgl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_zhfz jz where jz.sbyf=#{sbyf}) jz1,
		    (select sum(jz.bywcgl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from  gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
		    (select sum(jz.bywcgl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
		    (select jhid,sbyf from gcgl_zhfz where sbyf=#{sbyf} group by jhid,sbyf) y
		    where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid=p.id(+) and y.sbyf is not null
		    )
		where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
	</select>
	<select id="getzhfzbblist2" parameterType="gcglzhfz" resultType="hashmap">
		select
			' ' lxbm,decode(instr(max(xzqhmc), '市'),0,max(xzqhmc),substr(min(xzqhmc), 0, instr(max(xzqhmc), '市')))||'合计' lxmc,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,sum(bywcgl) bywcgl,
			sum(yywcgl) yywcgl,sum(kgwcgl) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr,substr(xzqhdm,0,4) xzqh
		from  (
		      select
		      xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,jz1.bywcgl,jz2.yywcgl,jz3.kgwcgl,
		      jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
		      xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
		    from xmk_zhfz xm,sck_zhfz sc,plan_zhfz p,
		    (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
		    (select jz.bywcgl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_zhfz jz where jz.sbyf=#{sbyf}) jz1,
		    (select sum(jz.bywcgl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from  gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
		    (select sum(jz.bywcgl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
		    (select jhid,sbyf from gcgl_zhfz where sbyf=#{sbyf} group by jhid,sbyf) y
		    where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid=p.id(+) and y.sbyf is not null
		    )
		where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4) order by substr(xzqhdm,0,4)
	</select>
	<select id="getzhfzbblist3" parameterType="gcglzhfz" resultType="hashmap">
		select
			' ' lxbm,xdnf||'年项目' lxmc,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,sum(bywcgl) bywcgl,
			sum(yywcgl) yywcgl,sum(kgwcgl) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr,substr(xzqhdm,0,4) xzqh,xdnf
			from  (
		      select
		      xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,jz1.bywcgl,jz2.yywcgl,jz3.kgwcgl,
		      jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
		      xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
		    from xmk_zhfz xm,sck_zhfz sc,plan_zhfz p,
		    (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
		    (select jz.bywcgl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_zhfz jz where jz.sbyf=#{sbyf}) jz1,
		    (select sum(jz.bywcgl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from  gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
		    (select sum(jz.bywcgl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
		    (select jhid,sbyf from gcgl_zhfz where sbyf=#{sbyf} group by jhid,sbyf) y
		    where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid=p.id(+) and y.sbyf is not null
		    )
		where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4),xdnf order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getzhfzbblist4" parameterType="gcglzhfz" resultType="hashmap">
		select
			substr(xzqhdm,0,4) xzqh,tt.*
		from  (
		      select
		      xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,jz1.bywcgl,jz2.yywcgl,jz3.kgwcgl,
		      jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
		      xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
		    from xmk_zhfz xm,sck_zhfz sc,plan_zhfz p,
		    (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj where zj.xdnf=#{xmnf} group by zj.xmid) zj1,
		    (select jz.bywcgl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_zhfz jz where jz.sbyf=#{sbyf}) jz1,
		    (select sum(jz.bywcgl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from  gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
		    (select sum(jz.bywcgl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
		    (select jhid,sbyf from gcgl_zhfz where sbyf=#{sbyf} group by jhid,sbyf) y
		    where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid=p.id(+) and y.sbyf is not null
		    ) tt
		where 1=1 
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		order by substr(xzqhdm,0,4),xdnf
	</select>
	<!--  -->
	<select id="getGjxjmxbsj" parameterType="string" resultType="hashmap">
		${value}
	</select>
</mapper>