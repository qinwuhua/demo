<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.xtgl">
	<select id="selLines" parameterType="dzdt" resultType="dzdt">
		select * from JXJCK_2013.webroadline where roadcode='G6001'
	</select>
	<select id="xmlxCountTj" parameterType="param" resultType="param">
		select id,name,(select name from xtgl_resource where id=t.parent) parent from xtgl_resource t where parent in ('01010201','01010203','01010301','01010402')
		and id !='0101030110'
		order by id
	</select>
	<select id="selSqlStrByLxid_sheng" parameterType="param" resultType="param">
		select count(*) id,'0101020101' name,'01010201' parent,'项目基础库' bz from xmk_wqgz where 1=1
		         <if test="sourceid != null and  sourceid != ''">
					and sbthcd=7 and <![CDATA[sbthcd>=length(#{sourceid})]]>
				</if>
			and   tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
          union all
          select count(*) id,'0101020102' name,'01010201' parent,'项目基础库' bz from xmk_abgc where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and sbthcd=7 and <![CDATA[sbthcd>=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})

 union all
          select count(*) id,'0101020103' name,'01010201' parent,'项目基础库' bz from xmk_zhfz where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and sbthcd=7 and <![CDATA[sbthcd>=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
 union all
          select count(*) id,'0101020301' name,'01010203' parent,'项目审查库' bz from (select * from sck_wqgz t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and sbthcd=7 and <![CDATA[sbthcd>=length(#{sourceid})]]>
				</if> and  
        tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
         xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
 union all
          select count(*) id,'0101020302' name,'01010203' parent,'项目审查库' bz from (select * from sck_abgc t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and sbthcd=7 and <![CDATA[sbthcd>=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
     union all
          select count(*) id,'0101020303' name,'01010203' parent,'项目审查库' bz from (select * from sck_zhfz t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
         <if test="sourceid != null and  sourceid != ''">
					and sbthcd=7 and <![CDATA[sbthcd>=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})

      union all
		select count(*) id,'0101030101' name,'01010301' parent ,'项目计划库' bz
		from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='1' and jh.spzt='0' and  
    	gydwbm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030102' name,'01010301' parent ,'项目计划库' bz
		from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) left join xmk_abgc lx on (sc.xmkid=lx.id) 
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='1' and jh.spzt='0' and  
		gydwbm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030103' name,'01010301' parent ,'项目计划库' bz
		from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) left join xmk_zhfz lx on (sc.xmkid=lx.id)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='1' and jh.spzt='0' and  
		gydwbm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030104' name,'01010301' parent ,'项目计划库' bz
		from plan_gcsj jh left join plan_lx_gcsj lx on (jh.id=lx.jhid)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='1' and jh.spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(id) id, '0101030105' name,'01010301' parent ,'项目计划库' bz
		from (select distinct jh.id from plan_gcgj jh left join plan_lx_gcgj lx on (jh.id=lx.jhid)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='1' and jh.spzt='0' and  
		gydwdm like rtrim(#{sourceid},0)||'%' and xzqhdm like rtrim(#{xzqh},0)||'%')
		   union all
		select count(*) id,'0101030106' name,'01010301' parent ,'项目计划库' bz
		from plan_yhdzx jh left join plan_lx_yhdzx lx on(jh.id=lx.jhid) 
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and sbzt='1' and spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030107' name,'01010301' parent ,'项目计划库' bz
		from plan_shuih jh left join plan_lx_shuih lx on (jh.id=lx.jhid)
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and sbzt='1' and spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030108' name,'01010301' parent,'项目计划库' bz from plan_hsly where xzqhdm like #{xzqh} 
		
     	union all
		select count(*) id,'0101040201' name,'01010402' parent ,'月报进度' bz
    from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id)  
    where sjsh='未审核' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwbm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040202' name,'01010402' parent ,'月报进度' bz
    from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) left join xmk_abgc lx on (sc.xmkid=lx.id) 
    where sjsh='未审核' and spzt='1' and kgzt='1' and jgzt='0' and 
    gydwbm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040203' name,'01010402' parent ,'月报进度' bz
    from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) left join xmk_zhfz lx on (sc.xmkid=lx.id)  
    where sjsh='未审核' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwbm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040204' name,'01010402' parent ,'月报进度' bz
    from plan_gcsj jh left join plan_lx_gcsj lx on (jh.id=lx.jhid)  
    where sjsh='未审核' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040205' name,'01010402' parent ,'月报进度' bz
    from plan_gcgj jh left join plan_lx_gcgj lx on (jh.id=lx.jhid)
    where sjsh='未审核' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040206' name,'01010402' parent ,'月报进度' bz
    from plan_yhdzx jh left join plan_lx_yhdzx lx on(jh.id=lx.jhid) 
    where sjsh='未审核' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040207' name,'01010402' parent ,'月报进度' bz
    from plan_shuih jh left join plan_lx_shuih lx on (jh.id=lx.id)
    where sjsh='未审核' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040208' name,'01010402' parent,'月报进度' bz from plan_hsly where xzqhdm like #{xzqh} 
   	and sjsh='未审核' and kgzt='1' and jgzt='0' 
	</select>
	<select id="selSqlStrByLxid_shi" parameterType="param" resultType="param">
		          select count(*) id,'0101020101' name,'01010201' parent,'项目基础库' bz from xmk_wqgz where 1=1 
		         <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if>
			and   tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
          union all
          select count(*) id,'0101020102' name,'01010201' parent,'项目基础库' bz from xmk_abgc where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})

 union all
          select count(*) id,'0101020103' name,'01010201' parent,'项目基础库' bz from xmk_zhfz where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
 union all
          select count(*) id,'0101020301' name,'01010203' parent,'项目审查库' bz from (select * from sck_wqgz t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
        tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
         xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
 union all
          select count(*) id,'0101020302' name,'01010203' parent,'项目审查库' bz from (select * from sck_abgc t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
     union all
          select count(*) id,'0101020303' name,'01010203' parent,'项目审查库' bz from (select * from sck_zhfz t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
         <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})

      union all
		select count(*) id,'0101030101' name,'01010301' parent ,'项目计划库' bz
		from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
    	gydwbm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030102' name,'01010301' parent ,'项目计划库' bz
		from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) left join xmk_abgc lx on (sc.xmkid=lx.id) 
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
		gydwbm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030103' name,'01010301' parent ,'项目计划库' bz
		from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) left join xmk_zhfz lx on (sc.xmkid=lx.id)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
		gydwbm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030104' name,'01010301' parent ,'项目计划库' bz
		from plan_gcsj jh left join plan_lx_gcsj lx on (jh.id=lx.jhid)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(id) id, '0101030105' name,'01010301' parent ,'项目计划库' bz
		from (select distinct jh.id from plan_gcgj jh left join plan_lx_gcgj lx on (jh.id=lx.jhid)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
		gydwdm like rtrim(#{sourceid},0)||'%' and xzqhdm like rtrim(#{xzqh},0)||'%')
		   union all
		select count(*) id,'0101030106' name,'01010301' parent ,'项目计划库' bz
		from plan_yhdzx jh left join plan_lx_yhdzx lx on(jh.id=lx.jhid) 
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and sbzt='0' and spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030107' name,'01010301' parent ,'项目计划库' bz
		from plan_shuih jh left join plan_lx_shuih lx on (jh.id=lx.jhid)
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and sbzt='0' and spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like rtrim(#{xzqh},0)||'%'
		   union all
		select count(*) id,'0101030108' name,'01010301' parent,'项目计划库' bz from plan_hsly where xzqhdm like rtrim(#{xzqh}) 
		
     	union all
		select count(*) id,'0101040201' name,'01010402' parent ,'月报进度' bz
    from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id)  
    where sjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwbm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040202' name,'01010402' parent ,'月报进度' bz
    from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) left join xmk_abgc lx on (sc.xmkid=lx.id) 
    where sjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and 
    gydwbm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040203' name,'01010402' parent ,'月报进度' bz
    from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) left join xmk_zhfz lx on (sc.xmkid=lx.id)  
    where sjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwbm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040204' name,'01010402' parent ,'月报进度' bz
    from plan_gcsj jh left join plan_lx_gcsj lx on (jh.id=lx.jhid)  
    where sjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040205' name,'01010402' parent ,'月报进度' bz
    from plan_gcgj jh left join plan_lx_gcgj lx on (jh.id=lx.jhid)
    where sjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040206' name,'01010402' parent ,'月报进度' bz
    from plan_yhdzx jh left join plan_lx_yhdzx lx on(jh.id=lx.jhid) 
    where sjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040207' name,'01010402' parent ,'月报进度' bz
    from plan_shuih jh left join plan_lx_shuih lx on (jh.id=lx.id)
    where sjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040208' name,'01010402' parent,'月报进度' bz from plan_hsly where xzqhdm like #{xzqh} 
    and  sjzt='未上报' and kgzt='1' and jgzt='0' 
	</select>
	<select id="selSqlStrByLxid_xian" parameterType="param" resultType="param">
		select count(*) id,'0101020101' name,'01010201' parent,'项目基础库' bz from xmk_wqgz where 1=1 
		         <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if>
			and   tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
          union all
          select count(*) id,'0101020102' name,'01010201' parent,'项目基础库' bz from xmk_abgc where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})

 union all
          select count(*) id,'0101020103' name,'01010201' parent,'项目基础库' bz from xmk_zhfz where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
 union all
          select count(*) id,'0101020301' name,'01010203' parent,'项目审查库' bz from (select * from sck_wqgz t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
        tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
         xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
 union all
          select count(*) id,'0101020302' name,'01010203' parent,'项目审查库' bz from (select * from sck_abgc t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
          <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})
     union all
          select count(*) id,'0101020303' name,'01010203' parent,'项目审查库' bz from (select * from sck_zhfz t join xmk_abgc on xmkid=xmk_abgc.id) t  where 1=1 
         <if test="sourceid != null and  sourceid != ''">
					and <![CDATA[sbthcd<=length(#{sourceid})]]>
				</if> and  
            tbbmbm in(select id from xtgl_department where id like #{sourceid}||'%' or parent like #{sourceid}||'%') and 
             xzqhdm in(select id from xtgl_xzqh where id=#{xzqh} or parent=#{xzqh})

      union all
		select count(*) id,'0101030101' name,'01010301' parent ,'项目计划库' bz
		from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='1' and jh.spzt='0' and  
    	gydwbm like #{sourceid}||'%' and xzqhdm like #{xzqh}
		   union all
		select count(*) id,'0101030102' name,'01010301' parent ,'项目计划库' bz
		from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) left join xmk_abgc lx on (sc.xmkid=lx.id) 
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
		gydwbm like #{sourceid}||'%' and xzqhdm like #{xzqh}
		   union all
		select count(*) id,'0101030103' name,'01010301' parent ,'项目计划库' bz
		from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) left join xmk_zhfz lx on (sc.xmkid=lx.id)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
		gydwbm like #{sourceid}||'%' and xzqhdm like #{xzqh}
		   union all
		select count(*) id,'0101030104' name,'01010301' parent ,'项目计划库' bz
		from plan_gcsj jh left join plan_lx_gcsj lx on (jh.id=lx.jhid)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like #{xzqh}
		   union all
		select count(id) id, '0101030105' name,'01010301' parent ,'项目计划库' bz
		from (select distinct jh.id from plan_gcgj jh left join plan_lx_gcgj lx on (jh.id=lx.jhid)  
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and jh.sbzt='0' and jh.spzt='0' and  
		gydwdm like rtrim(#{sourceid},0)||'%' and xzqhdm like #{xzqh})
		   union all
		select count(*) id,'0101030106' name,'01010301' parent ,'项目计划库' bz
		from plan_yhdzx jh left join plan_lx_yhdzx lx on(jh.id=lx.jhid) 
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and sbzt='0' and spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like #{xzqh}
		   union all
		select count(*) id,'0101030107' name,'01010301' parent ,'项目计划库' bz
		from plan_shuih jh left join plan_lx_shuih lx on (jh.id=lx.jhid)
		where jh_sbthcd=11-length(rtrim(#{sourceid},0)) and sbzt='0' and spzt='0' and  
		gydwdm like #{sourceid}||'%' and xzqhdm like #{xzqh}
		   union all
		select count(*) id,'0101030108' name,'01010301' parent,'项目计划库' bz from plan_hsly where xzqhdm like #{xzqh} 
		
     	union all
		select count(*) id,'0101040201' name,'01010402' parent ,'月报进度' bz
    from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id)  
    where xjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwbm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040202' name,'01010402' parent ,'月报进度' bz
    from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) left join xmk_abgc lx on (sc.xmkid=lx.id) 
    where xjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and 
    gydwbm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040203' name,'01010402' parent ,'月报进度' bz
    from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) left join xmk_zhfz lx on (sc.xmkid=lx.id)  
    where xjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwbm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040204' name,'01010402' parent ,'月报进度' bz
    from plan_gcsj jh left join plan_lx_gcsj lx on (jh.id=lx.jhid)  
    where xjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%'
       union all
    select count(*) id,'0101040205' name,'01010402' parent ,'月报进度' bz
    from plan_gcgj jh left join plan_lx_gcgj lx on (jh.id=lx.jhid)
    where xjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040206' name,'01010402' parent ,'月报进度' bz
    from plan_yhdzx jh left join plan_lx_yhdzx lx on(jh.id=lx.jhid) 
    where xjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040207' name,'01010402' parent ,'月报进度' bz
    from plan_shuih jh left join plan_lx_shuih lx on (jh.id=lx.id)
    where xjzt='未上报' and spzt='1' and kgzt='1' and jgzt='0' and
    gydwdm like #{sourceid}||'%' 
       union all
    select count(*) id,'0101040208' name,'01010402' parent,'月报进度' bz from plan_hsly where xzqhdm like #{xzqh} 
	and xjzt='未上报' and kgzt='1' and jgzt='0' 
	</select>
	<select id="selectExistQlProgramList" parameterType="param" resultType="pb">
		select qlmc xmmc,qlzxzh roadstart,qlbh roadbm,gydw unit,sbnf nf,gydwbm,xzqhdm
    from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id)  
    where  
    gydwbm like #{sourceid}||'%' and xzqhdm like #{xzqh}
	</select>
	<select id="selectExistQlProgramListCount" parameterType="param" resultType="pb">
		
	</select>
	<select id="selectExistLxProgramList" parameterType="param" resultType="int">
		
	</select>
	<select id="selectExistLxProgramListCount" parameterType="param" resultType="int">
		
	</select>
</mapper>
