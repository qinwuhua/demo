<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.wnjh">
	<select id="selectimportXmbm" parameterType="String" resultType="String">
		${value}
	</select>
	<select id="selectXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_sjgz where xmbm like ${value}||'%'
	</select>
	<select id="selectlmgzXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_lmgz where xmbm like ${value}||'%'
	</select>
	<select id="selectxjXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_xj where xmbm like ${value}||'%'
	</select>
	<select id="selectbzcs" parameterType="lxsh" resultType="lxsh">
		select bzzj bzys from PLAN_FLWBZBZ where xmlx=#{xmlx} and gldj=#{gldj} and jsdj like #{jsdj}||'%'
	</select>
	<select id="selectSFCF" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_LX where lxbm=#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh})) and substr(xmid,0,4)=#{xmnf}
	</select>
	<select id="selectSFCFLX" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_LX where lxbm=#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh})) and substr(xmid,0,4)=substr(#{xmbm},0,4) and jdbs=#{jdbs}
	</select>
	<select id="selectSFCF1" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_LMGZ where ghlxbh =#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh})) and xmnf=#{xmnf}
	</select>
	<select id="selectSFCF2" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_XJ where ghlxbh =#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh})) and xmnf=#{xmnf}
	</select>
	<insert id="insertGjwnjh" parameterType="lxsh">
		insert into WNJH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk,jhlc)
		values(#{xmbm},#{lxmc},' ',#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},' ',#{bz},#{yhdk},#{jhlc})
	</insert>
	<insert id="insertLmwnjh" parameterType="lxsh">
		insert into WNJH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk)
		values(#{xmbm},#{lxmc},' ',#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},' ',#{bz},#{yhdk})
	</insert>
	<insert id="insertXjwnjh" parameterType="lxsh">
		insert into WNJH_XJ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk)
		values(#{xmbm},#{lxmc},' ',#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},' ',#{bz},#{yhdk})
	</insert>
	<insert id="insertlx" parameterType="lxsh">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc</if>
		,yilc,erlc,sanlc,silc,dwlc,wllc
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},'1',#{jdbs},#{gpsqdzh},#{gpszdzh}
		<if test="xjlxbm!='' and xjlxbm!=null">,#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,#{xjlc}</if>
		,#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc}
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>)
	</insert>
	<insert id="insertLx" parameterType="lxsh">
		insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},'0',#{jdbs},#{gpsqdzh},#{gpszdzh})
	</insert>
	<insert id="insertLx1" parameterType="lxsh">
		insert into lxsh_lx (xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, jdbs,gpsqdzh,gpszdzh,jsfa,xjlxbm,xjqdzh,xjzdzh,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc ,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc)
		select xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, to_char(to_number(#{jdbs})),gpsqdzh,gpszdzh,jsfa,xjlxbm,xjqdzh,xjzdzh,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc   ,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc from lxsh_lx where xmid = #{xmbm} and jdbs=to_char(to_number(#{jdbs})-1)
		<!-- insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},#{sffirst},#{jdbs},#{gpsqdzh},#{gpszdzh}) -->
	</insert>
	<select id="querylxlist" parameterType="lxsh" resultType="lxsh">
		select t.*,bzcs bzys,xmid xmbm,lxbm ghlxbh from lxsh_lx t where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<!--  华丽的分割线________________________________________________________华丽的分割线 -->
	<select id="selectGjwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl from WNJH_SJGZ t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		from WNJH_LX group by xmid) lx on t.id=lx.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid  where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectGjwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from WNJH_SJGZ where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
	</select>
	<select id="selectLmwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.xmnf,t.jhkgn,t.jhwgn,t.jsxz,t.yhdk,t.bz,t.id,t.lxmc,t.shzt,t.xmmc,t.xmbm,t.gydw,t.xzqh,t.ghlxbh,t.qdmc,t.zdmc,t.xjsdj,t.jsjsdj,t.tz,t.bzys,t.dfzc,t.tsdq,lx.*,lx1.sl  from wnjh_lmgz t left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc from wnjh_lx group by xmid) lx on t.id=lx.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>		
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>		
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectLmwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from wnjh_lmgz where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
	</select>
	
	<select id="selectXjwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,tt.bzys1,lx1.* from WNJH_XJ t left join (select xmid,sum(bzcs) bzys1 from wnjh_lx where sffirst='1' group by xmid) tt on t.id=tt.xmid left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,max(xjlxbm) xjlxbm,max(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,max(xjlc) xjlc
		from wnjh_lx group by xmid) lx1 on t.id=lx1.xmid
		where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectXjwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from WNJH_XJ where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
	</select>
	
	
	
	<select id="wnjhGpsroad" parameterType="lxsh" resultType="lxsh">
		select lxbm ghlxbh,lxmc,qdzh,zdzh,qzlc lc,qdmc,zdmc,yjsdj xjsdj
		from table(funNoLmlx(#{ghlxbh},#{xzqh})) order by lxbm,qdzh
	</select>
	
	
	<select id="selectSjgzlxList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.id,xmid xmbm,lxbm ghlxbh,lxmc,xzqh,zdzh,qdzh,gydw,xzqhdm,gydwdm,jsjsdj,xjsdj,lc,jsxz,qdmc,zdmc,t.bzcs bzys  from WNJH_LX t where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectSjgzlxListCount" parameterType="lxsh" resultType="int">
		select count(*) from WNJH_LX where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
	</select>

	<delete id="deletelmgzkxx" parameterType="hashmap">
		delete from kxxyj_lmgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletesjgzkxx" parameterType="hashmap">
		delete from kxxyj_sjgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletexjkxx" parameterType="hashmap">
		delete from kxxyj_xj where xmbm=#{xmbm}
	</delete>

	<update id="updateSjgz" parameterType="lxsh">
		update wnjh_sjgz set qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},yhdk=#{yhdk},bz=#{bz}  
		where id=#{xmbm}
	</update>
	<update id="updateLmgz" parameterType="lxsh">
		update wnjh_LMGZ set qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},yhdk=#{yhdk},bz=#{bz}  
		where id=#{xmbm}
	</update>
	<update id="updateXj" parameterType="lxsh">
		update wnjh_XJ set ghlxbh=#{ghlxbh},lxmc=#{lxmc},xjsdj=#{xjsdj},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},bz=#{bz},yhdk=#{yhdk}  
		where id=#{xmbm}
	</update>
	<update id="updateSjgzlx" parameterType="lxsh">
		update WNJH_LX set qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},bzcs=#{bzys}
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm=#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh=#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh=#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc=#{xjlc}</if>
		<if test="yilc!='' and yilc!=null">,yilc=#{yilc}</if><if test="erlc!='' and erlc!=null">,erlc=#{erlc}</if>
		<if test="xjlc!='' and xjlc!=null">,sanlc=#{sanlc}</if><if test="silc!='' and silc!=null">,silc=#{silc}</if>
		<if test="dwlc!='' and dwlc!=null">,dwlc=#{dwlc}</if><if test="wllc!='' and wllc!=null">,wllc=#{wllc}</if>
		<if test="jhyilc!=null">,jhyilc=#{jhyilc}</if>
		<if test="jherlc!=null">,jherlc=#{jherlc}</if>
		<if test="jhsanlc!=null">,jhsanlc=#{jhsanlc}</if>
		<if test="jhsilc!=null">,jhsilc=#{jhsilc}</if>
		<if test="jhdwlc!=null">,jhdwlc=#{jhdwlc}</if>
		<if test="jhwllc!=null">,jhwllc=#{jhwllc}</if>
		<if test="jhlc!=null">,jhlc=#{jhlc}</if>
		where xmid=#{xmbm} and sffirst='1' 
	</update>
	<select id="queryMaxbzcs" parameterType="lxsh" resultType="double">
		select sum(to_number(bzcs)) from WNJH_LX where xmid=#{xmbm} 
	</select>
	<select id="queryMaxlc" parameterType="lxsh" resultType="double">
		select sum(to_number(lc)) from WNJH_LX where xmid=#{xmbm} 
	</select>
	<select id="cxwnghsjByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj, 
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,jhlc
		from wnjh_sjgz l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<select id="cxwnghlmByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj, 
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc 
		from wnjh_lmgz l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<select id="cxwnghxjByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj, 
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,l1.xjlxbm,l1.xjqdzh,l1.xjzdzh,l1.xjlc  
		from wnjh_xj l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<delete id="delwnjhSjgz" parameterType="hashmap">
		delete from WNJH_SJGZ where id=#{xmbm}
	</delete>
	<delete id="delwnjhLmgz" parameterType="hashmap">
		delete from WNJH_LMGZ where id=#{xmbm}
	</delete>
	<delete id="delwnjhXj" parameterType="hashmap">
		delete from WNJH_XJ where id=#{xmbm}
	</delete>
	<delete id="delwnjhSjgzlx" parameterType="hashmap">
		delete from WNJH_LX where xmid=#{xmbm}
	</delete>	
	<select id="queryshsjgz" parameterType="string" resultType="lxsh">
		select * from LXSH_SJGZ where ${value}
	</select>
	<select id="queryshlmgz" parameterType="string" resultType="lxsh">
		select * from LXSH_LMGZ where ${value}
	</select>
	<select id="queryshxj" parameterType="string" resultType="lxsh">
		select * from LXSH_XJ where ${value}
	</select>
	<insert id="insertsjgzkxx" parameterType="lxsh">
		insert into kxxyj_sjgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	<insert id="insertlmgzkxx" parameterType="lxsh">
		insert into kxxyj_lmgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	<insert id="insertxjkxx" parameterType="lxsh">
		insert into kxxyj_xj(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	
	<select id="Lmgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_lmgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="sjgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_sjgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="Xjsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_xj where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="qqglGpsroad" parameterType="lxsh" resultType="lxsh">
		select lxbm ghlxbh,lxmc,qdzh,zdzh,qzlc lc,qdmc,zdmc,yjsdj xjsdj
		from table(funNoLmlx(#{ghlxbh},#{xzqh})) order by lxbm,qdzh
	</select>
	<update id="updatesjgz" parameterType="lxsh">
		update lxsh_sjgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<update id="updatelmgz" parameterType="lxsh">
		update lxsh_lmgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<update id="updatexj" parameterType="lxsh">
		update lxsh_xj set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<delete id="deleteLx" parameterType="lxsh">
		delete from lxsh_lx where xmid=#{xmbm} and id=#{id} 
	</delete>
	<select id="cxqdmc" parameterType="lxsh" resultType="lxsh">
		select min(f006) qdmc from gpsroad g,
       (SELECT MIN(ABS(ROADSTART- to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.roadstart=to_number(#{qdzh})+t.a or g.roadstart=to_number(#{qdzh})-t.a )
	</select>
	<select id="cxzdmc" parameterType="lxsh" resultType="lxsh">
		select min(f010) zdmc from gpsroad g,
       (SELECT MIN(ABS(ROADENDS-to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.ROADENDS=to_number(#{qdzh})+t.a or g.ROADENDS=to_number(#{qdzh})-t.a )
	</select>
	<delete id="deletekxlx" parameterType="hashmap">
		delete from lxsh_lx where xmid=#{xmbm} and jdbs='1'
	</delete>
	<select id="selectlxbyxmid" parameterType="lxsh" resultType="lxsh">
		select * from lxsh_lx where xmid=#{xmbm} and jdbs='0' and sffirst='1'
	</select>
	<select id="sfylx" parameterType="lxsh" resultType="lxsh">
		select count(*) shzt from wnjh_lx where xmid=#{xmbm} and sffirst='0'
	</select>
	<select id="qqglGpszh" parameterType="lxsh" resultType="lxsh">
		select gpsqdzh qdzh,gpszdzh zdzh from  wnjh_lx where lxbm=#{ghlxbh} and xmid=#{xmbm} and sffirst='1'
	</select>
	<select id="selectlxbyxmid1" parameterType="lxsh" resultType="lxsh">
		select lxbm,qdzh,zdzh from wnjh_lx where xmid=#{xmbm}
	</select>
	
	<select id="querywnjhSjgz" parameterType="lxsh" resultType="elist">
		select lx.lxbm v_0,lx.lxmc v_1,lx.qdzh v_2,lx.zdzh v_3,lx.qdmc v_4,lx.zdmc v_5,'改建' v_6,lx.gydw v_7,lx.xzqh v_8,t.tsdq v_9,lx.jsjsdj v_10,lx.xjsdj v_11,t.xmnf v_12,t.jhkgn v_13,t.jhwgn v_14,t.tz v_15,lx.bzcs v_16 from WNJH_SJGZ t left join
		(select * from wnjh_lx where 1=1 and jdbs='0' and sffirst='1') lx on t.id=lx.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>
	<select id="querywnjhLmgz" parameterType="lxsh" resultType="elist">
		select lx.lxbm v_0,lx.lxmc v_1,lx.qdzh v_2,lx.zdzh v_3,lx.qdmc v_4,lx.zdmc v_5,'路面改造' v_6,lx.gydw v_7,lx.xzqh v_8,t.tsdq v_9,lx.jsjsdj v_10,lx.xjsdj v_11,t.xmnf v_12,t.jhkgn v_13,t.jhwgn v_14,t.tz v_15,lx.bzcs v_16 from WNJH_LMGZ t left join
		(select * from wnjh_lx where 1=1 and jdbs='0' and sffirst='1') lx on t.id=lx.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>
	<select id="querywnjhXj" parameterType="lxsh" resultType="elist">
		select lx.lxbm v_0,lx.lxmc v_1,lx.qdzh v_2,lx.zdzh v_3,lx.qdmc v_4,lx.zdmc v_5,'新建' v_6,lx.gydw v_7,lx.xzqh v_8,t.tsdq v_9,lx.jsjsdj v_10,lx.xjsdj v_11,t.xmnf v_12,t.jhkgn v_13,t.jhwgn v_14,t.tz v_15,lx.bzcs v_16 from WNJH_XJ t,
		(select * from wnjh_lx where 1=1 and sffirst='1') lx  where 1=1 and t.xmbm=lx.xmid(+)
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>

	<insert id="importsjgzwnjh" parameterType="hashMap">
		insert into WNJH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,tsdq)
		values(#{xmbm},#{2},' ',#{1},to_char(to_number(#{4})-to_number(#{3})),#{19},#{3},#{4},#{5},#{6},#{25},#{26},#{23},#{24},#{xmbm},#{27},#{bzys},to_char(to_number(#{27})-to_number(#{bzys})),#{21},#{20},(select id from XTGL_XZQH where trim(name) = #{21}),(select id from XTGL_DEPARTMENT where trim(name) = #{20}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{20}),#{22})
	</insert>
	<insert id="importlmgzwnjh" parameterType="hashMap">
		insert into WNJH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,tsdq)
		values(#{xmbm},#{2},' ',#{1},to_char(to_number(#{4})-to_number(#{3})),#{13},#{3},#{4},#{5},#{6},#{19},#{20},#{17},#{18},#{xmbm},#{21},#{bzys},to_char(to_number(#{21})-to_number(#{bzys})),#{15},#{14},(select id from XTGL_XZQH where trim(name) = #{15}),(select id from XTGL_DEPARTMENT where trim(name) = #{14}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{14}),#{16})
	</insert>
	<insert id="importxjwnjh" parameterType="hashMap">
		insert into WNJH_XJ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,
		tsdq)
		values(#{xmbm},#{2},' ',#{1},to_char(to_number(#{4})-to_number(#{3})),#{17},#{3},#{4},#{5},#{6},#{23},#{24},#{21},#{22},#{xmbm},#{25},#{26},to_char(to_number(#{25})-to_number(#{26})),#{19},#{18},(select id from XTGL_XZQH where trim(name) = #{19}),(select id from XTGL_DEPARTMENT where trim(name) = #{18}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{18}),
		#{20})
	</insert>
	<insert id="importsjgzwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,jhlc)
		values(sys_guid(),#{xmbm},#{1},#{2},#{21},(select id from XTGL_XZQH where trim(name) = #{21}),#{20},(select id from XTGL_DEPARTMENT where trim(name) = #{20}),#{3},#{4},#{23},to_char(to_number(#{4})-to_number(#{3})),#{24},#{19},#{5},#{6},#{bzys},'1','0',#{3},#{4},
		#{7},#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17},#{18},(#{13}+#{14}+#{15}+#{16}+#{17}+#{18}))
	</insert>
	<insert id="importlmgzwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		yilc,erlc,sanlc,silc,dwlc,wllc)
		values(sys_guid(),#{xmbm},#{1},#{2},#{15},(select id from XTGL_XZQH where trim(name) = #{15}),#{14},(select id from XTGL_DEPARTMENT where trim(name) = #{13}),#{3},#{4},#{17},to_char(to_number(#{4})-to_number(#{3})),#{19},#{13},#{5},#{6},#{bzys},'1','0',#{3},#{4},
		#{7},#{8},#{9},#{10},#{11},#{12})
	</insert>
	<insert id="importxjwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		xjlxbm,xjqdzh,xjzdzh,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc)
		values(sys_guid(),#{xmbm},#{1},#{2},#{19},(select id from XTGL_XZQH where trim(name) = #{19}),#{18},(select id from XTGL_DEPARTMENT where trim(name) = #{18}),#{3},#{4},#{21},to_char(to_number(#{4})-to_number(#{3})),#{22},#{17},#{5},#{6},#{26},'1','0',#{3},#{4},
		#{7},#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16})
	</insert>

	<select id="selectWqbzbz" resultType="wqbzbz">
		select t.* from xtgl_wqbzbz t order by decode(t.bzjb,'省级',1,'市级',2),decode(t.qllx,'特大桥',1,'大桥',2,'中桥',3,'小桥',4),decode(t.jsxz,'拆除重建',1,'加固改造',2)
	</select>
	<insert id="tjwqbzbz" parameterType="wqbzbz">
		insert into xtgl_wqbzbz (id,qllx,jsxz,jsdj,bzje,zdkd,bzjb,jsdj1)
		values(sys_guid(),#{qllx},#{jsxz},#{jsdj},#{bzje},#{zdkd},#{bzjb},#{jsdj1})
	</insert>
	<insert id="xgwqbzbz" parameterType="wqbzbz">
		update xtgl_wqbzbz
		set qllx=#{qllx},jsxz=#{jsxz},jsdj=#{jsdj},bzje=#{bzje},zdkd=#{zdkd},bzjb=#{bzjb},jsdj1=#{jsdj1}
		where id=#{id}
	</insert>
	<delete id="delwqbzbz" parameterType="wqbzbz">
		delete from xtgl_wqbzbz where id=#{id}
	</delete>
	<select id="queryXmQqfx" parameterType="java.util.Map" resultType="kxxyj">
		select distinct * from table(funlxjdbs('','')) 
		where xmbm like to_char(sysdate,'yyyy')||'%'
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="shzt!=null and shzt!=''">and shzt = #{shzt}</if>
		<if test="jsxz!=null and jsxz!=''">and jsxz = #{jsxz}</if>
		<if test="lxbm!=null and lxbm!=''">and lxbm like '%'||#{lxbm}||'%' </if>
		<if test="wgny!=null and wgny!=''">and (wgny = #{wgny} or wgny = to_char(to_date(#{wgny},'yyyy-mm-ss'),'yyyy') or wgny = to_char( to_date(#{wgny},'yyyy-MM-ss'),'yyyy-mm'))</if>
		<if test="xmbm!=null and xmbm!=''">and xmbm in (${xmbm})</if>
		order by xmbm
	</select>
	<select id="queryBeformXm" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,1,4) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
		sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
		sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL
		from gpsroad  WHERE substr(roadcode,1,4) in(${lxbm}) group by substr(roadcode,1,4)
	</select>
	<select id="queryBeformXmByXzqh" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,0,1) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
	    sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
	    sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL,#{xzqhmc} xzqhmc
	    from gpsroad  WHERE substr(roadcode,0,1) in('S','G') and (roadcode like '%'||#{xzqhdm}||'%') group by substr(roadcode,0,1)
	</select>
	<select id="queryNdwg" parameterType="java.util.Map" resultType="java.util.Map">
		select xmid,lxbm
		,decode(substr(xmid,11,1),1,sum(l.yilc),3,0) yilc
		,decode(substr(xmid,11,1),1,sum(l.erlc),3,0) erlc
		,decode(substr(xmid,11,1),1,sum(l.sanlc),3,0) sanlc
		,decode(substr(xmid,11,1),1,sum(l.silc),3,0) silc
		,decode(substr(xmid,11,1),1,sum(l.dwlc),3,0) dwlc
		,decode(substr(xmid,11,1),1,sum(l.wllc),3,0) wllc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhyilc),0),3,nvl(sum(l.yilc),0)) jhyilc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jherlc),0),3,nvl(sum(l.erlc),0)) jherlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhsanlc),0),3,nvl(sum(l.sanlc),0)) jhsanlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhsilc),0),3,nvl(sum(l.silc),0)) jhsilc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhdwlc),0),3,nvl(sum(l.dwlc),0)) jhdwlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhwllc),0),3,nvl(sum(l.wllc),0)) jhwllc
		from lxsh_lx l where ${xmbm} group by xmid,lxbm 
	</select>
	<select id="queryNdwgXzqh" parameterType="java.util.Map" resultType="java.util.Map">
		select 
		<if test="qb==false">substr(xmid,5,6) xzqhdm,</if>
		<if test="qb==true">'江西省' xzqhmc,</if>
		substr(lxbm,0,1) lxbm
		,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc
		,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(sanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc 
		from(select xmid,lxbm
		,decode(substr(xmid,11,1),1,l.yilc,3,0) yilc,decode(substr(xmid,11,1),1,l.erlc,3,0) erlc
		,decode(substr(xmid,11,1),1,l.sanlc,3,0) sanlc,decode(substr(xmid,11,1),1,l.silc,3,0) silc
		,decode(substr(xmid,11,1),1,l.dwlc,3,0) dwlc,decode(substr(xmid,11,1),1,l.wllc,3,0) wllc
		,decode(substr(xmid,11,1),1,nvl(l.jhyilc,0),3,nvl(l.yilc,0)) jhyilc,decode(substr(xmid,11,1),1,nvl(l.jherlc,0),3,nvl(l.erlc,0)) jherlc
		,decode(substr(xmid,11,1),1,nvl(l.jhsanlc,0),3,nvl(l.sanlc,0)) jhsanlc,decode(substr(xmid,11,1),1,nvl(l.jhsilc,0),3,nvl(l.silc,0)) jhsilc
		,decode(substr(xmid,11,1),1,nvl(l.jhdwlc,0),3,nvl(l.dwlc,0)) jhdwlc,decode(substr(xmid,11,1),1,nvl(l.jhwllc,0),3,nvl(l.wllc,0)) jhwllc
		from lxsh_lx l where substr(lxbm,0,1) in('S','G') and (${xmbm})) 
		group by <if test="qb==false">substr(xmid,5,6),</if>substr(lxbm,0,1)
	</select>
</mapper>

