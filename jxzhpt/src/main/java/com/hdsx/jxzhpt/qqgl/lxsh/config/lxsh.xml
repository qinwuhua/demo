<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.lxsh">
	<select id="selectXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_sjgz where xmbm like ${value}||'%'
	</select>
	<select id="selectlmgzXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_lmgz where xmbm like ${value}||'%'
	</select>
	<select id="selectxjXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_xj where xmbm like ${value}||'%'
	</select>
	<select id="selectbzcs" parameterType="lxsh" resultType="lxsh">
		select bzzj bzys from PLAN_FLWBZBZ where xmlx=#{xmlx} and gldj=#{gldj} and jsdj=#{jsdj}
	</select>
	<select id="selectSFCF" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_SJGZ where ghlxbh =#{ghlxbh} and qdzh=#{qdzh} and zdzh=#{zdzh} and xmnf=#{xmnf}
	</select>
	<select id="selectSFCFLX" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_LX where lxbm=#{ghlxbh} and qdzh=#{qdzh} and zdzh=#{zdzh} and xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<select id="selectSFCF1" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_LMGZ where ghlxbh =#{ghlxbh} and qdzh=#{qdzh} and zdzh=#{zdzh} and xmnf=#{xmnf}
	</select>
	<select id="selectSFCF2" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_XJ where ghlxbh =#{ghlxbh} and qdzh=#{qdzh} and zdzh=#{zdzh} and xmnf=#{xmnf}
	</select>
	<insert id="insertSjgz" parameterType="lxsh">
		insert into LXSH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl)
		values(sys_guid(),#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl})
	</insert>
	<insert id="insertLmgz" parameterType="lxsh">
		insert into LXSH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl)
		values(sys_guid(),#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl})
	</insert>
	<insert id="insertXj" parameterType="lxsh">
		insert into LXSH_XJ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl)
		values(sys_guid(),#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl})
	</insert>
	<insert id="insertlx" parameterType="lxsh">
		insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},'1',#{jdbs})
	</insert>
	<insert id="insertLx" parameterType="lxsh">
		insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},'0',#{jdbs})
	</insert>
	<insert id="insertLx1" parameterType="lxsh">
		insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},#{sffirst},#{jdbs})
	</insert>
	<select id="querylxlist" parameterType="lxsh" resultType="lxsh">
		select t.*,bzcs bzys,xmid xmbm,lxbm ghlxbh from lxsh_lx t where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<select id="selectSjgzList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) sbzt1  from LXSH_SJGZ t where 1=1
			and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectSjgzListCount" parameterType="lxsh" resultType="int">
		select count(*) from LXSH_SJGZ where 1=1
		and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
	</select>
	<select id="selectSjgzlxList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.id,xmid xmbm,lxbm ghlxbh,lxmc,xzqh,zdzh,qdzh,gydw,xzqhdm,gydwdm,jsjsdj,xjsdj,lc,jsxz,qdmc,zdmc  from LXSH_LX t where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
		<if test="jdbs!='' and jdbs!= null ">
			and jdbs like '%'||#{jdbs}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectSjgzlxListCount" parameterType="lxsh" resultType="int">
		select count(*) from LXSH_LX where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
		<if test="jdbs!='' and jdbs!= null ">
			and jdbs like '%'||#{jdbs}||'%'
		</if>
	</select>
	<update id="sbsjgzSbzt" parameterType="hashmap">
		update LXSH_SJGZ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="sblmgzSbzt" parameterType="hashmap">
		update LXSH_LMGZ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="sbxjSbzt" parameterType="hashmap">
		update LXSH_XJ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thSjgzSbzt" parameterType="hashmap">
		update LXSH_SJGZ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thSjgzSbzt1" parameterType="hashmap">
		update LXSH_SJGZ set shzt=0 where xmbm=#{xmbm}
	</update>
	<update id="thLmgzSbzt" parameterType="hashmap">
		update LXSH_LMGZ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thLmgzSbzt1" parameterType="hashmap">
		update LXSH_LMGZ set shzt=0 where xmbm=#{xmbm}
	</update>
	<delete id="deletelmgzkxx" parameterType="hashmap">
		delete from kxxyj_lmgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletesjgzkxx" parameterType="hashmap">
		delete from kxxyj_sjgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletexjkxx" parameterType="hashmap">
		delete from kxxyj_xj where xmbm=#{xmbm}
	</delete>
	<update id="thXjSbzt" parameterType="hashmap">
		update LXSH_XJ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thXjSbzt1" parameterType="hashmap">
		update LXSH_XJ set shzt=0 where xmbm=#{xmbm}
	</update>
	<update id="updateSjgz" parameterType="lxsh">
		update LXSH_SJGZ set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq} 
		where xmbm=#{xmbm}
	</update>
	<update id="updateLmgz" parameterType="lxsh">
		update LXSH_LMGZ set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq}  
		where xmbm=#{xmbm}
	</update>
	<update id="updateXj" parameterType="lxsh">
		update LXSH_XJ set ghlxbh=#{ghlxbh},lxmc=#{lxmc},xjsdj=#{xjsdj},xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq}  
		where xmbm=#{xmbm}
	</update>
	<update id="updateSjgzlx" parameterType="lxsh">
		update LXSH_LX set qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},bzcs=#{bzys}
		where xmid=#{xmbm} and sffirst='1' and jdbs=#{jdbs}
	</update>
	<select id="queryMaxbzcs" parameterType="lxsh" resultType="double">
		select sum(to_number(bzcs)) from LXSH_LX where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<select id="queryMaxlc" parameterType="lxsh" resultType="double">
		select sum(to_number(lc)) from LXSH_LX where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<select id="selectSjgzshList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*  from LXSH_SJGZ t where 1=1
			and  sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and  shzt=#{sbzt1}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by shzt,xmbm
	</select>
	<select id="selectSjgzshListCount" parameterType="lxsh" resultType="int">
		select count(*) from LXSH_SJGZ where 1=1
		and  sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and shzt=#{sbzt1}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
	</select>
	<select id="selectLmgzshList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*  from LXSH_LMGZ t where 1=1
			and  sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and shzt=#{sbzt1}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by shzt,xmbm
	</select>
	<select id="selectLmgzshListCount" parameterType="lxsh" resultType="int">
		select count(*) from LXSH_LMGZ where 1=1
		and  sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and shzt=#{sbzt1}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
	</select>
	
	<select id="selectXjshList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*  from LXSH_XJ t where 1=1
			and  sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and shzt=#{sbzt1}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by shzt,xmbm
	</select>
	<select id="selectXjshListCount" parameterType="lxsh" resultType="int">
		select count(*) from LXSH_XJ where 1=1
		and  sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and shzt=#{sbzt1}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>
	<delete id="delSjgz" parameterType="hashmap">
		delete from LXSH_SJGZ where xmbm=#{xmbm}
	</delete>
	<delete id="delLmgz" parameterType="hashmap">
		delete from LXSH_LMGZ where xmbm=#{xmbm}
	</delete>
	<delete id="delXj" parameterType="hashmap">
		delete from LXSH_XJ where xmbm=#{xmbm}
	</delete>
	<delete id="delSjgzlx" parameterType="hashmap">
		delete from LXSH_LX where xmid=#{xmbm}
	</delete>
	<update id="shsjgzSbzt" parameterType="hashmap">
		update LXSH_SJGZ set shzt=1 where id=#{id}
	</update>
	<update id="shlmgzSbzt" parameterType="hashmap">
		update LXSH_LMGZ set shzt=1 where id=#{id}
	</update>
	<update id="shxjSbzt" parameterType="hashmap">
		update LXSH_XJ set shzt=1 where id=#{id}
	</update>
	<select id="queryshsjgz" parameterType="string" resultType="lxsh">
		select * from LXSH_SJGZ where ${value}
	</select>
	<select id="queryshlmgz" parameterType="string" resultType="lxsh">
		select * from LXSH_LMGZ where ${value}
	</select>
	<select id="queryshxj" parameterType="string" resultType="lxsh">
		select * from LXSH_XJ where ${value}
	</select>
	<insert id="insertsjgzkxx" parameterType="lxsh">
		insert into kxxyj_sjgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz})
	</insert>
	<insert id="insertlmgzkxx" parameterType="lxsh">
		insert into kxxyj_lmgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz})
	</insert>
	<insert id="insertxjkxx" parameterType="lxsh">
		insert into kxxyj_xj(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz})
	</insert>
	<select id="selectLmgzList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) sbzt1  from LXSH_LMGZ t where 1=1
			and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectLmgzListCount" parameterType="lxsh" resultType="int">
		select count(*) from LXSH_LMGZ where 1=1
		and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
	</select>
	
	<select id="selectXjList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) sbzt1  from LXSH_XJ t where 1=1
			and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectXjListCount" parameterType="lxsh" resultType="int">
		select count(*) from LXSH_XJ where 1=1
		and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and decode(sbthcd,#{sbthcd},'0',to_char(sbzt)) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and xjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>
	<select id="Lmgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_lmgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="sjgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_sjgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="Xjsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_xj where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="qqglGpsroad" parameterType="lxsh" resultType="lxsh">
		select lxbm ghlxbh,lxmc,qdzh,zdzh,qzlc lc,qdmc,zdmc,yjsdj xjsdj
		from table(funNoLmlx(#{ghlxbh},#{xzqh})) order by lxbm,qdzh
	</select>
	<update id="updatesjgz" parameterType="lxsh">
		update lxsh_sjgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<update id="updatelmgz" parameterType="lxsh">
		update lxsh_lmgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<update id="updatexj" parameterType="lxsh">
		update lxsh_xj set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<delete id="deleteLx" parameterType="lxsh">
		delete from lxsh_lx where xmid=#{xmbm} and id=#{id} 
	</delete>
	<select id="cxqdmc" parameterType="lxsh" resultType="lxsh">
		select min(f006) qdmc from gpsroad g,
       (SELECT MIN(ABS(ROADSTART- to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.roadstart=to_number(#{qdzh})+t.a or g.roadstart=to_number(#{qdzh})-t.a )
	</select>
	<select id="cxzdmc" parameterType="lxsh" resultType="lxsh">
		select min(f010) zdmc from gpsroad g,
       (SELECT MIN(ABS(ROADENDS-to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.ROADENDS=to_number(#{qdzh})+t.a or g.ROADENDS=to_number(#{qdzh})-t.a )
	</select>
	<delete id="deletekxlx" parameterType="hashmap">
		delete from lxsh_lx where xmid=#{xmbm} and jdbs='1'
	</delete>
	<select id="sfylx" parameterType="lxsh" resultType="lxsh">
		select count(*) shzt from lxsh_lx where xmid=#{xmbm} and jdbs=#{jdbs} and sffirst='0'
	</select>
</mapper>

