<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.kxxyj">
	<select id="selectSjgzList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.lsjl,t1.ghlxbh lxbh,t1.gydwdm, t.shzt sbzt1,lx.*
		from KXXYJ_SJGZ t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm left join 
    	(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,
    	sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc,
    	sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc
    	from lxsh_lx where jdbs='1' group by xmid) lx on t.xmbm=lx.xmid
		where 1=1 and (t.sbthcd &lt;=7 or t.sbthcd is null) 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and decode(t.sbthcd,#{sbthcd},'0',to_char(t.sbzt)) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if> 
		<if test="lsjl!='' and lsjl!= null ">
			and t1.lsjl like '%'||#{lsjl}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
		
	</select>
	<select id="selectSjgzListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_SJGZ t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm where 1=1
		and (t.sbthcd &lt;=7 or t.sbthcd is null) 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and decode(t.sbthcd,#{sbthcd},'0',to_char(t.sbzt)) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and t1.lsjl like '%'||#{lsjl}||'%'
		</if>
	</select>
	<select id="selectLmgzkxList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.lsjl,t1.ghlxbh lxbh,t1.gydwdm,t.shzt sbzt1,lx.*
		from KXXYJ_LMGZ t Left join lxsh_lmgz t1 on t.xmbm=t1.xmbm left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,
		sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc from lxsh_lx where jdbs='1' 
		group by xmid) lx on t.xmbm=lx.xmid
		where 1=1 and (t.sbthcd &lt;=7 or t.sbthcd is null) 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and decode(t.sbthcd,#{sbthcd},'0',to_char(t.sbzt)) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and t1.lsjl like '%'||#{lsjl}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectLmgzkxListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_LMGZ t Left join lxsh_lmgz t1 on t.xmbm=t1.xmbm where 1=1
		and (t.sbthcd &lt;=7 or t.sbthcd is null) 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and decode(t.sbthcd,#{sbthcd},'0',to_char(t.sbzt)) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and t1.lsjl like '%'||#{lsjl}||'%'
		</if>
	</select>
	<select id="selectXjkxList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.ghlxbh lxbh,t1.gydwdm,t.shzt sbzt1,lx.*  from KXXYJ_XJ t 
		Left join lxsh_xj t1 on t.xmbm=t1.xmbm left join 
		(select qdmc,zdmc,lxmc,min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,sum(xjlc) xjlc,
		sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc,xjlxbm,xjqdzh,xjzdzh  
		from lxsh_lx where jdbs='1' group by qdmc,zdmc,lxmc,xmid,xjlxbm,xjqdzh,xjzdzh,xjlc ) lx on t.xmbm=lx.xmid
		where 1=1 and (t.sbthcd &lt;=7 or t.sbthcd is null) 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and decode(t.sbthcd,#{sbthcd},'0',to_char(t.sbzt)) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectXjkxListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_XJ t Left join lxsh_xj t1 on t.xmbm=t1.xmbm where 1=1
		and (t.sbthcd &lt;=7 or t.sbthcd is null) 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and decode(t.sbthcd,#{sbthcd},'0',to_char(t.sbzt)) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>
	
	<insert id="insertFile" parameterType="plan_upload">
		insert into plan_upload(filename,filedata,parentid,filetype) values(#{filename},#{filedata},#{parentid},#{filetype})
	</insert>
	<update id="updateSjgzkxx" parameterType="kxxyj">
		update kxxyj_sjgz set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},jsxz=#{jsxz},dq=#{dq},
		dq_m=#{dq_m},jsjsdj=#{jsjsdj},sd=#{sd},sd_m=#{sd_m},jsdw=#{jsdw},sbthcd=#{sbthcd},tbbmbm=#{tbbmbm},
		kgny=#{kgny},wgny=#{wgny},bzdw=#{bzdw},tzgs=#{tzgs},gkpfwh=#{gkpfwh},pfsj=#{pfsj},xzqh=#{xzqh},xzqhdm=#{xzqhdm},
		dfzc=#{dfzc},yhdk=#{yhdk}
		where xmbm=#{xmbm}
	</update>
	<update id="updateLmgzkxx" parameterType="kxxyj">
		update kxxyj_lmgz set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},jsxz=#{jsxz},dq=#{dq},
		dq_m=#{dq_m},jsjsdj=#{jsjsdj},sd=#{sd},sd_m=#{sd_m},jsdw=#{jsdw},sbthcd=#{sbthcd},tbbmbm=#{tbbmbm},
		kgny=#{kgny},wgny=#{wgny},bzdw=#{bzdw},tzgs=#{tzgs},gkpfwh=#{gkpfwh},pfsj=#{pfsj},xzqh=#{xzqh},xzqhdm=#{xzqhdm},
		dfzc=#{dfzc},yhdk=#{yhdk}
		where xmbm=#{xmbm}
	</update>
	<update id="updateXjkxx" parameterType="kxxyj">
		update kxxyj_xj set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},jsxz=#{jsxz},dq=#{dq},
		dq_m=#{dq_m},jsjsdj=#{jsjsdj},sd=#{sd},sd_m=#{sd_m},jsdw=#{jsdw},sbthcd=#{sbthcd},tbbmbm=#{tbbmbm},
		kgny=#{kgny},wgny=#{wgny},bzdw=#{bzdw},tzgs=#{tzgs},gkpfwh=#{gkpfwh},pfsj=#{pfsj},xzqh=#{xzqh},xzqhdm=#{xzqhdm},
		dfzc=#{dfzc},yhdk=#{yhdk}
		where xmbm=#{xmbm}
	</update>
	
	<update id="sbsjgzkxx" parameterType="hashmap">
		update KXXYJ_SJGZ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="sblmgzkxx" parameterType="hashmap">
		update KXXYJ_LMGZ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="sbxjkxx" parameterType="hashmap">
		update KXXYJ_XJ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	
	<update id="thSjgzkxx" parameterType="hashmap">
		update KXXYJ_SJGZ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thLmgzkxx" parameterType="hashmap">
		update KXXYJ_LMGZ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thXjkxx" parameterType="hashmap">
		update KXXYJ_XJ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	
	<select id="selectSjgzkxshList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.ghlxbh lxbh,t1.gydwdm,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc
		from KXXYJ_SJGZ t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm left join lxsh_lx l on t1.xmbm=l.xmid where 1=1 and  t.sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm
	</select>
	<select id="selectSjgzkxshListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_SJGZ t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm where 1=1
		and  t.sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>
	
	<select id="selectLmgzkxshList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.ghlxbh lxbh,t1.gydwdm,l.qdmc,l.zdmc  from KXXYJ_LMGZ t Left join lxsh_lmgz t1 on t.xmbm=t1.xmbm left join lxsh_lx l on t.xmbm=l.xmid 
		where l.jdbs='1' and l.sffirst='1' and  t.sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm
	</select>
	<select id="selectLmgzkxshListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_LMGZ t Left join lxsh_lmgz t1 on t.xmbm=t1.xmbm where 1=1
		and  t.sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>
	<select id="selectXjkxshList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.ghlxbh lxbh,t1.gydwdm  from KXXYJ_XJ t Left join lxsh_xj t1 on t.xmbm=t1.xmbm where 1=1
			and  t.sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm
	</select>
	<select id="selectXjkxshListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_XJ t Left join lxsh_xj t1 on t.xmbm=t1.xmbm where 1=1
		and  t.sbthcd=7
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			and t1.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
	</select>
	
	<update id="shsjgzkxx" parameterType="hashmap">
		update KXXYJ_SJGZ set shzt=1 where id=#{id}
	</update>
	<select id="queryshsjgz" parameterType="string" resultType="kxxyj">
		select * from KXXYJ_SJGZ where ${value}
	</select>
	<insert id="insertsjgzcb" parameterType="kxxyj">
		insert into cbsj_sjgz(id,xmmc,xmbm,xzqh,qdzh,zdzh,jsjsdj,jsxz,jsdw,dfzc,yhdk)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{jsdw},#{dfzc},#{yhdk})
	</insert>
	<update id="shlmgzkxx" parameterType="hashmap">
		update KXXYJ_LMGZ set shzt=1 where id=#{id}
	</update>
	<select id="queryshlmgz" parameterType="string" resultType="kxxyj">
		select * from KXXYJ_LMGZ where ${value}
	</select>
	<insert id="insertlmgzcb" parameterType="kxxyj">
		insert into cbsj_lmgz(id,xmmc,xmbm,xzqh,qdzh,zdzh,jsjsdj,jsxz,jsdw,dfzc,yhdk)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{jsdw},#{dfzc},#{yhdk})
	</insert>
	<update id="shxjkxx" parameterType="hashmap">
		update KXXYJ_XJ set shzt=1 where id=#{id}
	</update>
	<select id="queryshxj" parameterType="string" resultType="kxxyj">
		select * from KXXYJ_XJ where ${value}
	</select>
	<insert id="insertxjcb" parameterType="kxxyj">
		insert into cbsj_xj(id,xmmc,xmbm,xzqh,qdzh,zdzh,jsjsdj,jsxz,jsdw,dfzc,yhdk)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{jsdw},#{dfzc},#{yhdk})
	</insert>
	
	<select id="sjgzsfcb" parameterType="string" resultType="kxxyj">
		select * from cbsj_sjgz where ${value} and sfbj=1
	</select>
	<update id="thSjgzkxx1" parameterType="hashmap">
		update KXXYJ_SJGZ set shzt=0 where xmbm=#{xmbm}
	</update>
	<delete id="deletesjgzcb" parameterType="hashmap">
		delete from cbsj_sjgz where xmbm=#{xmbm}
	</delete>
	
	<select id="lmgzsfcb" parameterType="string" resultType="kxxyj">
		select * from cbsj_lmgz where ${value} and sfbj=1
	</select>
	<update id="thLmgzkxx1" parameterType="hashmap">
		update KXXYJ_LMGZ set shzt=0 where xmbm=#{xmbm}
	</update>
	<delete id="deletelmgzcb" parameterType="hashmap">
		delete from cbsj_lmgz where xmbm=#{xmbm}
	</delete>
	<select id="xjsfcb" parameterType="string" resultType="kxxyj">
		select * from cbsj_xj where ${value} and sfbj=1
	</select>
	<update id="thXjkxx1" parameterType="hashmap">
		update KXXYJ_XJ set shzt=0 where xmbm=#{xmbm}
	</update>
	<delete id="deletexjcb" parameterType="hashmap">
		delete from cbsj_xj where xmbm=#{xmbm}
	</delete>
	<select id="querylxlist" parameterType="kxxyj" resultType="lxsh">
		select t.*,bzcs bzys,xmid xmbm,lxbm ghlxbh from lxsh_lx t where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<insert id="insertLx1" parameterType="lxsh">
		insert into lxsh_lx (xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, jdbs,gpsqdzh,gpszdzh,jsfa,xjlxbm,xjqdzh,xjzdzh,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc ,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc)
		select xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, to_char(to_number(#{jdbs})),gpsqdzh,gpszdzh,jsfa,xjlxbm,xjqdzh,xjzdzh,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc   ,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc from lxsh_lx where xmid = #{xmbm} and jdbs=to_char(to_number(#{jdbs})-1)
		<!-- insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},#{sffirst},#{jdbs},#{gpsqdzh},#{gpszdzh}) -->
	</insert>
	
	<insert id="insertJgtc" parameterType="gcgl_jgys">
 		insert into plan_upload(filename,filedata,parentid,filetype)
 		 values(#{filename},#{filedata},#{jhid},#{filetype})
 	</insert>
 	<insert id="insertWgys" parameterType="gcgl_jgys">
 		insert into plan_upload(filename,filedata,parentid,filetype)
 		 values(#{filename},#{filedata},#{jhid},#{filetype})
 	</insert>
 	
 	<update id="importsjgzkxx" parameterType="hashMap">
		update kxxyj_sjgz set xmmc=#{1},qdzh=#{4},zdzh=#{5},jsxz=#{19},dq=#{21},
		dq_m=#{20},jsjsdj=#{22},sd=#{24},sd_m=#{23},jsdw=#{25},sbthcd=7,tbbmbm='36',
		kgny=#{26},wgny=#{27},bzdw=#{28},tzgs=#{29},dfzc=#{30},yhdk=#{31},gkpfwh=#{32},pfsj=#{33},xzqh=#{2},xzqhdm=substr(#{0},5,6)
		where xmbm=#{0}
	</update>
	<update id="updatesjgzkxxlx" parameterType="hashMap">
		update lxsh_lx set qdzh=#{4},zdzh=#{5},xzqh=#{2},lc=to_number(#{6}),yilc=#{7},erlc=#{8},sanlc=#{9},
		silc=#{10},dwlc=#{11},wllc=#{12},jhyilc=#{13},jherlc=#{14},jhsanlc=#{15},jhsilc=#{16},jhdwlc=#{17},jhwllc=#{18},
		jsjsdj=#{22},xzqhdm=substr(#{0},5,6) where xmid=#{0} and jdbs='1' and sffirst='1'
	</update>
	<update id="importlmgzkxx" parameterType="hashMap">
		update kxxyj_lmgz set xmmc=#{1},qdzh=#{4},zdzh=#{5},jsxz=#{13},dq=#{15},
		dq_m=#{14},jsjsdj=#{16},sd=#{18},sd_m=#{17},jsdw=#{19},sbthcd=7,tbbmbm='36',
		kgny=#{20},wgny=#{21},bzdw=#{22},tzgs=#{23},dfzc=#{24},yhdk=#{25},gkpfwh=#{26},pfsj=#{27},xzqh=#{2},xzqhdm=substr(#{0},5,6)
		where xmbm=#{0}
	</update>
	<update id="updatelmgzkxxlx" parameterType="hashMap">
		update lxsh_lx set qdzh=#{4},zdzh=#{5},xzqh=#{2},lc=#{6},yilc=#{7},erlc=#{8},sanlc=#{9},silc=#{10},dwlc=#{11},wllc=#{12},
		jsjsdj=#{16},xzqhdm=substr(#{0},5,6)
		where xmid=#{0} and jdbs='1' and sffirst='1'
	</update>
	<update id="importxjkxx" parameterType="hashMap">
		update kxxyj_xj set xmmc=#{1},qdzh=#{4},zdzh=#{5},jsxz=#{17},dq=#{19},
		dq_m=#{18},jsjsdj=#{20},sd=#{22},sd_m=#{21},jsdw=#{23},sbthcd=7,tbbmbm='36',
		kgny=#{24},wgny=#{25},bzdw=#{26},tzgs=#{27},dfzc=#{28},yhdk=#{29},gkpfwh=#{30},pfsj=#{31},xzqh=#{2},xzqhdm=substr(#{0},5,6)
		where xmbm=#{0}
	</update>
	<update id="updatexjkxxlx" parameterType="hashMap">
		update lxsh_lx set qdzh=#{4},zdzh=#{5},xzqh=#{2},lc=#{6},xjlxbm=#{7},xjqdzh=#{8},xjzdzh=#{9},xjlc=#{10},
		yilc=#{11},erlc=#{12},sanlc=#{13},silc=#{14},dwlc=#{15},wllc=#{16},jsjsdj=#{20},xzqhdm=substr(#{0},5,6)
		where xmid=#{0} and jdbs='1' and sffirst='1'
	</update>
</mapper>
