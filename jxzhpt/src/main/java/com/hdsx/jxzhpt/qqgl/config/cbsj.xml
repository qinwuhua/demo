<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.cbsj">
	<select id="queryCbsjLmgz" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, jsdw, c.xzqh, c.jsxz, lj, ql, hd, mc, jc, dc, sd, dq, sdmc, kgsj, wgsj, gq, sjdw, sjpfwh, pfsj, jaf, 
		        c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk
		        ,l.ghlxbh,l.lsjl,lx.qdzh,lx.zdzh,lx.jsjsdj,lx.lc
		        from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm=l.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid
		        where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%2___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">and l.tsdq like '%'||#{cbsj.tsdq}||'%'</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc ) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjLmsj" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, jsdw, c.xzqh, c.jsxz, lj, ql, hd, mc, jc, dc, sd, dq, sdmc, kgsj, wgsj, gq, sjdw, sjpfwh, pfsj, jaf, 
		        c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk
		        ,l.ghlxbh,l.lsjl,lx.qdzh,lx.zdzh,lx.jsjsdj,lx.lc
		        from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm=l.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid
		        where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					and l.tsdq like '%'||#{cbsj.tsdq}||'%'
				</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjXj" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, jsdw, c.xzqh, c.jsxz, lj, ql, hd, mc, jc, dc, sd, dq, sdmc, kgsj, wgsj, gq, sjdw, sjpfwh, pfsj, jaf, 
				c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk
				,l.ghlxbh,l.lsjl,lx.qdzh,lx.zdzh,lx.jsjsdj,lx.lc
				from cbsj_xj c left join lxsh_xj l on c.xmbm=l.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%3___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and l.xjsdj = #{cbsj.xjsdj}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">and l.tsdq like '%'||#{cbsj.tsdq}||'%'</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and c.jsjsdj=#{cbsj.jsjsdj}</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjYhdzx" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmbm, c.xmmc, jsdw, c.xzqh, c.jsxz, kgsj, wgsj, c.gq, sjdw, sjpfwh, pfsj, shzt, sbzt, c.jsfa, sfbj, mc, jc, dc, mc_lc, jc_lc, dc_lc,
				l.ghlxbh,l.ylxbh,l.lsjl, lx.qdzh, lx.zdzh,lx.jsjsdj,lx.xjsdj from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%4___' and jdbs='2')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					and l.tsdq like '%'||#{cbsj.tsdq}||'%'
				</if>
				<if test="cbsj.gcfl!=null and cbsj.gcfl!=''">and ${cbsj.gcfl}</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjSh" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmbm, c.xmmc, jsdw, c.xzqh, c.jsxz, kgsj, wgsj, c.gq, sjdw, sjpfwh, pfsj, shzt, sbzt, c.jsfa, sfbj, mc, jc, dc, mc_lc, jc_lc, dc_lc,
				l.ghlxbh,l.ylxbh,l.lsjl, lx.qdzh, lx.zdzh,lx.jsjsdj,lx.xjsdj from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%5___' and jdbs='2')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">and l.tsdq like '%'||#{cbsj.tsdq}||'%'</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	
	<select id="queryCbsjLmgzCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%2___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			and l.xzqhdm in (select t.xzqhdm from xtgl_xzqhtsdq t where t.parent =#{cbsj.tsdq})
		</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	<select id="queryCbsjLmsjCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			and l.xzqhdm in (select t.xzqhdm from xtgl_xzqhtsdq t where t.parent =#{cbsj.tsdq})
		</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	<select id="queryCbsjXjCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_xj c left join lxsh_xj l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%3___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			and l.xzqhdm in (select t.xzqhdm from xtgl_xzqhtsdq t where t.parent =#{cbsj.tsdq})
		</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	<select id="queryCbsjYhdzxCount" parameterType="java.util.Map" resultType="int">
		select count(c.xmbm) from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%4___' and jdbs='2')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.gcfl!=null and cbsj.gcfl!=''">and ${cbsj.gcfl}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">and l.TSDQ like '%'||#{cbsj.tsdq}||'%' </if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	<select id="queryCbsjShCount" parameterType="java.util.Map" resultType="int">
		select count(c.xmbm) from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%' and jdbs='2')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%5___' and jdbs='2')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">and l.TSDQ like '%'||#{cbsj.tsdq}||'%' </if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	
	<select id="queryCbsjLmgzByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.lc,l.qdmc,l.zdmc,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_lmgz c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjLmsjByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.lc,l.qdmc,l.zdmc,l.gpszdzh,l.lc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhdwlc,l.jhwllc
		from cbsj_sjgz c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjXjByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.lc,l.qdmc,l.zdmc,l.gpszdzh,l.xjlxbm,l.xjqdzh,l.xjzdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_xj c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjYhdzxByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*, l.qdmc,l.zdmc,l.lxbm as ghlxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_yhdzx c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjShByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.gpszdzh,l.qdmc,l.zdmc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_sh c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	
	<update id="updateCbsjLmgz" parameterType="cbsj">
		update cbsj_lmgz c set c.xmmc=#{xmmc},
		c.xzqh=#{xzqh},c.qdzh=#{qdzh},c.zdzh=#{zdzh},
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="lj!=null">c.lj=#{lj},</if>
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjLmsj" parameterType="cbsj">
		update cbsj_sjgz c set c.xmmc=#{xmmc},c.xzqh=#{xzqh},
		c.jsxz=#{jsxz},c.qdzh=#{qdzh},c.zdzh=#{zdzh},
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="jszlc!=null">c.jszlc=#{jszlc},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjXj" parameterType="cbsj">
		update cbsj_xj c set c.xmmc=#{xmmc},c.xzqh=#{xzqh},
		c.qdzh=#{qdzh},c.zdzh=#{zdzh},
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjYhdzx" parameterType="cbsj">
		update cbsj_yhdzx c set 
		<if test="xmmc!=null">c.xmmc=#{xmmc},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="xzqh!=null">c.xzqh=#{xzqh},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="qdzh!=null">c.qdzh=#{qdzh},</if>
		<if test="zdzh!=null">c.zdzh=#{zdzh},</if>
		<if test="jsfa!=null">c.jsfa=#{jsfa},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="lc!=null">c.lc=#{lc},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjSh" parameterType="cbsj">
		update cbsj_sh c set 
		<if test="xmmc!=null">c.xmmc=#{xmmc},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="xzqh!=null">c.xzqh=#{xzqh},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="qdzh!=null">c.qdzh=#{qdzh},</if>
		<if test="zdzh!=null">c.zdzh=#{zdzh},</if>
		<if test="jsfa!=null">c.jsfa=#{jsfa},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="lc!=null">c.lc=#{lc},</if>
		sfbj='1'
		where c.xmbm=#{xmbm}
	</update>
	
	<delete id="deleteLmgzByXmbm" parameterType="java.util.List">
		delete from cbsj_lmgz where xmbm=#{xmbm}
	</delete>
	<delete id="deleteLmsjByXmbm" parameterType="java.util.List">
		delete from cbsj_sjgz where xmbm=#{xmbm}
	</delete>
	<delete id="deleteXjByXmbm" parameterType="java.util.List">
		delete from cbsj_xj where xmbm=#{xmbm}
	</delete>
	
	<update id="shCbsjLmsjByXmbm" parameterType="java.util.List">
		update cbsj_sjgz c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjLmgzByXmbm" parameterType="java.util.List">
		update cbsj_lmgz c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjXjByXmbm" parameterType="java.util.List">
		update cbsj_xj c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjYhdzxByXmbm" parameterType="java.util.List">
		update cbsj_yhdzx c set c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjShByXmbm" parameterType="java.util.List">
		update cbsj_sh c set c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	
	<!-- 文件操作部分 -->
	<select id="queryFileByXmbm" parameterType="plan_upload" resultType="plan_upload">
		select f.id,filename,xmbm,filetype,fileurl,filewh from plan_file f left join plan_upload u on f.fid=u.id
		where xmbm=#{parentid} and filetype=#{filetype}
	</select>
	<insert id="insertFile" parameterType="plan_upload">
		insert into plan_upload(id,filename,
		<if test="filewh!=null">filewh,</if>
		filetype,fileurl) values(#{id},#{filename},
		<if test="filewh!=null">#{filewh},</if>#{filetype},#{fileurl})
	</insert>
	<select id="queryFileByWh" parameterType="plan_upload" resultType="plan_upload">
		select * from plan_upload where filetype=#{filetype} and filewh=#{filewh} and filename=#{filename}
	</select>
	<insert id="insertFileJl" parameterType="plan_upload">
		insert into plan_file (id,xmbm,fid) values (sys_guid(),#{xmbm},#{fid})
	</insert>
	<select id="queryLmgzExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.xmbm,c.xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.lj,c.ql,c.ql_ym,c.hd,c.hd_m,c.sd,c.sd_ym,
				c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,c.dq,c.dq_cd,c.dq_dk,c.sdmc,c.sd_lx,c.sd_sfcd,
				c.kgsj,c.wgsj,c.gq,c.sjdw,c.sjpfwh,c.pfsj,c.jaf,c.dfzc,c.yhdk,lx.* from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm = l.xmbm
				left join (select xmid, lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,lc lc,yilc,erlc,sanlc,silc,dwlc,wllc from lxsh_lx where jdbs='2' and sffirst='1') lx
				on c.xmbm = lx.xmid where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="ylxbh!=null and ylxbh!=''">and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%2___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<!-- <if test="sbzt>=0">
					and c.sbzt=${sbzt}
				</if> -->
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				order by c.shzt,c.xmbm desc ) t 
		)
	</select>
	<select id="queryYhdzxExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.xmbm,c.xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,
				c.kgsj,c.wgsj,c.gq,c.sjdw,c.sjpfwh,c.pfsj,c.jsfa,lx.* from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm left join 
				(select xmid,lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,lc lc,yilc,erlc,sanlc,silc,dwlc,wllc from lxsh_lx where jdbs='2' and sffirst='1') lx 
				on c.xmbm=lx.xmid where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="shzt>=0">
					and c.shzt=${shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		)
	</select>
	<select id="queryShExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
			select c.xmbm,c.xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,
			c.kgsj,c.wgsj,c.gq,c.sjdw,c.sjpfwh,c.pfsj,c.jsfa,lx.* from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm left join 
			(select xmid,lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,lc lc,yilc,erlc,sanlc,silc,dwlc,wllc from lxsh_lx where jdbs='2' and sffirst='1') lx 
			on c.xmbm=lx.xmid where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		)
	</select>
	<select id="queryLmsjExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.xmbm,c.xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.lj,c.ql,c.ql_ym,c.hd,c.hd_m,c.sd,c.sd_ym,
				c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,c.dq,c.dq_cd,c.dq_dk,c.sdmc,c.sd_lx,c.sd_sfcd,
				c.kgsj,c.wgsj,c.gq,c.sjdw,c.sjpfwh,c.pfsj,c.jaf,c.dfzc,c.yhdk,lx.* from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm = l.xmbm
				left join (select xmid, lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,lc,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc from lxsh_lx where jdbs='2' and sffirst='1') lx
				on c.xmbm = lx.xmid where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%1___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		)
	</select>
	<select id="queryXjExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.xmbm,c.xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.lj,c.ql,c.ql_ym,c.hd,c.hd_m,c.sd,c.sd_ym,
				c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,c.dq,c.dq_cd,c.dq_dk,c.sdmc,c.sd_lx,c.sd_sfcd,
				c.kgsj,c.wgsj,c.gq,c.sjdw,c.sjpfwh,c.pfsj,c.jaf,c.dfzc,c.yhdk,lx.* from cbsj_xj c left join lxsh_xj l on c.xmbm = l.xmbm
				left join (select xmid, lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,lc,xjlxbm xjlxbm, xjqdzh xjqdzh,xjzdzh xjzdzh,yilc,erlc,sanlc,silc,dwlc,wllc from lxsh_lx where jdbs='2' and sffirst='1') lx
				on c.xmbm = lx.xmid where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%3___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		)
	</select>
	<select id="queryFj" resultType="plan_upload">
		select filename,substr(parentid,0,4) xmbm from plan_upload where fileurl is null and filetype='设计批复文件' group by filename,substr(parentid,0,4)
	</select>
	<select id="queryFjByName" resultType="plan_upload">
		select * from plan_upload where filename=#{filename} and
		parentid = (select max(parentid) from plan_upload where filename=#{filename} and parentid like #{xmbm}||'%')
	</select>
	<select id="queryGkXm" resultType="plan_upload" parameterType="java.util.Map">
		select * from (
		select k.xmbm parentid,k.gkpfwh filewh from kxxyj_lmgz k
		union all
		select k.xmbm,k.gkpfwh from kxxyj_sjgz k
		union all
		select k.xmbm,k.gkpfwh from kxxyj_xj k) where filewh like '%'||#{gkwh}||'%'
	</select>
	<select id="queryJhXm" resultType="plan_upload" parameterType="java.util.Map">
		select * from (
		select j.xmbm parentid,j.xdwh filewh from jhsh_lmgz j
		union all
		select j.xmbm,j.xdwh from jhsh_sjgz j
		union all
		select xj.xmbm,xj.xdwh from jhsh_xj xj
		union all
		select yh.xmbm,yh.xdwh from jhsh_yhdzx yh
		union all
		select sh.xmbm,sh.xdwh from jhsh_sh sh) where filewh like '%'||#{jhwh}||'%'
	</select>
	<select id="queryCbsjLjYhdzx" parameterType="cbsj" resultType="java.util.Map">
		select sum(l.ntz) ntz,sum(l1.lc) lc from cbsj_yhdzx c left join 
		xmsq_yhdzx l on c.xmbm=l.xmbm left join 
		(select xmid,sum(lc) lc from lxsh_lx where xmid like '%4___' and jdbs='2' group by xmid) l1 on c.xmbm=l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___' and jdbs='2')
		</if>
		<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
		<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
		<if test="tsdq!=null and tsdq!=''">and l.TSDQ like '%'||#{tsdq}||'%' </if>
		<if test="shzt>=0">and c.shzt=${shzt}</if>
	</select>
	<select id="queryCbsjLjSh" parameterType="cbsj" resultType="java.util.Map">
		select sum(l.ntz) ntz,sum(l1.lc) lc from cbsj_sh c left join 
		xmsq_sh l on c.xmbm=l.xmbm left join 
		(select xmid,sum(lc) lc from lxsh_lx where xmid like '%5___' and jdbs='2' group by xmid) l1 on c.xmbm=l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___' and jdbs='2')
		</if>
		<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
		<if test="tsdq!=null and tsdq!=''">and l.TSDQ like '%'||#{tsdq}||'%' </if>
		<if test="shzt>=0">and c.shzt=${shzt}</if>
	</select>
</mapper>
