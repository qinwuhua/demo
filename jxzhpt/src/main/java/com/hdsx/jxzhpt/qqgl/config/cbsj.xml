<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.cbsj">
	<select id="queryCbsjLmgz" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.lsjl from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm=l.xmbm
				where 1=1
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
					and ${cbsj.xzqhdm}
				</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
					and l.xjsdj = #{cbsj.xjsdj}
				</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">
					and l.lsjl=#{cbsj.lsjl}
				</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					and l.tsdq like '%'||#{cbsj.tsdq}||'%'
				</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
					and c.xmbm like #{cbsj.xmbm}||'%'
				</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
					and c.jsjsdj=#{cbsj.jsjsdj}
				</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">
					and c.shzt=${cbsj.shzt}
				</if>
				order by c.shzt,c.xmbm desc ) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjLmsj" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.lsjl from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm=l.xmbm
				where 1=1
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
					and ${cbsj.xzqhdm}
				</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
					and l.xjsdj = #{cbsj.xjsdj}
				</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">
					and l.lsjl=#{cbsj.lsjl}
				</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					and l.tsdq like '%'||#{cbsj.tsdq}||'%'
				</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
					and c.xmbm like #{cbsj.xmbm}||'%'
				</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
					and c.jsjsdj=#{cbsj.jsjsdj}
				</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">
					and c.shzt=${cbsj.shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjXj" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.lsjl from cbsj_xj c left join lxsh_xj l on c.xmbm=l.xmbm
				where 1=1
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
					and ${cbsj.xzqhdm}
				</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
					and l.xjsdj = #{cbsj.xjsdj}
				</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					and l.tsdq like '%'||#{cbsj.tsdq}||'%'
				</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
					and c.xmbm like #{cbsj.xmbm}||'%'
				</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
					and c.jsjsdj=#{cbsj.jsjsdj}
				</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">
					and c.shzt=${cbsj.shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjYhdzx" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.ylxbh,l.lsjl from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm
				where 1=1
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
					and ${cbsj.xzqhdm}
				</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
					and l.xjsdj = #{cbsj.xjsdj}
				</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">
					and l.lsjl=#{cbsj.lsjl}
				</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					and l.tsdq like '%'||#{cbsj.tsdq}||'%'
				</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
					and c.xmbm like #{cbsj.xmbm}||'%'
				</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
					and c.jsjsdj=#{cbsj.jsjsdj}
				</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">
					and c.shzt=${cbsj.shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjSh" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.ylxbh,l.lsjl from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm
				where 1=1
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
					and ${cbsj.xzqhdm}
				</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
					and l.xjsdj = #{cbsj.xjsdj}
				</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">
					and l.lsjl=#{cbsj.lsjl}
				</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					and l.tsdq like '%'||#{cbsj.tsdq}||'%'
				</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
					and c.xmbm like #{cbsj.xmbm}||'%'
				</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
					and c.jsjsdj=#{cbsj.jsjsdj}
				</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">
					and c.shzt=${cbsj.shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	
	<select id="queryCbsjLmgzCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
			and ${cbsj.xzqhdm}
		</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
			and l.xjsdj = #{cbsj.xjsdj}
		</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
			and c.xmbm like #{cbsj.xmbm}||'%'
		</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
			and c.jsjsdj=#{cbsj.jsjsdj}
		</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			and l.xzqhdm in (select t.xzqhdm from xtgl_xzqhtsdq t where t.parent =#{cbsj.tsdq})
		</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">
			and c.shzt=${cbsj.shzt}
		</if>
	</select>
	<select id="queryCbsjLmsjCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
			and ${cbsj.xzqhdm}
		</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
			and l.xjsdj = #{cbsj.xjsdj}
		</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
			and c.xmbm like #{cbsj.xmbm}||'%'
		</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
			and c.jsjsdj=#{cbsj.jsjsdj}
		</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			and l.xzqhdm in (select t.xzqhdm from xtgl_xzqhtsdq t where t.parent =#{cbsj.tsdq})
		</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">
			and c.shzt=${cbsj.shzt}
		</if>
	</select>
	<select id="queryCbsjXjCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_xj c left join lxsh_xj l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
			and ${cbsj.xzqhdm}
		</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
			and l.xjsdj = #{cbsj.xjsdj}
		</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
			and c.xmbm like #{cbsj.xmbm}||'%'
		</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
			and c.jsjsdj=#{cbsj.jsjsdj}
		</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			and l.xzqhdm in (select t.xzqhdm from xtgl_xzqhtsdq t where t.parent =#{cbsj.tsdq})
		</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">
			and c.shzt=${cbsj.shzt}
		</if>
	</select>
	<select id="queryCbsjYhdzxCount" parameterType="java.util.Map" resultType="int">
		select count(c.xmbm) from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm
				where 1=1
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
					and ${cbsj.xzqhdm}
				</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
					and l.xjsdj = #{cbsj.xjsdj}
				</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
					and c.xmbm like #{cbsj.xmbm}||'%'
				</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
					and c.jsjsdj=#{cbsj.jsjsdj}
				</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					and l.TSDQ like '%'||#{cbsj.tsdq}||'%' 
				</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">
					and c.shzt=${cbsj.shzt}
				</if>
	</select>
	<select id="queryCbsjShCount" parameterType="java.util.Map" resultType="int">
		select count(c.xmbm) from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">
			and ${cbsj.xzqhdm}
		</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">
			and l.xjsdj = #{cbsj.xjsdj}
		</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">
			and c.xmbm like #{cbsj.xmbm}||'%'
		</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">
			and c.jsjsdj=#{cbsj.jsjsdj}
		</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			and l.TSDQ like '%'||#{cbsj.tsdq}||'%' 
		</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">
			and c.shzt=${cbsj.shzt}
		</if>
	</select>
	
	<select id="queryCbsjLmgzByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_lmgz c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjLmsjByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.gpszdzh,l.lc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhdwlc,l.jhwllc
		from cbsj_sjgz c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjXjByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.gpszdzh,l.xjlxbm,l.xjqdzh,l.xjzdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_xj c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjYhdzxByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_yhdzx c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjShByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_sh c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	
	<update id="updateCbsjLmgz" parameterType="cbsj">
		update cbsj_lmgz c set c.xmmc=#{xmmc},c.jsdw=#{jsdw},c.xzqh=#{xzqh},c.jsjsdj=#{jsjsdj},
		c.jsxz=#{jsxz},c.qdzh=#{qdzh},c.zdzh=#{zdzh},c.dfzc=#{dfzc},c.yhdk=#{yhdk},
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjLmsj" parameterType="cbsj">
		update cbsj_sjgz c set c.xmmc=#{xmmc},c.jsdw=#{jsdw},c.xzqh=#{xzqh},c.jsjsdj=#{jsjsdj},
		c.jsxz=#{jsxz},c.qdzh=#{qdzh},c.zdzh=#{zdzh},c.dfzc=#{dfzc},c.yhdk=#{yhdk},
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjXj" parameterType="cbsj">
		update cbsj_xj c set c.xmmc=#{xmmc},c.jsdw=#{jsdw},c.xzqh=#{xzqh},c.jsjsdj=#{jsjsdj},
		c.jsxz=#{jsxz},c.qdzh=#{qdzh},c.zdzh=#{zdzh},c.dfzc=#{dfzc},c.yhdk=#{yhdk},
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjYhdzx" parameterType="cbsj">
		update cbsj_yhdzx c set 
		<if test="xmmc!=null">c.xmmc=#{xmmc},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="xzqh!=null">c.xzqh=#{xzqh},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="qdzh!=null">c.qdzh=#{qdzh},</if>
		<if test="zdzh!=null">c.zdzh=#{zdzh},</if>
		<if test="jsfa!=null">c.jsfa=#{jsfa},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="lc!=null">c.lc=#{lc},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjSh" parameterType="cbsj">
		update cbsj_sh c set 
		<if test="xmmc!=null">c.xmmc=#{xmmc},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="xzqh!=null">c.xzqh=#{xzqh},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="qdzh!=null">c.qdzh=#{qdzh},</if>
		<if test="zdzh!=null">c.zdzh=#{zdzh},</if>
		<if test="jsfa!=null">c.jsfa=#{jsfa},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="lc!=null">c.lc=#{lc},</if>
		sfbj='1'
		where c.xmbm=#{xmbm}
	</update>
	
	<delete id="deleteLmgzByXmbm" parameterType="java.util.List">
		delete from cbsj_lmgz where xmbm=#{xmbm}
	</delete>
	<delete id="deleteLmsjByXmbm" parameterType="java.util.List">
		delete from cbsj_sjgz where xmbm=#{xmbm}
	</delete>
	<delete id="deleteXjByXmbm" parameterType="java.util.List">
		delete from cbsj_xj where xmbm=#{xmbm}
	</delete>
	
	<update id="shCbsjLmsjByXmbm" parameterType="java.util.List">
		update cbsj_sjgz c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjLmgzByXmbm" parameterType="java.util.List">
		update cbsj_lmgz c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjXjByXmbm" parameterType="java.util.List">
		update cbsj_xj c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjYhdzxByXmbm" parameterType="java.util.List">
		update cbsj_yhdzx c set c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjShByXmbm" parameterType="java.util.List">
		update cbsj_sh c set c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	
	<!-- 文件操作部分 -->
	<select id="queryFileByXmbm" parameterType="plan_upload" resultType="plan_upload">
		select * from plan_upload where parentid=#{parentid} and filetype=#{filetype}
	</select>
	<insert id="insertFile" parameterType="plan_upload">
		insert into plan_upload(filename,filedata,parentid,filetype) values(#{filename},#{filedata},#{parentid},#{filetype})
	</insert>
	
	<select id="queryLmgzExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.lsjl from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm=l.xmbm
				where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">
					and l.xjsdj = #{xjsdj}
				</if>
				<if test="lsjl!=null and lsjl!=''">
					and l.lsjl=#{lsjl}
				</if>
				<if test="tsdq!=null and tsdq!=''">
					and l.tsdq like '%'||#{tsdq}||'%'
				</if>
				<if test="xmbm!=null and xmbm!=''">
					and c.xmbm like #{xmbm}||'%'
				</if>
				<if test="jsjsdj!=null and jsjsdj!=''">
					and c.jsjsdj=#{jsjsdj}
				</if>
				<!-- <if test="sbzt>=0">
					and c.sbzt=${sbzt}
				</if> -->
				<if test="shzt>=0">
					and c.shzt=${shzt}
				</if>
				order by c.shzt,c.xmbm desc ) t 
		)
	</select>
	<select id="queryYhdzxExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.ylxbh,l.lsjl from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm
				where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">
					and l.xjsdj = #{xjsdj}
				</if>
				<if test="lsjl!=null and lsjl!=''">
					and l.lsjl=#{lsjl}
				</if>
				<if test="tsdq!=null and tsdq!=''">
					and l.tsdq like '%'||#{tsdq}||'%'
				</if>
				<if test="xmbm!=null and xmbm!=''">
					and c.xmbm like #{xmbm}||'%'
				</if>
				<if test="jsjsdj!=null and jsjsdj!=''">
					and c.jsjsdj=#{jsjsdj}
				</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="shzt>=0">
					and c.shzt=${shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		)
	</select>
	<select id="queryShExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.ylxbh,l.lsjl from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm
				where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">
					and l.xjsdj = #{xjsdj}
				</if>
				<if test="lsjl!=null and lsjl!=''">
					and l.lsjl=#{lsjl}
				</if>
				<if test="tsdq!=null and tsdq!=''">
					and l.tsdq like '%'||#{tsdq}||'%'
				</if>
				<if test="xmbm!=null and xmbm!=''">
					and c.xmbm like #{xmbm}||'%'
				</if>
				<if test="jsjsdj!=null and jsjsdj!=''">
					and c.jsjsdj=#{jsjsdj}
				</if>
				<if test="shzt>=0">
					and c.shzt=${shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		)
	</select>
	<select id="queryLmsjExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.lsjl from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm=l.xmbm
				where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">
					and l.xjsdj = #{xjsdj}
				</if>
				<if test="lsjl!=null and lsjl!=''">
					and l.lsjl=#{lsjl}
				</if>
				<if test="tsdq!=null and tsdq!=''">
					and l.tsdq like '%'||#{tsdq}||'%'
				</if>
				<if test="xmbm!=null and xmbm!=''">
					and c.xmbm like #{xmbm}||'%'
				</if>
				<if test="jsjsdj!=null and jsjsdj!=''">
					and c.jsjsdj=#{jsjsdj}
				</if>
				<if test="shzt>=0">
					and c.shzt=${shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		)
	</select>
	<select id="queryXjExcel" parameterType="cbsj" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.*,l.ghlxbh,l.lsjl from cbsj_xj c left join lxsh_xj l on c.xmbm=l.xmbm
				where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">
					and l.xjsdj = #{xjsdj}
				</if>
				<if test="tsdq!=null and tsdq!=''">
					and l.tsdq like '%'||#{tsdq}||'%'
				</if>
				<if test="xmbm!=null and xmbm!=''">
					and c.xmbm like #{xmbm}||'%'
				</if>
				<if test="jsjsdj!=null and jsjsdj!=''">
					and c.jsjsdj=#{jsjsdj}
				</if>
				<if test="shzt>=0">
					and c.shzt=${shzt}
				</if>
				order by c.shzt,c.xmbm desc) t 
		)
	</select>
</mapper>
