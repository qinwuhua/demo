<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.jhsh">
	<insert id="insertJhshLmsjFromCbsj" parameterType="java.util.List">
		insert into jhsh_sjgz (id,xmbm,xmmc, xzqh, qdzh, zdzh, kgsj, wgsj, gq, gkpfwh, sjpfwh,jszlc)
		select sys_guid(),c.xmbm,c.xmmc,c.xzqh,c.qdzh,c.zdzh,c.kgsj,c.wgsj,c.gq,k.gkpfwh,c.sjpfwh,c.jszlc
		from cbsj_sjgz c left join kxxyj_sjgz k on c.xmbm=k.xmbm where c.xmbm=#{xmbm}
	</insert>
	<insert id="insertJhshLmgzFromCbsj" parameterType="java.util.List">
		insert into jhsh_lmgz (id,xmbm,xmmc, xzqh, qdzh, zdzh, kgsj, wgsj, gq, gkpfwh, sjpfwh)
		select sys_guid(),c.xmbm,c.xmmc,c.xzqh,c.qdzh,c.zdzh,c.kgsj,c.wgsj,c.gq,k.gkpfwh,c.sjpfwh
		from cbsj_lmgz c left join kxxyj_lmgz k on c.xmbm=k.xmbm where c.xmbm=#{xmbm}
	</insert>
	<insert id="insertJhshXjFromCbsj" parameterType="java.util.List">
		insert into jhsh_xj (id,xmbm,xmmc, xzqh, qdzh, zdzh, kgsj, wgsj, gq, gkpfwh, sjpfwh)
		select sys_guid(),c.xmbm,c.xmmc,c.xzqh,c.qdzh,c.zdzh,c.kgsj,c.wgsj,c.gq,k.gkpfwh,c.sjpfwh
		from cbsj_xj c left join kxxyj_xj k on c.xmbm=k.xmbm where c.xmbm=#{xmbm}
	</insert>
	<insert id="insertJhshYhdzxFromCbsj" parameterType="cbsj">
		insert into jhsh_yhdzx (xmbm,xmmc,ylxbh,ghlxbh,gcfl,xzqh,xzqhdm,qdzh,zdzh,lc,jhkgsj,jhwgsj)
		select c.xmbm,c.xmmc,x.ylxbh,x.ghlxbh,x.gcfl,c.xzqh,x.xzqhdm,c.qdzh,c.zdzh,c.lc,c.kgsj,c.wgsj 
		from cbsj_yhdzx c left join xmsq_yhdzx x on c.xmbm=x.xmbm where c.xmbm in (${xmbm})
	</insert>
	<insert id="insertJhshShFromCbsj" parameterType="cbsj">
		insert into jhsh_sh (xmbm,xmmc,ylxbh,ghlxbh,gcfl,xzqh,xzqhdm,qdzh,zdzh,lc,jhkgsj,jhwgsj)
		select c.xmbm,c.xmmc,x.ylxbh,x.ghlxbh,x.gcfl,c.xzqh,x.xzqhdm,c.qdzh,c.zdzh,c.lc,c.kgsj,c.wgsj 
		from cbsj_sh c left join xmsq_sh x on c.xmbm=x.xmbm where c.xmbm in (${xmbm})
	</insert>
	
	<select id="queryJhshLmsj" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.xmsl xmsl from jhsh_sjgz j left join lxsh_sjgz l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%1___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%1___' and jdbs='2')
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshLmgz" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.xmsl xmsl from jhsh_lmgz j left join lxsh_lmgz l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%2___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
					and ${jhsh.xzqhdm}
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%2___' and jdbs='2')
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">
					and l.lsjl=#{jhsh.lsjl}
				</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
					and l.tsdq like '%'||#{jhsh.tsdq}||'%'
				</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
					and ${jhsh.xmbm}
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
					and ${jhsh.jsdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
					and j.xmmc like '%'||#{jhsh.xmmc}||'%'
				</if>
				<if test="jhsh.xdzt>=0">
					and j.xdzt=${jhsh.xdzt}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshXj" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.xmsl from jhsh_xj j left join lxsh_xj l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%3___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%3___' and jdbs='2')
				</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshYhdzx" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,c.kgsj,c.wgsj,c.gq,l.lsjl,l.gydw,l.qdmc,l.zdmc,l.jsdj,sl.xmsl 
				from jhsh_yhdzx j left join cbsj_yhdzx c on j.xmbm=c.xmbm left join xmsq_yhdzx l on c.xmbm = l.xmbm
				left join (select xmid,count(xmid) xmsl from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">
					and ${jhsh2.xzqhdm}
				</if>
				<if test="jhsh2.ghlxbh!=null and jhsh2.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh2.ghlxbh}||'%')
				</if>
				<if test="jhsh2.ylxbh!=null and jhsh2.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh2.ylxbh} and xmid like '%4___' and jdbs='2')
				</if>
				<if test="jhsh2.lsjl!=null and jhsh2.lsjl!=''">
					and l.lsjl=#{jhsh2.lsjl}
				</if>
				<if test="jhsh2.tsdq!=null and jhsh2.tsdq!=''">
					and l.tsdq like '%'||#{jhsh2.tsdq}||'%'
				</if>
				<if test="jhsh2.jsdj!=null and jhsh2.jsdj!=''">
					and ${jhsh2.jsdj}
				</if>
				<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">
					and ${jhsh2.xmbm}
				</if>
				<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">
					and j.xmmc like '%'||#{jhsh2.xmmc}||'%'
				</if>
				<if test="jhsh2.xdzt>=0">
					and j.xdzt=${jhsh2.xdzt}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshSh" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*, c.kgsj,c.wgsj,c.gq,l.lsjl, l.gydw, l.qdmc, l.zdmc,l.jsdj,sl.xmsl  
				from jhsh_sh j left join cbsj_sh c on j.xmbm=c.xmbm left join xmsq_sh l on c.xmbm = l.xmbm
				left join (select xmid,count(xmid) xmsl from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">and ${jhsh2.xzqhdm}</if>
				<if test="jhsh2.ghlxbh!=null and jhsh2.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh2.ghlxbh}||'%')
				</if>
				<if test="jhsh2.ylxbh!=null and jhsh2.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh2.ylxbh} and xmid like '%5___' and jdbs='2')
				</if>
				<if test="jhsh2.lsjl!=null and jhsh2.lsjl!=''">and l.lsjl=#{jhsh2.lsjl}</if>
				<if test="jhsh2.tsdq!=null and jhsh2.tsdq!=''">
					and l.tsdq like '%'||#{jhsh2.tsdq}||'%'
				</if>
				<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">and ${jhsh2.xmbm}</if>
				<if test="jhsh2.jsdj!=null and jhsh2.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where jdbs='2' and ${jhsh2.jsdj})</if>
				<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">and j.xmmc like '%'||#{jhsh2.xmmc}||'%'</if>
				<if test="jhsh2.xdzt>=0">and j.xdzt=${jhsh2.xdzt}</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	
	<select id="queryJhshYhdzxCount" parameterType="java.util.Map" resultType="int">
		select count(t.xmbm) from (
			select j.* from jhsh_yhdzx j left join xmsq_yhdzx l on j.xmbm=l.xmbm
			where 1=1
			<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">and ${jhsh2.xzqhdm}</if>
			<if test="jhsh2.ghlxbh!=null and jhsh2.ghlxbh!=''">
				and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh2.ghlxbh}||'%')
			</if>
			<if test="jhsh2.ylxbh!=null and jhsh2.ylxbh!=''">
				and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh2.ylxbh} and xmid like '%4___' and jdbs='2')
			</if>
			<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">and ${jhsh2.xmbm}</if>
			<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">and j.xmmc like '%'||#{jhsh2.xmmc}||'%'</if>
			<if test="jhsh2.tsdq!=null and jhsh2.tsdq!=''">and l.tsdq like '%'||#{jhsh2.tsdq}||'%'</if>
			<if test="jhsh2.jsdj!=null and jhsh2.jsdj!=''">and ${jhsh2.jsdj}</if>
			<if test="jhsh2.xdzt>=0">and j.xdzt=${jhsh2.xdzt}</if>
			order by j.xdzt,j.xmbm desc
		) t 
	</select>
	<select id="queryJhshShCount" parameterType="java.util.Map" resultType="int">
		select count(t.xmbm) from (
			select j.* from jhsh_sh j left join xmsq_sh l on j.xmbm=l.xmbm
			where 1=1
			<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">and ${jhsh2.xzqhdm}</if>
			<if test="jhsh2.ghlxbh!=null and jhsh2.ghlxbh!=''">
				and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh2.ghlxbh}||'%')
			</if>
			<if test="jhsh2.ylxbh!=null and jhsh2.ylxbh!=''">
				and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh2.ylxbh} and xmid like '%5___' and jdbs='2')
			</if>
			<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">and ${jhsh2.xmbm}</if>
			<if test="jhsh2.jsdj!=null and jhsh2.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where jdbs='2' and ${jhsh2.jsdj})</if>
			<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">
				and j.xmmc like '%'||#{jhsh2.xmmc}||'%'
			</if>
			<if test="jhsh2.tsdq!=null and jhsh2.tsdq!=''">and l.tsdq like '%'||#{jhsh2.tsdq}||'%'</if>
			<if test="jhsh2.xdzt>=0">and j.xdzt=${jhsh2.xdzt}</if>
			order by j.xdzt,j.xmbm desc
		) t 
	</select>
	<select id="queryJhshCountLmsj" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_sjgz j left join lxsh_sjgz l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
			and ${jhsh.xzqhdm}
		</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%1___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
			and ${jhsh.xmbm}
		</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
			and j.xmmc like '%'||#{jhsh.xmmc}||'%'
		</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
			and l.tsdq like '%'||#{jhsh.tsdq}||'%'
		</if>
		<if test="jhsh.xdzt>=0">
			and j.xdzt=${jhsh.xdzt}
		</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
			and ${jhsh.jsdj}
		</if>
		<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">
			and l.lsjl=#{jhsh.lsjl}
		</if>
	</select>
	<select id="queryJhshCountLmgz" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_lmgz j left join lxsh_lmgz l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
			and ${jhsh.xzqhdm}
		</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%2___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
			and ${jhsh.xmbm}
		</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
			and ${jhsh.jsdj}
		</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
			and j.xmmc like '%'||#{jhsh.xmmc}||'%'
		</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
			and l.tsdq like '%'||#{jhsh.tsdq}||'%'
		</if>
		<if test="jhsh.xdzt>=0">
			and j.xdzt=${jhsh.xdzt}
		</if>
	</select>
	<select id="queryJhshCountXj" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_xj j left join lxsh_xj l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%3___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
		<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
		<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
	</select>
	
	<update id="updateJhshxxLmsj" parameterType="java.util.List">
		update jhsh_sjgz c set 
		<if test="pfztz!=null">c.pfztz=#{pfztz},</if>
		<if test="bbzzj!=null">c.bbzzj=#{bbzzj},</if>
		<if test="sbzzj!=null">c.sbzzj=#{sbzzj},</if>
		<if test="xdwh!=null">c.xdwh=#{xdwh},</if>
		<if test="xdsj!=null">c.xdsj=#{xdsj},</if>
		c.xdzt=${xdzt} 
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateJhshxxLmgz" parameterType="java.util.List">
		update jhsh_lmgz c set 
		<if test="pfztz!=null">c.pfztz=#{pfztz},</if>
		<if test="bbzzj!=null">c.bbzzj=#{bbzzj},</if>
		<if test="sbzzj!=null">c.sbzzj=#{sbzzj},</if>
		<if test="xdwh!=null">c.xdwh=#{xdwh},</if>
		<if test="xdsj!=null">c.xdsj=#{xdsj},</if>
		c.xdzt=${xdzt} where c.xmbm=#{xmbm}
	</update>
	<update id="updateJhshxxXj" parameterType="java.util.List">
		update jhsh_xj c set 
		<if test="pfztz!=null">c.pfztz=#{pfztz},</if>
		<if test="bbzzj!=null">c.bbzzj=#{bbzzj},</if>
		<if test="sbzzj!=null">c.sbzzj=#{sbzzj},</if>
		<if test="xdwh!=null">c.xdwh=#{xdwh},</if>
		<if test="xdsj!=null">c.xdsj=#{xdsj},</if>
		c.xdzt=${xdzt} where c.xmbm=#{xmbm}
	</update>
	<update id="updateJhshxxYhdzx" parameterType="jhsh">
		update jhsh_yhdzx c set 
		<if test="ztz!=null">ztz=#{ztz},</if>
		<if test="yqdbcgs!=null">yqdbcgs=#{yqdbcgs},</if>
		<if test="sysbbzj!=null">sysbbzj=#{sysbbzj},</if>
		<if test="qdzh!=null">qdzh=#{qdzh},</if>
		<if test="zdzh!=null">zdzh=#{zdzh},</if>
		<if test="lc!=null">lc=#{lc},</if>
		<if test="mclmlx!=null">mclmlx=#{mclmlx},</if>
		<if test="mclx!=null">mclx=#{mclx},</if>
		<if test="mcsl!=null">mcsl=#{mcsl},</if>
		<if test="mcje!=null">mcje=#{mcje},</if>
		<if test="jclx!=null">jclx=#{jclx},</if>
		<if test="jcsl!=null">jcsl=#{jcsl},</if>
		<if test="jcje!=null">jcje=#{jcje},</if>
		<if test="xfcsl!=null">xfcsl=#{xfcsl},</if>
		<if test="xfcje!=null">xfcje=#{xfcje},</if>
		<if test="bxsl!=null">bxsl=#{bxsl},</if>
		<if test="bxje!=null">bxje=#{bxje},</if>
		<if test="gfcd!=null">gfcd=#{gfcd},</if>
		<if test="gfje!=null">gfje=#{gfje},</if>
		<if test="llcl!=null">llcl=#{llcl},</if>
		<if test="xdwh!=null">xdwh=#{xdwh},</if>
		<if test="xdsj!=null">xdsj=#{xdsj},</if>
		xdzt=${xdzt} where c.xmbm=#{xmbm}
	</update>
	<update id="updateJhshxxSh" parameterType="jhsh">
		update jhsh_sh c set 
		<if test="pfztz!=null">c.pfztz=#{pfztz}</if>
		<if test="bbzzj!=null">,c.bbzzj=#{bbzzj}</if>
		<if test="sbzzj!=null">,c.sbzzj=#{sbzzj}</if>
		<if test="xdwh!=null">,c.xdwh=#{xdwh}</if>
		<if test="xdsj!=null">,c.xdsj=#{xdsj}</if>
		<if test="qdzh!=null">,qdzh=#{qdzh}</if>
		<if test="zdzh!=null">,zdzh=#{zdzh}</if>
		<if test="lc!=null">,lc=#{lc}</if>
		,xdzt=${xdzt} where c.xmbm=#{xmbm}
	</update>
	
	<select id="queryLxshLmsjByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,l.jszlc 
		from lxsh_sjgz l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	<select id="queryLxshLmgzByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj, 
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc from lxsh_lmgz l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	<select id="queryLxshXjByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj, xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, 
		l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, xmid, lxbm, l1.lxmc,l1.qdzh, 
		l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,l1.xjlxbm,l1.xjqdzh,l1.xjzdzh,l1.xjlc 
		from lxsh_xj l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	
	<select id="queryJhshxxLmsjByXmbm" parameterType="java.util.Map" resultType="jhsh">
		select * from jhsh_sjgz where xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxLmgzByXmbm" parameterType="java.util.Map" resultType="jhsh">
		select * from jhsh_lmgz where xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxXjByXmbm" parameterType="java.util.Map" resultType="jhsh">
		select * from jhsh_xj where xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxYhdzxByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*,l.lxbm as ylxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from jhsh_yhdzx j left join lxsh_lx l on j.xmbm=l.xmid where jdbs='2' and l.sffirst='1' and j.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxShByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*,l.lxbm as ylxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from jhsh_sh j left join lxsh_lx l on j.xmbm=l.xmid where jdbs='2' and l.sffirst='1' and j.xmbm=#{xmbm}
	</select>
	<select id="queryLmsjKxxyjByXmbm" parameterType="jhsh" resultType="kxxyj">
		select * from kxxyj_sjgz k left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
	    where xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	<select id="queryLmgzKxxyjByXmbm" parameterType="jhsh" resultType="kxxyj">
		select * from kxxyj_lmgz k left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
	    where xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	<select id="queryXjKxxyjByXmbm" parameterType="jhsh" resultType="kxxyj">
		select * from kxxyj_xj k left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
		where xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	
	<!-- 路线操作部分 -->
	<update id="updateLx" parameterType="lx">
		update lxsh_lx l set 
		<if test="qdmc!=null">l.qdmc=#{qdmc},</if>
		<if test="zdmc!=null">l.zdmc=#{zdmc},</if>
		<if test="yilc!=null and yilc!=''">l.yilc=#{yilc},</if>
		<if test="erlc!=null and erlc!=''">l.erlc=#{erlc},</if>
		<if test="sanlc!=null and sanlc!=''">l.sanlc=#{sanlc},</if>
		<if test="silc!=null and silc!=''">l.silc=#{silc},</if>
		<if test="dwlc!=null and dwlc!=''">l.dwlc=#{dwlc},</if>
		<if test="wllc!=null and wllc!=''">l.wllc=#{wllc},</if>
		<if test="jhyilc!=null and jhyilc!=''">l.jhyilc=#{jhyilc},</if>
		<if test="jherlc!=null and jherlc!=''">l.jherlc=#{jherlc},</if>
		<if test="jhsanlc!=null and jhsanlc!=''">l.jhsanlc=#{jhsanlc},</if>
		<if test="jhsilc!=null and jhsilc!=''">l.jhsilc=#{jhsilc},</if>
		<if test="jhdwlc!=null and jhdwlc!=''">l.jhdwlc=#{jhdwlc},</if>
		<if test="jhwllc!=null and jhwllc!=''">l.jhwllc=#{jhwllc},</if>
		<if test="xjlxbm!=null and xjlxbm!=''">l.xjlxbm=#{xjlxbm},</if>
		<if test="xjqdzh!=null">l.xjqdzh=#{xjqdzh},</if>
		<if test="xjzdzh!=null">l.xjzdzh=#{xjzdzh},</if>
		<if test="xjlc!=null and xjlc!=''">l.xjlc=#{xjlc},</if>
		<if test="lxbm!=null and lxbm!=''">l.lxbm=#{lxbm},</if>
		<if test="qdzh!=null and qdzh!=''">l.qdzh=#{qdzh},</if>
		<if test="zdzh!=null and zdzh!=''">l.zdzh=#{zdzh},</if>
		<if test="gydw!=null and gydw!=''">l.gydw=#{gydw},</if>
		<if test="gydwdm!=null and gydwdm!=''">l.gydwdm=#{gydwdm},</if>
		<if test="xzqh!=null and xzqh!=''">l.xzqh=#{xzqh},</if>
		<if test="xzqhdm!=null and xzqhdm!=''">l.xzqhdm=#{xzqhdm},</if>
		<if test="jsjsdj!=null and jsjsdj!=''">l.jsjsdj=#{jsjsdj},</if>
		<if test="xjsdj!=null and xjsdj!=''">l.xjsdj=#{xjsdj},</if>
<!-- 		<if test="bzcs!=null and bzcs!=''">l.bzcs=#{bzcs},</if> -->
		<if test="jszlc!=null and jszlc!=''">l.jhlc=#{jszlc},</if>
		<if test="lc!=null and lc!=''">l.lc=#{lc}</if>
		
		<if test="lc==null or lc==''">l.lc=to_number(#{zdzh})-to_number(#{qdzh})</if>
		where l.xmid=#{xmid} 
		<if test="jdbs!=null and jdbs!=''">and jdbs=#{jdbs}</if>
		<if test="sffirst==1">and sffirst=1</if>
		<if test="id!=null and id!=''">and id=#{id}</if>
	</update>
	<insert id="insertLx" parameterType="lx">
		insert into lxsh_lx (
		<if test="xmid!=null">xmid</if>
		<if test="lxbm!=null">,lxbm</if>
		<if test="lxmc!=null">,lxmc</if>
		<if test="xzqh!=null">,xzqh</if>
		<if test="xzqhdm!=null">,xzqhdm</if>
		<if test="gydw!=null">,gydw</if>
		<if test="gydwdm!=null">,gydwdm</if>
		<if test="qdzh!=null">,qdzh</if>
		<if test="zdzh!=null">,zdzh</if>
		<if test="jsjsdj!=null">,jsjsdj</if>
		<if test="lc!=null">,lc</if>
		<if test="xjsdj!=null">,xjsdj</if>
		<if test="jsxz!=null">,jsxz</if>
		<if test="qdmc!=null">,qdmc</if>
		<if test="zdmc!=null">,zdmc</if>
		<if test="bzcs!=null">,bzcs</if>
		<if test="sffirst!=null">,sffirst</if>
		<if test="jdbs!=null">,jdbs</if>
		<if test="gpsqdzh!=null and gpsqdzh!=''">,gpsqdzh</if>
		<if test="gpszdzh!=null and gpszdzh!=''">,gpszdzh</if>
		<if test="jsfa!=null and jsfa!=''">,jsfa</if>
		<if test="yilc!=null">,yilc</if>
		<if test="erlc!=null">,erlc</if>
		<if test="sanlc!=null">,sanlc</if>
		<if test="silc!=null">,silc</if>
		<if test="dwlc!=null">,dwlc</if>
		<if test="wllc!=null">,wllc</if>
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>)
		values(<if test="xmid!=null">#{xmid}</if>
		<if test="lxbm!=null">,#{lxbm}</if>
		<if test="lxmc!=null">,#{lxmc}</if>
		<if test="xzqh!=null">,#{xzqh}</if>
		<if test="xzqhdm!=null">,#{xzqhdm}</if>
		<if test="gydw!=null">,#{gydw}</if>
		<if test="gydwdm!=null">,#{gydwdm}</if>
		<if test="qdzh!=null">,#{qdzh}</if>
		<if test="zdzh!=null">,#{zdzh}</if>
		<if test="jsjsdj!=null">,#{jsjsdj}</if>
		<if test="lc!=null">,#{lc}</if>
		<if test="xjsdj!=null">,#{xjsdj}</if>
		<if test="jsxz!=null">,#{jsxz}</if>
		<if test="qdmc!=null">,#{qdmc}</if>
		<if test="zdmc!=null">,#{zdmc}</if>
		<if test="bzcs!=null">,#{bzcs}</if>
		<if test="sffirst!=null">,#{sffirst}</if>
		<if test="jdbs!=null">,#{jdbs}</if>
		<if test="gpsqdzh!=null and gpsqdzh!=''">,#{gpsqdzh}</if>
		<if test="gpszdzh!=null and gpszdzh!=''">,#{gpszdzh}</if>
		<if test="jsfa!=null and jsfa!=''">,#{jsfa}</if>
		<if test="yilc!=null">,#{yilc}</if>
		<if test="erlc!=null">,#{erlc}</if>
		<if test="sanlc!=null">,#{sanlc}</if>
		<if test="silc!=null">,#{silc}</if>
		<if test="dwlc!=null">,#{dwlc}</if>
		<if test="wllc!=null">,#{wllc}</if>
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>)
	</insert>
	<delete id="deleteLx" parameterType="lx">
		delete from lxsh_lx where id=#{id}
	</delete>
	<select id="selectlxList" parameterType="lx" resultType="lx">
		select * from lxsh_lx where xmid=#{xmid} 
		<if test="jdbs!=null"> and jdbs=#{jdbs}</if>
		<if test="sffirst==1">and sffirst!='1'</if>
	</select>
	<select id="selectlxbgList" parameterType="lx" resultType="lx">
		select * from lxsh_lx_tz where xmid=#{xmid} 
		<if test="jdbs!=null"> and jdbs=#{jdbs}</if>
		<if test="sffirst==1">and sffirst!='1'</if>
	</select>
	<insert id="insertLxJdbs" parameterType="lx">
		insert into lxsh_lx (xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, jdbs,gpsqdzh,gpszdzh,jsfa,yilc,erlc,sanlc,silc,dwlc,wllc)
		select xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, to_char(to_number(#{jdbs})+1),gpsqdzh,gpszdzh,jsfa,yilc,erlc,sanlc,silc,dwlc,wllc from lxsh_lx where xmid in (${xmid}) and jdbs=#{jdbs}
	</insert>
	<!-- 历史记录查询部分 -->
	<select id="queryHaveLx" parameterType="lx" resultType="lx">
		select distinct xmid,xmmc from LXSH_LX l,(
		select xmbm,xmmc from lxsh_lmgz union all select xmbm,xmmc from lxsh_sjgz
		union all select xmbm,xmmc from lxsh_xj
		union all select xmbm,xmmc from xmsq_sh
		union all select xmbm,xmmc from xmsq_yhdzx) x 
		where l.xmid=x.xmbm and l.lxbm like '%'||#{lxbm}||'%' and 
		(((to_number(nvl(l.zdzh,0)) >= ${qdzh} and ${qdzh} >= to_number(nvl(l.qdzh,0))) or 
		(to_number(nvl(l.zdzh,0)) >= ${zdzh} and ${zdzh} >= to_number(nvl(l.qdzh,0)))) or
		(to_number(nvl(l.qdzh,0)) = ${qdzh} or to_number(nvl(l.zdzh,0)) = ${zdzh})) 
		and (to_number(nvl(l.qdzh,0)) != ${zdzh} and to_number(nvl(l.zdzh,0)) != ${qdzh})
		<!-- and (to_number(qdzh) != ${zdzh} and to_number(zdzh) != ${zdzh}) -->
		and l.xmid like substr(#{xmid},0,4)||'%'
	</select>
	<select id="queryLxMaxJdbs" parameterType="lx" resultType="lx">
		select * from lxsh_lx where xmid=#{xmid} and 
		jdbs= (select max(jdbs) from lxsh_lx x where x.xmid = #{xmid})
	</select>
	<select id="queryLxMaxJdbs1" parameterType="lx" resultType="lx">
		select * from wnjh_lx where xmid=#{xmid}
	</select>
	<select id="queryYLx" parameterType="lx" resultType="lx">
		<![CDATA[select ylxbm ylxbm,(case when Xqdzh<${qdzh} then YQDZH+${qdzh}-XQDZH else yqdzh end) yqdzh,
		(case when ${zdzh}<Xzdzh then YZDZH-XZDZH+${zdzh} else yzdzh end ) yzdzh ,
		xlxbm as lxbm,(case when Xqdzh<${qdzh} then ${qdzh} else xqdzh end ) qdzh,
		(case when ${zdzh}<Xzdzh then ${zdzh} else xzdzh end) zdzh 
		from XTGL_LXSJ t where  t.xlxbm like #{lxbm} || '%' and 
		t.Xqdzh<${zdzh} and t.Xzdzh>${qdzh}]]>
	</select>
	<select id="queryLsjlList" parameterType="java.util.Map" resultType="lx">
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,j.gcfl xjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lxsh_lx l right join jhsh_yhdzx j on l.xmid=j.xmbm right join cbsj_yhdzx c on j.xmbm=c.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    and (to_number(l.qdzh) != ${lx.zdzh} and to_number(l.zdzh) != ${lx.qdzh})
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_yhdzx jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
		union all
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,'' xjsdj,l.jsjsdj from lxsh_lx l right join jhsh_sh j on l.xmid=j.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    and (to_number(l.qdzh) != ${lx.zdzh} and to_number(l.zdzh) != ${lx.qdzh})
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_sh jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
		union all
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,'' xjsdj,l.jsjsdj from lxsh_lx l right join jhsh_lmgz j on l.xmid=j.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    and (to_number(l.qdzh) != ${lx.zdzh} and to_number(l.zdzh) != ${lx.qdzh})
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_lmgz jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
		union all
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,'' xjsdj,l.jsjsdj from lxsh_lx l right join jhsh_sjgz j on l.xmid=j.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    and (to_number(l.qdzh) != ${lx.zdzh} and to_number(l.zdzh) != ${lx.qdzh})
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_sjgz jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
		union all
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,'' xjsdj,l.jsjsdj from lxsh_lx l right join jhsh_xj j on l.xmid=j.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    and (to_number(l.qdzh) != ${lx.zdzh} and to_number(l.zdzh) != ${lx.qdzh})
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_xj jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
	</select>
	<select id="queryJsdjAndLcByStartAndEnd" parameterType="lx" resultType="lx">
		<![CDATA[
		select to_char(sum(yilc), 'FM99990.099') yilc,to_char(sum(erlc), 'FM99990.099') erlc,to_char(sum(sanlc), 'FM99990.099') sanlc,to_char(sum(silc), 'FM99990.099') silc,to_char(sum(dwlc), 'FM99990.099') dwlc,to_char(sum(wllc), 'FM99990.099') wllc,replace(WMSYS.WM_CONCAT(f114),',','、') xjsdj
		from (select nvl(case when f114 = '一级公路' then sum(roadends - roadstart) end,0) yilc,
		nvl(case when f114 = '二级公路' then sum(roadends - roadstart) end,0) erlc,
		nvl(case when f114 = '三级公路' then sum(roadends - roadstart) end,0) sanlc,
		nvl(case when f114 = '四级公路' then sum(roadends - roadstart) end,0) silc,
		nvl(case when f114 = '等外公路' then sum(roadends - roadstart) end,0) dwlc,
		nvl(case when f114 is null then sum(roadends - roadstart) end,0) wllc,substr(f114,1,2) f114,f014
		from (select g.roadcode,to_char(decode(g.f114,null,'无路',g.f114)) f114,f014,
		case when g.roadstart < ${qdzh} then ${qdzh} when g.roadstart > ${qdzh} then g.roadstart when g.roadstart = ${qdzh} then g.roadstart end roadstart,
		case when g.roadends < ${zdzh} then g.roadends when g.roadends > ${zdzh} then ${zdzh} when g.roadends = ${zdzh} then g.roadends end roadends from gpsroad g
		where substr(g.roadcode, 1, 1) in ('G', 'S', 'X', 'Y', 'C') and g.roadcode like #{lxbm} || '%'
		and ((g.roadstart <= ${qdzh} and ${qdzh} < g.roadends) or (g.roadstart > ${qdzh} and g.roadends < ${zdzh}) or (g.roadstart < ${zdzh} and g.roadends >= ${zdzh})))
		group by f114,f014 order by f014)
		]]>
	</select>
	<select id="zdyQueryLmsj" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from lxsh_sjgz l left join 
			(select k1.*,l1.lc from kxxyj_sjgz k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
			(select c1.*,l1.lc from cbsj_sjgz c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
			left join jhsh_sjgz j on c.xmbm=j.xmbm
			where 1=1  and l.shzt='1' and k.shzt='1'
			<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
			<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryLmsjTotal" parameterType="java.util.List" resultType="int">
		select count(*) from lxsh_sjgz l left join 
		(select k1.*,l1.lc from kxxyj_sjgz k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		(select c1.*,l1.lc from cbsj_sjgz c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		left join jhsh_sjgz j on c.xmbm=j.xmbm
		where 1=1  and l.shzt='1' and k.shzt='1'
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like #{jhsh.xmmc}||'%'</if>
		<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="zdyQueryLmgz" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from lxsh_lmgz l left join 
		    (select k1.*,l1.lc from kxxyj_lmgz k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		    (select c1.*,l1.lc from cbsj_lmgz c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		    left join jhsh_lmgz j on c.xmbm=j.xmbm
		    where 1=1 and l.shzt='1' and k.shzt='1'
			<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
			<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryLmgzTotal" parameterType="java.util.List" resultType="int">
		select count(*) from lxsh_lmgz l left join 
		(select k1.*,l1.lc from kxxyj_lmgz k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		(select c1.*,l1.lc from cbsj_lmgz c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		left join jhsh_lmgz j on c.xmbm=j.xmbm
		where 1=1 and l.shzt='1' and k.shzt='1'
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="zdyQueryXj" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from lxsh_xj l left join 
		    (select k1.*,l1.lc from kxxyj_xj k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		    (select c1.*,l1.lc from cbsj_xj c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		    left join jhsh_xj j on c.xmbm=j.xmbm
	      	where 1=1  and l.shzt='1' and k.shzt='1'
	      	<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
	      	<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryXjTotal" parameterType="java.util.List" resultType="int">
		select count(*) from lxsh_xj l left join 
		(select k1.*,l1.lc from kxxyj_xj k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		(select c1.*,l1.lc from cbsj_xj c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		left join jhsh_xj j on c.xmbm=j.xmbm
	    where 1=1  and l.shzt='1' and k.shzt='1'
	    <if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
	    <if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="zdyQueryYhdzx" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from xmsq_yhdzx x left join cbsj_yhdzx c on x.xmbm=c.xmbm left join jhsh_yhdzx j on c.xmbm=j.xmbm
			where x.sqzt='7'
			<if test="jhsh.xzqh!=null and jhsh.xzqh!=''">and x.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.gydw!=null and jhsh.gydw!=''">and x.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and x.xmbm like #{jhsh.xmbm}||'%'</if>
			<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and x.lxmc like '%'||#{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and x.ylxbh like '%'#{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt=#{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and x.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryYhdzxTotal" parameterType="java.util.List" resultType="int">
		select count(*) from xmsq_yhdzx x left join cbsj_yhdzx c on x.xmbm=c.xmbm left join jhsh_yhdzx j on c.xmbm=j.xmbm
		where x.sqzt='7'
		<if test="jhsh.xzqh!=null and jhsh.xzqh!=''">and x.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.gydw!=null and jhsh.gydw!=''">and x.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and x.xmbm like #{jhsh.xmbm}||'%'</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and x.lxmc like '%'||#{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and x.ylxbh like '%'#{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt=#{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and x.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="zdyQuerySh" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from xmsq_sh x left join cbsj_sh c on x.xmbm=c.xmbm left join jhsh_sh j on c.xmbm=j.xmbm
			where x.sqzt='7'
			<if test="jhsh.xzqh!=null and jhsh.xzqh!=''">and x.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.gydw!=null and jhsh.gydw!=''">and x.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and x.xmbm like #{jhsh.xmbm}||'%'</if>
			<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and x.lxmc like '%'||#{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and x.ylxbh like '%'#{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt=#{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and x.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryShTotal" parameterType="java.util.List" resultType="int">
		select count(*) from xmsq_sh x left join cbsj_sh c on x.xmbm=c.xmbm left join jhsh_sh j on c.xmbm=j.xmbm
		where x.sqzt='7'
		<if test="jhsh.xzqh!=null and jhsh.xzqh!=''">and x.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.gydw!=null and jhsh.gydw!=''">and x.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and x.xmbm like #{jhsh.xmbm}||'%'</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and x.lxmc like '%'||#{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and x.ylxbh like '%'#{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt=#{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and x.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="queryJhshLjLmsj" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_sjgz j left join lxsh_sjgz l on j.xmbm=l.xmbm 
		left join (select xmid,sum(lc) lc from lxsh_lx where xmid like '%1___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%1___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and l.lsjl=#{jhsh.lsjl}
		</if>
		<if test="tsdq!=null and tsdq!=''">
			and l.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="xmbm!=null and xmbm!=''">
			and ${xmbm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and j.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xdzt>=0">
			and j.xdzt=${xdzt}
		</if>
		<if test="jsdj!=null and jsdj!=''">
			and ${jsdj}
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and l.lsjl=#{lsjl}
		</if>
	</select>
	<select id="queryJhshLjLmgz" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_lmgz j left join lxsh_lmgz l on j.xmbm=l.xmbm 
		left join (select xmid,sum(lc) lc from lxsh_lx where xmid like '%2___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%2___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
	</select>
	<select id="queryJhshLjXj" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_xj j left join lxsh_xj l on j.xmbm=l.xmbm 
		left join (select xmid,sum(lc) lc from lxsh_lx where xmid like '%3___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%3___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
	</select>
	<select id="queryJhshLjYhdzx" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.sysbbzj) sysbb,sum(j.yqdbcgs) yqdbcgs,sum(j.ztz) ztz,sum(j.lc) lc from jhsh_yhdzx j left join xmsq_yhdzx l on j.xmbm=l.xmbm left join 
		(select xmid,sum(lc) lc from lxsh_lx where xmid like '%4___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___' and jdbs='2')
		</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
	</select>
	<select id="queryJhshLjSh" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.sbzzj) sbzzj,sum(j.bbzzj) bbzzj,sum(l1.lc) lc from jhsh_sh j left join xmsq_sh l on j.xmbm=l.xmbm left join 
		(select xmid,sum(lc) lc from lxsh_lx where xmid like '%5___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1 
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___' and jdbs='2')
		</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
	</select>
	
	<select id="queryJhshYhzx" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.xmbm,j.ztz,j.zbzzj,j.sbzzj,j.zddzjl,j.dfzc,j.jhkgsj,j.jhwgsj,j.xdzt,j.xdsj,
			        l.xzqh,l.gydw,l.xzqhdm,l.gydwdm,l.jb,l.jsxz,l.ydbmc,l.xmmc,l.lxmc,l.bz,l.lxzh,l.sqzt
			        from jhsh_yhzx j  left join xmsq_yhzx l on j.xmbm = l.xmbm
			        where 1=1
				<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">
					and ${jhsh2.xzqhdm}
				</if>
				<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">
					and l.xmmc like '%'||'${jhsh2.xmmc}'||'%'
				</if>
				<if test="jhsh2.jb!=null and jhsh2.jb!=''">
					and l.jb like '%'||${jhsh2.jb}||'%'
				</if>
				<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">
					and ${jhsh2.xmbm}
				</if>
				<if test="jhsh2.jsxz!=null and jhsh2.jsxz!=''">
					and l.jsxz like '%'||${jhsh2.jsxz}||'%'
				</if>
				<if test="jhsh2.ydbmc!=null and jhsh2.ydbmc!=''">
					and l.ydbmc like '%'||'${jhsh2.ydbmc}'||'%'
				</if>
				<if test="jhsh2.lxmc !='' and jhsh2.lxmc != null ">
					and l.lxmc like '%'||'${jhsh2.lxmc}'||'%'
				</if>
				<if test="jhsh2.xdzt>=0">
					and j.xdzt=${jhsh2.xdzt}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	
	<select id="queryJhshYhzxCount" parameterType="java.util.Map" resultType="int">
				select count(*)
			        from jhsh_yhzx j  left join xmsq_yhzx l on j.xmbm = l.xmbm
			        where 1=1
				<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">
					and ${jhsh2.xzqhdm}
				</if>
				<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">
					and l.xmmc like '%'||'${jhsh2.xmmc}'||'%'
				</if>
				<if test="jhsh2.jb!=null and jhsh2.jb!=''">
					and l.jb like '%'||${jhsh2.jb}||'%'
				</if>
				<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">
					and ${jhsh2.xmbm}
				</if>
				<if test="jhsh2.jsxz!=null and jhsh2.jsxz!=''">
					and l.jsxz like '%'||${jhsh2.jsxz}||'%'
				</if>
				<if test="jhsh2.ydbmc!=null and jhsh2.ydbmc!=''">
					and l.ydbmc like '%'||'${jhsh2.ydbmc}'||'%'
				</if>
				<if test="jhsh2.lxmc !='' and jhsh2.lxmc != null ">
					and l.lxmc like '%'||'${jhsh2.lxmc}'||'%'
				</if>
				<if test="jhsh2.xdzt>=0">
					and j.xdzt=${jhsh2.xdzt}
				</if>
	</select>
	
	<select id="queryJhshLjYhzx" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.sbzzj) sysbb,sum(j.ztz) ztz 
		from jhsh_yhzx j left join xmsq_yhzx l on j.xmbm=l.xmbm 
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and l.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="jb!=null and jb!=''">
			and l.jb like '%'||#{jb}||'%'
		</if>
		<if test="xmbm!=null and xmbm!=''">
			and ${xmbm}
		</if>
		<if test="jsxz!=null and jsxz!=''">
			and l.jsxz like '%'||#{jsxz}||'%'
		</if>
		<if test="ydbmc!=null and ydbmc!=''">
			and l.ydbmc like '%'||#{ydbmc}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and l.lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xdzt>=0">
			and j.xdzt=#{xdzt}
		</if>
	</select>
	
	<select id="queryJhshxxYhzxByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*  from jhsh_yhzx j where  j.xmbm=#{xmbm}
	</select>
	
	<update id="updateJhshYhzx" parameterType="jhsh">
		update jhsh_yhzx set 
		<if test="xmbm!=null">xmbm=#{xmbm}</if>
		<if test="ztz!=null">,ztz=#{ztz}</if>
		<if test="zbzzj!=null">,zbzzj=#{zbzzj}</if>
		<if test="sbzzj!=null">,sbzzj=#{sbzzj}</if>
		<if test="zddzjl!=null">,zddzjl=#{zddzjl}</if>
		<if test="dfzc!=null">,dfzc=#{dfzc}</if>
		<if test="jhkgsj!=null">,jhkgsj=#{jhkgsj}</if>
		<if test="jhwgsj!=null">,jhwgsj=#{jhwgsj}</if>
		<if test="xdsj!=null">,xdsj=#{xdsj}</if>
		<if test="xdwh!=null">,xdwh=#{xdwh}</if>
		<if test="xdzt!=null">,xdzt=#{xdzt}</if>
		where xmbm=#{xmbm}
	</update>
</mapper>
