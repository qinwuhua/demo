<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.dbbb">
<!--危桥  -->
<select id="selectWqjc" parameterType="jckwqgz" resultType="jckwqgz">
 	select * from (
 		select rownum num ,t.* from xmk_wqgz t where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
 			order by decode(sbthcd,#{sbthcd},'未上报',sbzt),shzt desc 
 </select>
  <select id="selectWqjcCount" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_wqgz t where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 </select>
	<select id="exportExcel_wqjc" parameterType="jckwqgz"	resultType="sjbb">
		select
		gydw v_0,xzqhdm v_1,xzqhmc v_2,lxbm v_3,lxmc v_4,qlbh v_5,qlmc v_6,qlzxzh v_7,xjgjnd v_8,qlqc v_9,qlkd v_10,
		kjzc v_11,dkzdkj v_12,akjfl v_13,sbjgxs v_14,pddj v_15,bhnr v_16,bz v_17
		from xmk_wqgz where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
	</select>
	
	<select id="selectWqsc" parameterType="jckwqgz" resultType="sckwqgz">
		select * from (
		select rownum num ,t.* from
			(select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id) t 
			where 1=1
		<if test="gydw!='' and gydw!= null ">
			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||(#{xmnf})||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(sck_sbthcd,#{sbthcd},'未上报',sck_sbzt),sck_shzt desc
	</select>
	<select id="selectWqscCount" parameterType="jckwqgz" resultType="int">
		select count(*) from (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id)
			where 1=1
		<if test="gydw!='' and gydw!= null ">
			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||(#{xmnf})||'%'
		</if>
	</select>
	<select id="exportExcel_wqsc" parameterType="jckwqgz"	resultType="sjbb">
		select
		qlbh v_0,qlmc v_1,qlzxzh v_2,qlqc v_3,qlkd v_4,fapgdw v_5,fascdw v_6,faspsj v_7,spwh v_8,tzgs v_9,jsxz v_10,
		jsnr v_11,bz v_12
		from (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id)
		where  1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
	</select>
	
	<select id="selectWqjh" parameterType="jckwqgz" resultType="plan_wqgz">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
					left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1
				<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					and xmnf like '%'||(#{xmnf})||'%'
				</if>
	 				order by jh.sbzt,jh.spzt,jh.sbnf desc
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		
 		<select id="selectWqjhCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
			left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1
		 		<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					and xmnf like '%'||(#{xmnf})||'%'
				</if>
	</select>
	
	<select id="exportExcel_wqjh" parameterType="jckwqgz" resultType="sjbb">
		select lx.gydw v_0,lx.xzqhdm v_1,lx.xzqhmc v_2,lx.lxbm v_3,lx.lxmc v_4,lx.qlbh v_5,lx.qlmc v_6,lx.qlzxzh v_7,lx.xjgjnd v_8,
		jh.sjdw v_9,jh.sjpfdw v_10,jh.pfwh v_11,jh.pfztz v_12,jh.jhsybzje v_13,jh.jhsydfzcje v_14,jh.sfsqablbz v_15,jh.ablbzsqwh v_16
		from plan_wqgz jh
		left join sck_wqgz sc on (jh.sckid = sc.sckid)
		left join xmk_wqgz lx on (sc.xmkid = lx.id) where 1=1
		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
		order by jh.sbnf desc
	</select>
	<!--安保  -->
	<select id="selectAbjc" parameterType="jckwqgz" resultType="jckabgc">
 	select * from (
 		select rownum num ,t.* from xmk_abgc t where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
 			order by decode(sbthcd,#{sbthcd},'未上报',sbzt),shzt desc 
 </select>
  <select id="selectAbjcCount" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_abgc t where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 </select>
 <select id="exportExcel_abjc" parameterType="jckwqgz"	resultType="sjbb">
		select
		gydw v_0,xzqhdm v_1,xzqhmc v_2,lxbm v_3,lxmc v_4,qdzh v_5,zdzh v_6,qzlc v_7,yhlc v_8,gjxjnd v_9,yhnr v_10,bz v_11 
			from xmk_abgc where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 		order by decode(sbthcd,#{sbthcd},'未上报',sbzt),shzt desc 
	</select>
	
	<select id="selectAbsc" parameterType="jckwqgz" resultType="sckabgc">
		select * from (
		select rownum num ,t.* from
			(select * from sck_abgc t join xmk_abgc on xmkid=xmk_abgc.id) t 
			where 1=1
		<if test="gydw!='' and gydw!= null ">
			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||(#{xmnf})||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(sck_sbthcd,#{sbthcd},'未上报',sck_sbzt),sck_shzt desc
	</select>
	<select id="selectAbscCount" parameterType="jckwqgz" resultType="int">
		select count(*) from (select * from sck_abgc t join xmk_abgc on xmkid=xmk_abgc.id)
			where 1=1
		<if test="gydw!='' and gydw!= null ">
			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||(#{xmnf})||'%'
		</if>
	</select>
	<select id="exportExcel_absc" parameterType="jckwqgz"	resultType="sjbb">
		select
		gydw v_0,xzqhdm v_1,xzqhmc v_2,lxbm v_3,lxmc v_4,t.scqdzh v_5,t.sczdzh v_6,t.sczlc v_7,t.scyhlc v_8,gjxjnd v_9,fapgdw v_10,
		fascdw v_11,faspsj v_12,spwh v_13,tzgs v_14,jsxz v_15,jsnr v_16,bz v_17
		from (select * from sck_abgc join xmk_abgc on xmkid=xmk_abgc.id) t
		where  1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
	</select>
	
	<select id="selectAbjh" parameterType="jckwqgz" resultType="plan_abgc">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) 
					left join xmk_abgc lx on (sc.xmkid=lx.id) where 1=1
				<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					and xmnf like '%'||(#{xmnf})||'%'
				</if>
	 				order by jh.sbzt,jh.spzt
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		
 		<select id="selectAbjhCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) 
			left join xmk_abgc lx on (sc.xmkid=lx.id) where 1=1
		 		<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					and xmnf like '%'||(#{xmnf})||'%'
				</if>
	</select>
	<select id="exportExcel_abjh" parameterType="jckwqgz" resultType="sjbb">
		select lx.gydw v_0,lx.xzqhdm v_1,lx.xzqhmc v_2,lx.lxbm v_3,lx.lxmc v_4,sc.scqdzh v_5,sc.sczdzh v_6,sc.sczlc v_7,sc.scyhlc v_8,lx.gjxjnd v_9,
		jh.sjdw v_10,jh.sjpfdw v_11,jh.pfwh v_12,jh.pfztz v_13,jh.jhsybbzje v_14,jh.jhsydfzczj v_15,jh.sfsqablbz v_16,jh.ablbzsqwh v_17
		from plan_abgc jh
		left join sck_abgc sc on (jh.sckid = sc.sckid)
		left join xmk_abgc lx on (sc.xmkid = lx.id) where 1=1
		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
		order by jh.sbzt,jh.spzt
	</select>
	
	<!--灾害  -->
	<select id="selectZhjc" parameterType="jckwqgz" resultType="jckzhfz">
 	select * from (
 		select rownum num ,t.* from xmk_zhfz t where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
 			order by decode(sbthcd,#{sbthcd},'未上报',sbzt),shzt desc 
 </select>
  <select id="selectZhjcCount" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_zhfz t where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 </select>
 <select id="exportExcel_zhjc" parameterType="jckwqgz"	resultType="sjbb">
		select
		gydw v_0,xzqhdm v_1,xzqhmc v_2,lxbm v_3,lxmc v_4,qdzh v_5,zdzh v_6,qzlc v_7,yhlc v_8,gjxjnd v_9,yhnr v_10,bz v_11 
			from xmk_zhfz where 1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 		order by decode(sbthcd,#{sbthcd},'未上报',sbzt),shzt desc 
	</select>
	
	<select id="selectZhsc" parameterType="jckwqgz" resultType="sckzhfz">
		select * from (
		select rownum num ,t.* from
			(select * from sck_zhfz t join xmk_zhfz on xmkid=xmk_zhfz.id) t 
			where 1=1
		<if test="gydw!='' and gydw!= null ">
			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||(#{xmnf})||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(sck_sbthcd,#{sbthcd},'未上报',sck_sbzt),sck_shzt desc
	</select>
	<select id="selectZhscCount" parameterType="jckwqgz" resultType="int">
		select count(*) from (select * from sck_zhfz t join xmk_zhfz on xmkid=xmk_zhfz.id)
			where 1=1
		<if test="gydw!='' and gydw!= null ">
			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf like '%'||(#{xmnf})||'%'
		</if>
	</select>
	<select id="exportExcel_zhsc" parameterType="jckwqgz"	resultType="sjbb">
		select
		gydw v_0,xzqhdm v_1,xzqhmc v_2,lxbm v_3,lxmc v_4,t.scqdzh v_5,t.sczdzh v_6,t.sczlc v_7,t.scyhlc v_8,gjxjnd v_9,fapgdw v_10,
		fascdw v_11,faspsj v_12,spwh v_13,tzgs v_14,jsxz v_15,jsnr v_16,bz v_17
		from (select * from sck_zhfz join xmk_zhfz on xmkid=xmk_zhfz.id) t
		where  1=1
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 		order by decode(sck_sbthcd,#{sbthcd},'未上报',sck_sbzt),sck_shzt desc
	</select>
	
	<select id="selectZhjh" parameterType="jckwqgz" resultType="plan_zhfz">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) 
					left join xmk_zhfz lx on (sc.xmkid=lx.id) where 1=1
				<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					and xmnf like '%'||(#{xmnf})||'%'
				</if>
	 				order by jh.sbzt,jh.spzt
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		
 		<select id="selectZhjhCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) 
			left join xmk_zhfz lx on (sc.xmkid=lx.id) where 1=1
		 		<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					and xmnf like '%'||(#{xmnf})||'%'
				</if>
	</select>
	<select id="exportExcel_zhjh" parameterType="jckwqgz" resultType="sjbb">
		select lx.gydw v_0,lx.xzqhdm v_1,lx.xzqhmc v_2,lx.lxbm v_3,lx.lxmc v_4,sc.scqdzh v_5,sc.sczdzh v_6,sc.sczlc v_7,sc.scyhlc v_8,lx.gjxjnd v_9,
		jh.sjdw v_10,jh.sjpfdw v_11,jh.pfwh v_12,jh.pfztz v_13,jh.jhsybzje v_14,jh.jhsydfzcje v_15,jh.sfsqablbz v_16,jh.ablbzsqwh v_17
		from plan_zhfz jh
		left join sck_zhfz sc on (jh.sckid = sc.sckid)
		left join xmk_zhfz lx on (sc.xmkid = lx.id) where 1=1
		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
		order by jh.sbzt,jh.spzt
	</select>
	<!--危桥开工  -->
	<select id="selectWqkg" parameterType="jckwqgz" resultType="plan_wqgz">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
					left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1
				<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
 				<if test="xmnf!='' and xmnf!= null ">
					<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
				</if> 
	 				order by jh.sbzt,jh.spzt
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		
 		<select id="selectWqkgCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
			left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1
		 		<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
				</if> 
	</select>
	<select id="exportExcel_wqkg" parameterType="jckwqgz" resultType="sjbb">
		select lx.gydw v_0,lx.xzqhdm v_1,lx.xzqhmc v_2,lx.lxbm v_3,lx.lxmc v_4,lx.qlbh v_5,lx.qlmc v_6,lx.qlzxzh v_7,jh.xdsj v_8,
		jh.jhkgsj v_9,jh.jhwgsj v_10,jh.sjkgsj v_11,jh.sgdw v_12,jh.jldw v_13,jh.htje v_14
		from plan_wqgz jh
		left join sck_wqgz sc on (jh.sckid = sc.sckid)
		left join xmk_wqgz lx on (sc.xmkid = lx.id) where 1=1
		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
 		</if>
		order by jh.sbzt,jh.spzt
	</select>
	
	<!--安保开工  -->
	<select id="selectAbkg" parameterType="jckwqgz" resultType="plan_abgc">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) 
					left join xmk_abgc lx on (sc.xmkid=lx.id) where 1=1
				<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
 				<if test="xmnf!='' and xmnf!= null ">
					<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
				</if> 
	 				order by jh.sbzt,jh.spzt
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		
 		<select id="selectAbkgCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from plan_abgc jh left join sck_abgc sc on (jh.sckid=sc.sckid) 
			left join xmk_abgc lx on (sc.xmkid=lx.id) where 1=1
		 		<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
				</if> 
	</select>
	<select id="exportExcel_abkg" parameterType="jckwqgz" resultType="sjbb">
		select lx.gydw v_0,lx.xzqhdm v_1,lx.xzqhmc v_2,lx.lxbm v_3,lx.lxmc v_4,sc.scqdzh v_5,sc.sczdzh v_6,sc.sczlc v_7,sc.scyhlc v_8,
		jh.xdsj v_9,jh.jhkgsj v_10,jh.jhwgsj v_11,jh.sjkgsj v_12,jh.sgdw v_13,jh.jldw v_14,jh.htje v_15
		from plan_abgc jh
		left join sck_abgc sc on (jh.sckid = sc.sckid)
		left join xmk_abgc lx on (sc.xmkid = lx.id) where 1=1
		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
 		</if>
		order by jh.sbzt,jh.spzt
	</select>
	
	<!--灾害开工  -->
	<select id="selectZhkg" parameterType="jckwqgz" resultType="plan_zhfz">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) 
					left join xmk_zhfz lx on (sc.xmkid=lx.id) where 1=1
				<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
 				<if test="xmnf!='' and xmnf!= null ">
					<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
				</if> 
	 				order by jh.sbzt,jh.spzt
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		<select id="selectZhkgCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from plan_zhfz jh left join sck_zhfz sc on (jh.sckid=sc.sckid) 
			left join xmk_zhfz lx on (sc.xmkid=lx.id) where 1=1
		 		<if test="gydw!='' and gydw!= null ">
					and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
				<if test="xmnf!='' and xmnf!= null ">
					<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
				</if> 
	</select>
	<select id="exportExcel_zhkg" parameterType="jckwqgz" resultType="sjbb">
		select lx.gydw v_0,lx.xzqhdm v_1,lx.xzqhmc v_2,lx.lxbm v_3,lx.lxmc v_4,sc.scqdzh v_5,sc.sczdzh v_6,sc.sczlc v_7,sc.scyhlc v_8,
		jh.xdsj v_9,jh.jhkgsj v_10,jh.jhwgsj v_11,jh.sjkgsj v_12,jh.sgdw v_13,jh.jldw v_14,jh.htje v_15
		from plan_zhfz jh
		left join sck_zhfz sc on (jh.sckid = sc.sckid)
		left join xmk_zhfz lx on (sc.xmkid = lx.id) where 1=1
		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			<![CDATA[ and substr(trim(substr(sjkgsj,4,3)),0,length(trim(substr(sjkgsj,4,3)))-1)<=to_number(#{xmnf})]]>
 		</if>
		order by jh.sbzt,jh.spzt
	</select>
	
	<!--危桥进展  -->
	<select id="selectWqjz" parameterType="jckwqgz" resultType="Gcglwqgz">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from (select sum(wc_btz) wc_btz,sum(wc_qttz) wc_qttz,max(sbsj) sbsj,jhid
 					from gcgl_wqgz where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid )gc left join sck_wqgz sc on
 			 		(gc.jhid=sc.sckid)  left join plan_wqgz jh on (sc.sckid=jh.sckid) left join xmk_wqgz jc on sc.xmkid=jc.id
				<if test="gydw!='' and gydw!= null ">
					where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
	 				order by wc_btz
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		
 		<select id="selectWqjzCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from (select sum(wc_btz),sum(wc_qttz),max(sbsj) sbsj,jhid
 					from gcgl_wqgz where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid )gc left join sck_wqgz sc on
 			 		(gc.jhid=sc.sckid) left join plan_wqgz jh on (sc.sckid=jh.sckid) left join xmk_wqgz jc on sc.xmkid=jc.id
		 		<if test="gydw!='' and gydw!= null ">
					where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>

	</select>
	<select id="exportExcel_wqjz" parameterType="jckwqgz" resultType="sjbb">
		select lx.xzqhdm v_0,lx.xzqhmc v_1,lx.lxbm v_2,lx.lxmc v_3,lx.qlbh v_4,lx.qlmc v_5,gc.sbsj v_6,jh.yjjgsj v_7,gc.wc_btz v_8,
			gc.wc_qttz v_9,jh.sjwgsj v_10,jh.bz v_11
		 		from (select sum(wc_btz) wc_btz,sum(wc_qttz) wc_qttz,max(sbsj) sbsj,jhid
 					from gcgl_wqgz where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid )gc left join sck_wqgz sc on
 			 		(gc.jhid=sc.sckid) left join plan_wqgz jh on (sc.sckid=jh.sckid) left join xmk_wqgz lx on sc.xmkid=lx.id
		<if test="gydw!='' and gydw!= null "  >
 			where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
		order by wc_btz
	</select>
	
	<!--安保进展  -->
	<select id="selectAbjz" parameterType="jckwqgz" resultType="Gcglabgc">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from (select sum(wc_btz) wc_btz,sum(wc_qttz) wc_qttz,max(sbsj) sbsj,jhid
 					from gcgl_abgc where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid )gc left join sck_abgc sc on
 			 		(gc.jhid=sc.sckid)  left join plan_abgc jh on (sc.sckid=jh.sckid) left join xmk_abgc jc on sc.xmkid=jc.id
				<if test="gydw!='' and gydw!= null ">
					where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
	 				order by wc_btz
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		
 		<select id="selectAbjzCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from (select sum(wc_btz),sum(wc_qttz),max(sbsj) sbsj,jhid
 					from gcgl_abgc where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid)gc left join sck_abgc sc on
 			 		(gc.jhid=sc.sckid) left join plan_abgc jh on (sc.sckid=jh.sckid) left join xmk_abgc jc on sc.xmkid=jc.id
		 		<if test="gydw!='' and gydw!= null ">
					where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>

	</select>
	<select id="exportExcel_abjz" parameterType="jckwqgz" resultType="sjbb">
		select lx.xzqhdm v_0,lx.xzqhmc v_1,lx.lxbm v_2,lx.lxmc v_3,sc.scqdzh v_4,sc.sczdzh v_5,gc.sbsj v_6,jh.yjwgsj v_7,gc.wc_btz v_8,
			gc.wc_qttz v_9,jh.sjwgsj v_10,lx.bz v_11 
		 		from (select sum(wc_btz) wc_btz,sum(wc_qttz) wc_qttz,max(sbsj) sbsj,jhid
 					from gcgl_abgc where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid )gc left join sck_abgc sc on
 			 		(gc.jhid=sc.sckid) left join plan_abgc jh on (sc.sckid=jh.sckid) left join xmk_abgc lx on sc.xmkid=lx.id
		<if test="gydw!='' and gydw!= null "  >
 			where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
		order by wc_btz
	</select>
	
	<!--安保进展  -->
	<select id="selectZhjz" parameterType="jckwqgz" resultType="Gcglzhfz">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from (select sum(wc_btz) wc_btz,sum(wc_qttz) wc_qttz,max(sbsj) sbsj,jhid
 					from gcgl_zhfz where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid )gc left join sck_zhfz sc on
 			 		(gc.jhid=sc.sckid)  left join plan_zhfz jh on (sc.sckid=jh.sckid) left join xmk_zhfz jc on sc.xmkid=jc.id
				<if test="gydw!='' and gydw!= null ">
					where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>
	 				order by wc_btz
	 			) t
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
 		</select>
 		
 		<select id="selectZhjzCount"  parameterType="jckwqgz"  resultType="int">
			select count(*) from (select sum(wc_btz),sum(wc_qttz),max(sbsj) sbsj,jhid
 					from gcgl_zhfz where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid)gc left join sck_zhfz sc on
 			 		(gc.jhid=sc.sckid) left join plan_zhfz jh on (sc.sckid=jh.sckid) left join xmk_zhfz jc on sc.xmkid=jc.id
		 		<if test="gydw!='' and gydw!= null ">
					where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
				</if>

	</select>
	<select id="exportExcel_zhjz" parameterType="jckwqgz" resultType="sjbb">
		select lx.xzqhdm v_0,lx.xzqhmc v_1,lx.lxbm v_2,lx.lxmc v_3,sc.scqdzh v_4,sc.sczdzh v_5,gc.sbsj v_6,jh.yjwgsj v_7,gc.wc_btz v_8,
			gc.wc_qttz v_9,jh.sjwgsj v_10,lx.bz v_11 
		 		from (select sum(wc_btz) wc_btz,sum(wc_qttz) wc_qttz,max(sbsj) sbsj,jhid
 					from gcgl_zhfz where substr(sbyf,6,length(sbyf)-5) &lt;=to_number(#{xmnf})
 					 group by jhid )gc left join sck_zhfz sc on
 			 		(gc.jhid=sc.sckid) left join plan_zhfz jh on (sc.sckid=jh.sckid) left join xmk_zhfz lx on sc.xmkid=lx.id
		<if test="gydw!='' and gydw!= null "  >
 			where gydwbm in(select id from xtgl_department where id like #{gydw}||'%' or parent like #{gydw}||'%')
 		</if>
		order by wc_btz
	</select>
	
	<!--计划统计报表4  -->
	<select id="gljsxdList" parameterType="jckwqgz" resultType="elist">	
	select v_0,v_1,v_2,v_3,v_4,v_5,v_6,v_7,v_8,v_9,v_10,v_11,v_12,v_13,v_14,v_15,v_16,v_17,v_18,v_19,v_20 from
		(select ''v_0,lxmc v_1, decode(substr(lxbm,0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','转道') v_2 ,qdzh v_3,zdzh v_4,lxbm v_5,'' v_6,
 substr(xzqhmc,0,INSTR(xzqhmc,'市')) v_7,substr(xzqhmc,INSTR(xzqhmc,'市')+1,length(xzqhmc)-INSTR(xzqhmc,'市')) v_8,
to_char(CLASSIFY) v_9,to_char(decode(yjsdj,'一级公路',hdlc,0)+decode(yjsdj,'二级公路',hdlc,0)+decode(yjsdj,'三级公路',hdlc,0)+decode(yjsdj,'四级公路',hdlc,0),'FM999999.999999999') v_10,
decode(yjsdj,'一级公路',hdlc,'0') v_11,decode(yjsdj,'二级公路',hdlc,'0') v_12,decode(yjsdj,'三级公路',hdlc,'0') v_13,
decode(yjsdj,'四级公路',hdlc,'0') v_14,to_char(decode(yjsdj,'大桥',hdlc,'0')) v_15,to_char(decode(yjsdj,'隧道',hdlc,'0')) v_16,
to_char(ylmkd) v_17,to_char(ylmhd) v_18,to_char(TOTALINVEST) v_19,TOTALSUBSIDYFUND v_20 from PLAN_LX_YHDZX lx
 left join PLAN_YHDZX t2 on lx.jhid=t2.id left join gcgl_yhdzx gc on lx.jhid=gc.jhid where
	 		gydwdm like rtrim(#{gydw},0)||'%'
			and  xzqhdm like rtrim(#{xzqhdm},0)||'%'
			and sbnf like #{xmnf}||'%'
 union all
 		select t2.bz v_0,lxmc v_1, decode(substr(lxbm,0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','转道') v_2 ,qdzh v_3,zdzh v_4,lxbm v_5,'' v_6,
 substr(xzqhmc,0,INSTR(xzqhmc,'市')) v_7,substr(xzqhmc,INSTR(xzqhmc,'市')+1,length(xzqhmc)-INSTR(xzqhmc,'市')) v_8,
 to_char(jsxz) v_9,to_char(decode(yjsdj,'一级公路',yhlc,0)+decode(yjsdj,'二级公路',yhlc,0)+decode(yjsdj,'三级公路',yhlc,0)+decode(yjsdj,'四级公路',yhlc,0),'FM999999.999999999') v_10,
 decode(yjsdj,'一级公路',yhlc,'0') v_11,decode(yjsdj,'二级公路',yhlc,'0') v_12,decode(yjsdj,'三级公路',yhlc,'0') v_13,
decode(yjsdj,'四级公路',yhlc,'0') v_14,to_char(decode(yjsdj,'大桥',yhlc,'0')) v_15,to_char(decode(yjsdj,'隧道',yhlc,'0')) v_16,
to_char(lmkd) v_17,to_char(SJLMLX) v_18,to_char(PFZTZ) v_19,JHSYBZJE v_20 from PLAN_LX_GCGJ lx
 left join PLAN_GCGJ t2 on lx.jhid=t2.id left join gcgl_gcgzgj gc on lx.jhid=gc.jhid where
  			gydwdm like rtrim(#{gydw},0)||'%'
			and  xzqhdm like rtrim(#{xzqhdm},0)||'%'
			and sbnf like #{xmnf}||'%'
 union all
 		select t2.REMARKS v_0,lxmc v_1, decode(substr(lxbm,0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','转道') v_2 ,qdzh v_3,zdzh v_4,lxbm v_5,'' v_6,
 substr(xzqhmc,0,INSTR(xzqhmc,'市')) v_7,substr(xzqhmc,INSTR(xzqhmc,'市')+1,length(xzqhmc)-INSTR(xzqhmc,'市')) v_8,
 to_char(jsxz) v_9,to_char((decode(yjsdj,'一级公路',xmlc,0)+decode(yjsdj,'二级公路',xmlc,0)+decode(yjsdj,'三级公路',xmlc,0)+decode(yjsdj,'四级公路',xmlc,0)),'FM999999.999999999') v_10,
 decode(yjsdj,'一级公路',xmlc,'0') v_11,decode(yjsdj,'二级公路',xmlc,'0') v_12,decode(yjsdj,'三级公路',xmlc,'0') v_13,
decode(yjsdj,'四级公路',xmlc,'0') v_14,to_char(decode(ql_m,null,'0','0.0','0',ql_m)) v_15,to_char(decode(sd_m,null,'0','0.0','0',sd_m)) v_16,
to_char(lqlm+snlm) v_17,'计划方案' v_18,to_char(PFTZ) v_19,JHSYBBZJE v_20 from PLAN_LX_GCSJ lx
 left join PLAN_GCSJ t2 on lx.jhid=t2.id left join gcgl_gcgzsj gc on lx.jhid=gc.jhid where
	 		 gydwdm like rtrim(#{gydw},0)||'%'
			and  xzqhdm like rtrim(#{xzqhdm},0)||'%'
			and jhnf like #{xmnf}||'%')
			order by v_2,v_5,v_3
	</select>
	
	<!-- qwh -->
	<select id="selectgljsxdList" parameterType="xmbb" resultType="hashmap">
	select
<!-- 		* -->
  	xmlx,decode(bz,null,' ',bz) bz,decode(xmmc,null,' ',xmmc) xmmc,decode(xzdj,null,' ',xzdj) xzdj,decode(qdzh,null,' ',qdzh) qdzh,decode(zdzh,null,' ',zdzh) zdzh,
    decode(lxbh,null,' ',lxbh) lxbh,decode(jsdj,null,' ',jsdj) jsdj,decode(tsdq,null,' ',tsdq) tsdq,decode(shi,null,' ',shi) shi,decode(xian,null,' ',xian) xian,
    decode(jsxz,null,' ',jsxz) jsxz,decode(hejgl,null,' ',hejgl) hejgl,decode(yijgl,null,' ',yijgl) yijgl,decode(erjgl,null,' ',erjgl) erjgl,decode(sanjgl,null,' ',sanjgl) sanjgl,
    decode(sijgl,null,' ',sijgl) sijgl,decode(dqiao,null,' ',dqiao) dqiao,decode(sdao,null,' ',sdao) sdao,decode(lmkd,null,' ',lmkd) lmkd,decode(jsfa,null,' ',jsfa) jsfa,
    decode(ztz,null,' ',ztz) ztz,decode(btz,null,' ',btz) btz,decode(stz,null,' ',stz) stz,decode(snhj,null,' ',snhj) snhj,decode(snbtz,null,' ',snbtz) snbtz,
    decode(bnhj,null,' ',bnhj) bnhj,decode(bnbtz,null,' ',bnbtz) bnbtz,decode(gkpfwh,null,' ',gkpfwh) gkpfwh,decode(sjpfwh,null,' ',sjpfwh) sjpfwh,decode(jhxdwh,null,' ',jhxdwh) jhxdwh
	from(	
		select '路面升级' xmlx,p.remarks bz,p.xmmc,lx2.xzdj,lx.qdzh,lx.zdzh,lx2.lxbh,lx2.jsdj,lx.tsdq,lx2.shi,lx2.xian,'路面升级' jsxz,lx1.yijgl+lx1.erjgl+lx1.sanjgl+lx1.sijgl hejgl,
			lx1.yijgl,lx1.erjgl,lx1.sanjgl,lx1.sijgl,p.ql_m dqiao,p.sd_m sdao,' ' lmkd,' ' jsfa,p.pftz ztz,p.Jhsybbzje btz,p.Jhsydfzczj stz,zj2.snhj,zj2.snbtz,zj1.bnhj,zj1.bnbtz,
			p.gksjwh gkpfwh,p.sjpfwh,zj1.jhxdwh,p.tbbm gydw,lx.xzqhdm xzqh
			from plan_gcsj p,
			(select jhid,min(xzqhmc) xzqhmc,min(xzqhdm) xzqhdm, MIN(TSDQ) TSDQ,replace(WMSYS.WM_CONCAT(to_char(QDZH)),',','、') QDZH,replace(WMSYS.WM_CONCAT(decode(substr(to_char(lxbm),0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道')),',','、') xzdj,replace(WMSYS.WM_CONCAT(to_char(lxbm)),',','、') lxbh,
			replace(WMSYS.WM_CONCAT(to_char(ZDZH)),',','、') ZDZH,replace(WMSYS.WM_CONCAT(to_char(substr(xzqhmc,0,instr(xzqhmc, '市')))),',','、') shi,replace(WMSYS.WM_CONCAT(to_char(substr(xzqhmc,instr(xzqhmc, '市')+1,instr(xzqhmc, '县')))),',','、') xian,replace(WMSYS.WM_CONCAT(to_char(plan_lx_gcsj.yjsdj)),',','、') jsdj
			from plan_lx_gcsj group by jhid) lx,
			(select jhid,sum(decode(substr(GJHJSDJ,0,1),'一'，xmlc,0)) yijgl,sum(decode(substr(GJHJSDJ,0,1),'二'，xmlc,0)) erjgl,sum(decode(substr(GJHJSDJ,0,1),'三'，xmlc,0)) sanjgl,sum(decode(substr(GJHJSDJ,0,1),'四'，xmlc,0)) sijgl from plan_gcsj,plan_lx_gcsj where plan_gcsj.id=plan_lx_gcsj.jhid
			group by jhid) lx1,
			(select jhid,replace(WMSYS.WM_CONCAT(decode(substr(to_char(t1.lxbm),0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道')),',','、') xzdj,replace(WMSYS.WM_CONCAT(to_char(t1.lxbm)),',','、') lxbh,replace(WMSYS.WM_CONCAT(to_char(substr(t1.xzqhmc,0,instr(t1.xzqhmc, '市')))),',','、') shi,replace(WMSYS.WM_CONCAT(to_char(substr(t1.xzqhmc,instr(t1.xzqhmc, '市')+1,instr(t1.xzqhmc, '县')))),',','、') xian,replace(WMSYS.WM_CONCAT(to_char(t1.yjsdj)),',','、') jsdj from (select jhid,replace(WMSYS.WM_CONCAT(distinct to_char( t.lxbm)), ',', '、')  lxbm, 
replace(WMSYS.WM_CONCAT(distinct to_char( t.xzqhmc)), ',', '、')  xzqhmc, 
replace(WMSYS.WM_CONCAT(distinct to_char( t.yjsdj)), ',', '、') yjsdj from plan_lx_gcsj t group by jhid)t1 group by t1.jhid) lx2,
			(select z.xmid,z.xdnf,sum(z.xdzj) bnhj,sum(z.btzzj) bnbtz,replace(WMSYS.WM_CONCAT(to_char(z.jhxdwh)),',','、') jhxdwh from plan_zjxd z where z.xdnf=#{sbnf} group by z.xmid,z.xdnf) zj1,
			(select z.xmid,z.xdnf,sum(z.xdzj) snhj,sum(z.btzzj) snbtz from plan_zjxd z where z.xdnf=to_char(to_number(#{sbnf})-1) group by z.xmid,z.xdnf) zj2
			where p.id=lx.jhid(+) and p.id=lx1.jhid(+) and p.id=lx2.jhid(+) and p.id= zj1.xmid(+) and p.id=zj2.xmid(+) and zj1.xdnf is not null
			union all
			select '路面改造' xmlx,p.bz bz,p.xmmc,lx2.xzdj,lx.qdzh,lx.zdzh,lx2.lxbh,lx2.jsdj,lx.tsdq,lx2.shi,lx2.xian,'路面改造' jsxz,lx1.yijgl+lx1.erjgl+lx1.sanjgl+lx1.sijgl hejgl,
			lx1.yijgl,lx1.erjgl,lx1.sanjgl,lx1.sijgl,' ' dqiao,' ' sdao,' ' lmkd,' ' jsfa,p.PFZTZ ztz,p.JHSYBZJE btz,p.JHSYDFZCJE stz,zj2.snhj,zj2.snbtz,zj1.bnhj,zj1.bnbtz,
			p.gksjwh gkpfwh,p.sjpfwh,zj1.jhxdwh,p.tbbm gydw,lx.xzqhdm xzqh
			from plan_gcgj p,
			(select jhid,min(xzqhmc) xzqhmc,min(xzqhdm) xzqhdm, MIN(TSDQ) TSDQ,replace(WMSYS.WM_CONCAT(to_char(QDZH)),',','、') QDZH,replace(WMSYS.WM_CONCAT(decode(substr(to_char(lxbm),0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道')),',','、') xzdj,replace(WMSYS.WM_CONCAT(to_char(lxbm)),',','、') lxbh,
			replace(WMSYS.WM_CONCAT(to_char(ZDZH)),',','、') ZDZH,replace(WMSYS.WM_CONCAT(to_char(substr(xzqhmc,0,instr(xzqhmc, '市')))),',','、') shi,replace(WMSYS.WM_CONCAT(to_char(substr(xzqhmc,instr(xzqhmc, '市')+1,instr(xzqhmc, '县')))),',','、') xian,replace(WMSYS.WM_CONCAT(to_char(plan_lx_gcgj.yjsdj)),',','、') jsdj
			from plan_lx_gcgj group by jhid) lx,
			(select jhid,sum(decode(substr(yjsdj,0,1),'一'，yhlc,0)) yijgl,sum(decode(substr(yjsdj,0,1),'二'，yhlc,0)) erjgl,sum(decode(substr(yjsdj,0,1),'三'，yhlc,0)) sanjgl,sum(decode(substr(yjsdj,0,1),'四'，yhlc,0)) sijgl from plan_lx_gcgj 
			group by jhid) lx1,
			(select jhid,replace(WMSYS.WM_CONCAT(decode(substr(to_char(t1.lxbm),0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道')),',','、') xzdj,replace(WMSYS.WM_CONCAT(to_char(t1.lxbm)),',','、') lxbh,replace(WMSYS.WM_CONCAT(to_char(substr(t1.xzqhmc,0,instr(t1.xzqhmc, '市')))),',','、') shi,replace(WMSYS.WM_CONCAT(to_char(substr(t1.xzqhmc,instr(t1.xzqhmc, '市')+1,instr(t1.xzqhmc, '县')))),',','、') xian,replace(WMSYS.WM_CONCAT(to_char(t1.yjsdj)),',','、') jsdj from (select jhid,replace(WMSYS.WM_CONCAT(distinct to_char( t.lxbm)), ',', '、')  lxbm, 
replace(WMSYS.WM_CONCAT(distinct to_char( t.xzqhmc)), ',', '、')  xzqhmc, 
replace(WMSYS.WM_CONCAT(distinct to_char( t.yjsdj)), ',', '、') yjsdj from plan_lx_gcgj t group by jhid)t1 group by t1.jhid) lx2,
			(select z.xmid,z.xdnf,sum(z.xdzj) bnhj,sum(z.btzzj) bnbtz,replace(WMSYS.WM_CONCAT(to_char(z.jhxdwh)),',','、') jhxdwh from plan_zjxd z where z.xdnf=#{sbnf} group by z.xmid,z.xdnf) zj1,
			(select z.xmid,z.xdnf,sum(z.xdzj) snhj,sum(z.btzzj) snbtz from plan_zjxd z where z.xdnf=to_char(to_number(#{sbnf})-1) group by z.xmid,z.xdnf) zj2
			where p.id=lx.jhid(+) and p.id=lx1.jhid(+) and p.id=lx2.jhid(+) and p.id= zj1.xmid(+) and p.id=zj2.xmid(+) and zj1.xdnf is not null
			union all
			select '水毁' xmlx,p.scbz bz,p.xmmc,lx2.xzdj,lx.qdzh,lx.zdzh,lx2.lxbh,lx2.jsdj,lx.tsdq,lx2.shi,lx2.xian,'水毁' jsxz,lx1.yijgl+lx1.erjgl+lx1.sanjgl+lx1.sijgl hejgl,
			lx1.yijgl,lx1.erjgl,lx1.sanjgl,lx1.sijgl,' ' dqiao,' ' sdao,' ' lmkd,' ' jsfa,p.PFZTZ ztz,p.JHSYBZJE btz,p.JHSYDFZCJE stz,zj2.snhj,zj2.snbtz,zj1.bnhj,zj1.bnbtz,
			p.gksjwh gkpfwh,p.sjpfwh,zj1.jhxdwh,p.tbbm gydw,lx.xzqhdm xzqh
			from plan_shuih p,
			(select jhid,min(xzqhmc) xzqhmc,min(xzqhdm) xzqhdm, MIN(TSDQ) TSDQ,replace(WMSYS.WM_CONCAT(to_char(QDZH)),',','、') QDZH,replace(WMSYS.WM_CONCAT(decode(substr(to_char(lxbm),0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道')),',','、') xzdj,replace(WMSYS.WM_CONCAT(to_char(lxbm)),',','、') lxbh,
			replace(WMSYS.WM_CONCAT(to_char(ZDZH)),',','、') ZDZH,replace(WMSYS.WM_CONCAT(to_char(substr(xzqhmc,0,instr(xzqhmc, '市')))),',','、') shi,replace(WMSYS.WM_CONCAT(to_char(substr(xzqhmc,instr(xzqhmc, '市')+1,instr(xzqhmc, '县')))),',','、') xian,replace(WMSYS.WM_CONCAT(to_char(plan_lx_shuih.yjsdj)),',','、') jsdj
			from plan_lx_shuih group by jhid) lx,
			(select jhid,sum(decode(substr(yjsdj,0,1),'一'，yhlc,0)) yijgl,sum(decode(substr(yjsdj,0,1),'二'，yhlc,0)) erjgl,sum(decode(substr(yjsdj,0,1),'三'，yhlc,0)) sanjgl,sum(decode(substr(yjsdj,0,1),'四'，yhlc,0)) sijgl from plan_lx_shuih 
			group by jhid) lx1,
			(select jhid,replace(WMSYS.WM_CONCAT(decode(substr(to_char(t1.lxbm),0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道')),',','、') xzdj,replace(WMSYS.WM_CONCAT(to_char(t1.lxbm)),',','、') lxbh,replace(WMSYS.WM_CONCAT(to_char(substr(t1.xzqhmc,0,instr(t1.xzqhmc, '市')))),',','、') shi,replace(WMSYS.WM_CONCAT(to_char(substr(t1.xzqhmc,instr(t1.xzqhmc, '市')+1,instr(t1.xzqhmc, '县')))),',','、') xian,replace(WMSYS.WM_CONCAT(to_char(t1.yjsdj)),',','、') jsdj from (select jhid,replace(WMSYS.WM_CONCAT(distinct to_char( t.lxbm)), ',', '、')  lxbm, 
replace(WMSYS.WM_CONCAT(distinct to_char( t.xzqhmc)), ',', '、')  xzqhmc, 
replace(WMSYS.WM_CONCAT(distinct to_char( t.yjsdj)), ',', '、') yjsdj from plan_lx_shuih t group by jhid)t1 group by t1.jhid) lx2,
			(select z.xmid,z.xdnf,sum(z.xdzj) bnhj,sum(z.btzzj) bnbtz,replace(WMSYS.WM_CONCAT(to_char(z.jhxdwh)),',','、') jhxdwh from plan_zjxd z where z.xdnf=#{sbnf} group by z.xmid,z.xdnf) zj1,
			(select z.xmid,z.xdnf,sum(z.xdzj) snhj,sum(z.btzzj) snbtz from plan_zjxd z where z.xdnf=to_char(to_number(#{sbnf})-1) group by z.xmid,z.xdnf) zj2
			where p.id=lx.jhid(+) and p.id=lx1.jhid(+) and p.id=lx2.jhid(+) and p.id= zj1.xmid(+) and p.id=zj2.xmid(+) and zj1.xdnf is not null
			union all
			select '养护大中修' xmlx,p.REMARKS bz,p.xmmc,lx2.xzdj,lx.qdzh,lx.zdzh,lx2.lxbh,lx2.jsdj,lx.tsdq,lx2.shi,lx2.xian,'养护大中修' jsxz,lx1.yijgl+lx1.erjgl+lx1.sanjgl+lx1.sijgl hejgl,
			lx1.yijgl,lx1.erjgl,lx1.sanjgl,lx1.sijgl,' ' dqiao,' ' sdao,lx.lmkd,lx.jsfa,p.TOTALSUBSIDYFUND ztz,p.TOTALSUBSIDYFUND btz,p.TOTALPLACEFUND stz,zj2.snhj,zj2.snbtz,zj1.bnhj,zj1.bnbtz,
			p.REPLYNUMBER gkpfwh,p.DEVISENUMBDER sjpfwh,zj1.jhxdwh,p.tbbm gydw,lx.xzqhdm xzqh
			from plan_yhdzx p,
			(select jhid,min(xzqhmc) xzqhmc,min(xzqhdm) xzqhdm, MIN(TSDQ) TSDQ,replace(WMSYS.WM_CONCAT(to_char(QDZH)),',','、') QDZH,replace(WMSYS.WM_CONCAT(decode(substr(to_char(lxbm),0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道')),',','、') xzdj,replace(WMSYS.WM_CONCAT(to_char(lxbm)),',','、') lxbh,
			replace(WMSYS.WM_CONCAT(to_char(ZDZH)),',','、') ZDZH,replace(WMSYS.WM_CONCAT(to_char(substr(xzqhmc,0,instr(xzqhmc, '市')))),',','、') shi,replace(WMSYS.WM_CONCAT(to_char(substr(xzqhmc,instr(xzqhmc, '市')+1,instr(xzqhmc, '县')))),',','、') xian,replace(WMSYS.WM_CONCAT(to_char(plan_lx_yhdzx.yjsdj)),',','、') jsdj,
			replace(WMSYS.WM_CONCAT(to_char(YLMKD)),',','、') lmkd,min(YLMHD) jsfa
			from plan_lx_yhdzx group by jhid) lx,
			(select jhid,sum(decode(substr(yjsdj,0,1),'一'，hdlc,0)) yijgl,sum(decode(substr(yjsdj,0,1),'二'，hdlc,0)) erjgl,sum(decode(substr(yjsdj,0,1),'三'，hdlc,0)) sanjgl,sum(decode(substr(yjsdj,0,1),'四'，hdlc,0)) sijgl from plan_lx_yhdzx 
			group by jhid) lx1,
			(select jhid,replace(WMSYS.WM_CONCAT(decode(substr(to_char(t1.lxbm),0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道')),',','、') xzdj,replace(WMSYS.WM_CONCAT(to_char(t1.lxbm)),',','、') lxbh,replace(WMSYS.WM_CONCAT(to_char(substr(t1.xzqhmc,0,instr(t1.xzqhmc, '市')))),',','、') shi,replace(WMSYS.WM_CONCAT(to_char(substr(t1.xzqhmc,instr(t1.xzqhmc, '市')+1,instr(t1.xzqhmc, '县')))),',','、') xian,replace(WMSYS.WM_CONCAT(to_char(t1.yjsdj)),',','、') jsdj from (select jhid,replace(WMSYS.WM_CONCAT(distinct to_char( t.lxbm)), ',', '、')  lxbm, 
replace(WMSYS.WM_CONCAT(distinct to_char( t.xzqhmc)), ',', '、')  xzqhmc, 
replace(WMSYS.WM_CONCAT(distinct to_char( t.yjsdj)), ',', '、') yjsdj from plan_lx_yhdzx t group by jhid)t1 group by t1.jhid) lx2,
			(select z.xmid,z.xdnf,sum(z.xdzj) bnhj,sum(z.btzzj) bnbtz,replace(WMSYS.WM_CONCAT(to_char(z.jhxdwh)),',','、') jhxdwh from plan_zjxd z where z.xdnf=#{sbnf} group by z.xmid,z.xdnf) zj1,
			(select z.xmid,z.xdnf,sum(z.xdzj) snhj,sum(z.btzzj) snbtz from plan_zjxd z where z.xdnf=to_char(to_number(#{sbnf})-1) group by z.xmid,z.xdnf) zj2
			where p.id=lx.jhid(+) and p.id=lx1.jhid(+) and p.id=lx2.jhid(+) and p.id= zj1.xmid(+) and p.id=zj2.xmid(+) and zj1.xdnf is not null
		)
		where 1=1
			<if test="gydw != null and  gydw != ''">
				${gydw}
			</if>
			<if test="xzqh != null and  xzqh != ''">
				${xzqh}
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
				and xmlx in(#{tiaojian})
			</if>
			order by jsxz,shi,xian,lxbh
	</select>
</mapper>