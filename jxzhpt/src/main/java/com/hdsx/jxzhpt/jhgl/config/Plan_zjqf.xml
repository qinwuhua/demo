<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.plan_zjqf">
	<select id="queryChildGydw"  parameterType="treenode" resultType="treenode">
		select * from XTGL_DEPARTMENT t where (t.parent=#{id} or t.id=#{id}) and (t.id not like '%000_' or t.id  like '%0000')  order by t.id
	</select>
	<select id="queryZjqfByGydwbm" parameterType="planzjqf" resultType="planzjqf">
		select * from plan_zjqf z where nf=#{nf} and (z.gydwbm=#{gydwbm} or z.parent=#{gydwbm})
	</select>
	<select id="queryZjqfByZjqf" parameterType="planzjqf" resultType="planzjqf">
		<if test="gydwbm=='36'">
			select z.parent,NVL(Sum(WQGZ),0) wqgz, NVL(sum(ABGC),0) abgc, NVL(sum(ZHFZ),0) zhfz, NF from plan_zjqf z where nf=#{nf} and parent=#{gydwbm} group by z.parent,nf
		</if>
		<if test="gydwbm!='36'">
			select ID, GYDWBM, PARENT, NVL(WQGZ,0) wqgz, NVL(ABGC,0) abgc, NVL(ZHFZ,0) zhfz, NF from plan_zjqf z where nf=#{nf} and z.gydwbm=#{gydwbm}
		</if>
	</select>
	<insert id="insertZjqfBatch" parameterType="planzjqf">
		insert into plan_zjqf (id,gydwbm,parent,nf,wqgz,abgc,zhfz) values
		(sys_guid(),#{gydwbm},#{parent},#{nf},#{wqgz},#{abgc},#{zhfz})
	</insert>
	<update id="updateZjqfBatch" parameterType="planzjqf">
		update plan_zjqf set wqgz=#{wqgz},abgc=#{abgc},zhfz=#{zhfz}
		where nf=#{nf} and gydwbm=#{gydwbm}
	</update>
	<select id="queryChildXzqh" parameterType="treenode" resultType="treenode">
		select * from xtgl_xzqh xt where xt.id like #{id}  order by xt.id
	</select>
</mapper>
