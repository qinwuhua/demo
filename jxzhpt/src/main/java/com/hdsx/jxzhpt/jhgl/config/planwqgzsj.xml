<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.planwqgzsj">
	<select id="selectwqjhkgl" parameterType="planwqgzsj" resultType="planwqgzsj">
			select * from (
		select rownum num ,t.*,decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报')) sbzt2 from
		 (select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1 
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
				and pddj = #{pddj}
				</if>) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="jsdj != '' and jsdj != null ">
			${jsdj}
		</if>
		<if test="gldj != '' and gldj != null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="shzt!='' and shzt!= null ">
			and decode(SPZT,0,'未审核',1,'已审核')=#{shzt}
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报')),spzt desc
	</select>
	<select id="selectwqjhkglcount" parameterType="planwqgzsj" resultType="int">
		select count(*) from 
		(select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1 
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
				and pddj = #{pddj}
				</if>) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="jsdj != '' and jsdj != null ">
			${jsdj}
		</if>
		<if test="gldj != '' and gldj != null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="shzt!='' and shzt!= null ">
			and decode(SPZT,0,'未审核',1,'已审核')=#{shzt}
		</if>
	</select>
		<select id="loadwqjhkglCount" parameterType="planwqgzsj" resultType="planwqgzsj">
		select count(*) sl,sum(pfztz) pfztz,decode(sfylrbwqk,'是',decode(sum(jhsybzje),null,0,sum(jhsybzje))) jhsybzje,sum(jhsydfzcje) jhsydfzcje,decode(sfylrbwqk,'否',decode(sum(shengbz),null,0,sum(shengbz))) shengbz from 
		(select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1 
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
				and pddj = #{pddj}
				</if>) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="jsdj != '' and jsdj != null ">
			${jsdj}
		</if>
		<if test="gldj != '' and gldj != null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="shzt!='' and shzt!= null ">
			and decode(SPZT,0,'未审核',1,'已审核')=#{shzt}
		</if>
		group by sfylrbwqk
	</select>
	<select id="loadwqgzjhkbyid" parameterType="string" resultType="planwqgzsj">
		select t.*,sc.xmkid from plan_wqgz t left join sck_wqgz sc on t.sckid=sc.sckid where id=#{value}
	</select>
	<select id="loadwqgzjhkbyid1" parameterType="string" resultType="planwqgzsj">
		select * from plan_wqgz_tz where id=#{value}
	</select>
	<select id="loadwqgzsckbyid" parameterType="string" resultType="planwqgzsj">
		select * from sck_wqgz where sckid=#{value}
	</select>
	<select id="loadwqgzxmkbyid" parameterType="string" resultType="planwqgzsj">
		select * from xmk_wqgz where id=#{value}
	</select>
	<select id="cxtiaojian" parameterType="string" resultType="planwqgzsj">
		select sc.sckid,sc.jsxz,sc.sck_qlbh,decode(p.jhqlqk,null,sc.scqlqk,0,sc.scqlqk,p.jhqlqk) scqlqk,decode(p.jhqlqc,null,sc.scqlqc,0,sc.scqlqc,p.jhqlqc) scqlqc,xm.tsdq,xm.akjfl,sc.sfylrbwqk,sc.bzls,xm.thdj,xm.xzqhmc, 
		(case when xm.xzqhdm like '3607%' then '1' else '0' end) sfgz,
		(case when xm.thdj like '%Ⅴ%'or xm.thdj like  '%Ⅵ%' or xm.thdj like  '%Ⅶ%' or xm.thdj like  '%Ⅷ%' or xm.thdj like  '%Ⅸ%' then '1' else '0' end) sfth 

		from plan_wqgz p left join sck_wqgz sc on p.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id 
		where sc.sckid=#{value}
	</select>
	<select id="cxtiaojianbyxmk" parameterType="planwqgzsj" resultType="planwqgzsj">
		select xm.qlbh sck_qlbh,#{scqlqk} scqlqk,#{scqlqc} scqlqc,xm.tsdq,#{akjfl} akjfl,xm.thdj,xm.xzqhmc, 
		(case when xm.xzqhdm like '3607%' then '1' else '0' end) sfgz,
		(case when xm.thdj like '%Ⅴ%'or xm.thdj like  '%Ⅵ%' or xm.thdj like  '%Ⅶ%' or xm.thdj like  '%Ⅷ%' or xm.thdj like  '%Ⅸ%' then '1' else '0' end) sfth 

		from xmk_wqgz xm 
		where xm.id=#{id}
	</select>
	
	<select id="selectshibz" parameterType="planwqgzsj" resultType="wqbzbz">
		select * from xtgl_wqbzbz where 1=1 and bzjb='市级'
		<if test="sck_qlbh!='' and sck_qlbh!= null ">
			and jsdj like '%'||(substr(#{sck_qlbh},0,1))||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and qllx = #{akjfl}
		</if>
		<if test="jsxz!='' anand jhjsxz null ">
			and jsxz = #{jsxz}
		</if>
	</select>
	<select id="selectshengbz" parameterType="planwqgzsj" resultType="wqbzbz">
		select * from xtgl_wqbzbz where 1=1 and bzjb='省级'
		<if test="sck_qlbh!='' and sck_qlbh!= null ">
			and jsdj like '%'||(substr(#{sck_qlbh},0,1))||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and qllx = #{akjfl}
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz = #{jsxz}
		</if>
	</select>
	<update id="editwqgzsj" parameterType="planwqgzsj">
		update plan_wqgz set sbnf=#{sbnf}
		<if test="jhkgsj!=null">,jhkgsj=#{jhkgsj}</if>
		<if test="jhwgsj!=null">,jhwgsj=#{jhwgsj}</if>
		<if test="sjdw!=null">,sjdw=#{sjdw}</if>
		<if test="sjpfdw!=null">,sjpfdw=#{sjpfdw}</if>
		<if test="pfwh!=null">,pfwh=#{pfwh}</if>
		<if test="pfsj!=null">,pfsj=#{pfsj}</if>
		<if test="sfsqablbz!=null">,sfsqablbz=#{sfsqablbz}</if>
		<if test="ablbzsqwh!=null">,ablbzsqwh=#{ablbzsqwh}</if>
		<if test="pfztz!=null">,pfztz=#{pfztz}</if>
		<if test="shengbz!=null">,shengbz=#{shengbz}</if>
		<if test="jhsybzje!=null">,jhsybzje=#{jhsybzje}</if>
		<if test="jhsydfzcje!=null">,jhsydfzcje=#{jhsydfzcje}</if>
		<if test="qlszxz!=null">,qlszxz=#{qlszxz}</if>
		<if test="zyjsnr!=null">,zyjsnr=#{zyjsnr}</if>
		<if test="sfylrbwqk!=null">,sfylrbwqk=#{sfylrbwqk}</if>
		<if test="bz!=null">,bz=#{bz}</if>
		<if test="jhqlqc!=null">,jhqlqc=#{jhqlqc}</if>
		<if test="jhqlqk!=null">,jhqlqk=#{jhqlqk}</if>
		<if test="jhjsxz!=null">,jhjsxz=#{jhjsxz}</if>
		<if test="nsqsjl != null">,nsqsjl=#{nsqsjl}</if>
		<if test="shijbz != null">,shijbz=#{shijbz}</if>
		<if test="xianjbz != null">,xianjbz=#{xianjbz}</if>
		where id=#{id}
	</update>
	<update id="editwqgzsj1" parameterType="planwqgzsj">
		update plan_wqgz set sbnf=#{sbnf}
		<if test="jhkgsj!=null">,jhkgsj=#{jhkgsj}</if>
		<if test="jhwgsj!=null">,jhwgsj=#{jhwgsj}</if>
		<if test="sjdw!=null">,sjdw=#{sjdw}</if>
		<if test="sjpfdw!=null">,sjpfdw=#{sjpfdw}</if>
		<if test="pfwh!=null">,pfwh=#{pfwh}</if>
		<if test="pfsj!=null">,pfsj=#{pfsj}</if>
		<if test="sfsqablbz!=null">,sfsqablbz=#{sfsqablbz}</if>
		<if test="ablbzsqwh!=null">,ablbzsqwh=#{ablbzsqwh}</if>
		<if test="pfztz!=null">,pfztz=#{pfztz}</if>
		<if test="shengbz!=null">,jhsybzje=#{shengbz}</if>
		<if test="jhsydfzcje!=null">,jhsydfzcje=#{jhsydfzcje}</if>
		<if test="qlszxz!=null">,qlszxz=#{qlszxz}</if>
		<if test="zyjsnr!=null">,zyjsnr=#{zyjsnr}</if>
		<if test="sfylrbwqk!=null">,sfylrbwqk=#{sfylrbwqk}</if>
		<if test="bz!=null">,bz=#{bz}</if>
		<if test="jhqlqc!=null">,jhqlqc=#{jhqlqc}</if>
		<if test="jhqlqk!=null">,jhqlqk=#{jhqlqk}</if>
		where id=#{id}
	</update>
	<select id="selectwqjhksb" parameterType="planwqgzsj" resultType="planwqgzsj">
			select * from (
		select rownum num ,t.*,decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报')) sbzt2 from
		 (select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id 
		 left join (select xmid,replace(WMSYS.WM_CONCAT(jhxdwh),',',',') jhxdwh from plan_zjxd group by xmid) xd on t.id=xd.xmid
		 where 1=1
					and t.jh_sbthcd>=#{sbthcd} 
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				<if test="jhxdwh!='' and jhxdwh!= null ">
					${jhxdwh}
				</if>
		) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="shzt == '已审核'">
			and spzt='1'
			</if>
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报')),spzt desc
	</select>
	<select id="selectwqjhexcel" parameterType="planwqgzsj" resultType="elist">
	select  t.shzt v_1,t.sfylsjl v_2,t.sfylrbwqk v_3,t.sbnf v_4,t.jhkgsj v_5,t.jhwgsj v_6,
	xm.gydw v_7,xm.xzqhmc v_8,xm.lxbm v_9,xm.lxmc v_10,xm.qlbh v_11,xm.qlmc v_12,t.pfztz v_13
	from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1 and gydwbm like '1%'
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<!-- <if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if> -->
		<if test="pddj!='' and pddj!= null ">
			and pddj = #{jsdj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(t.SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="shzt!='' and shzt!= null ">
			and decode(SPZT,0,'未审核',1,'已审核')=#{shzt}
		</if>
		order by v_8
	</select>
	<select id="selectwqjhksbcount" parameterType="planwqgzsj" resultType="int">
		select count(*) from 
		(select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id
		  left join (select xmid,replace(WMSYS.WM_CONCAT(jhxdwh),',',',') jhxdwh from plan_zjxd group by xmid) xd on t.id=xd.xmid
		 where 1=1
					and t.jh_sbthcd>=#{sbthcd} 
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				<if test="jhxdwh!='' and jhxdwh!= null ">
					${jhxdwh}
				</if>
		) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="shzt == '已审核'">
			and spzt='1'
			</if>
		</if>
	</select>
	<select id="loadwqjhksbCount" parameterType="planwqgzsj" resultType="planwqgzsj">
		select count(*) sl,sum(pfztz) pfztz,decode(sfylrbwqk,'是',decode(sum(jhsybzje),null,0,sum(jhsybzje))) jhsybzje,sum(jhsydfzcje) jhsydfzcje,decode(sfylrbwqk,'否',decode(sum(shengbz),null,0,sum(shengbz))) shengbz,decode(sum(xdzj),null,0,sum(xdzj)) xdzj from 
		(select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm,z.xdzj, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t left join plan_zjxd z on t.id=z.xmid join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id 
		  left join (select xmid,replace(WMSYS.WM_CONCAT(jhxdwh),',',',') jhxdwh from plan_zjxd group by xmid) xd on t.id=xd.xmid
		 where 1=1
					and t.jh_sbthcd>=#{sbthcd} 
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				<if test="jhxdwh!='' and jhxdwh!= null ">
					${jhxdwh}
				</if>
		) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="shzt == '已审核'">
			and spzt='1'
			</if>
		</if>
		group by sfylrbwqk
	</select>
	
		<select id="selectwqjhksb1" parameterType="planwqgzsj" resultType="planwqgzsj">
			select * from (
		select rownum num ,t.*,decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报')) sbzt2 from
		 (select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1
		 		<if test="sbthcd>=4 ">
 					and (t.jh_sbthcd>=#{sbthcd} or shyj is not null) 
 				</if>
		  		<if test="sbthcd &lt; 4 ">
					and t.jh_sbthcd>=#{sbthcd} 
				</if>
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="qlbh!=null and qlbh!=''">
			and qlbh like '%'||#{qlbh}||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报')),spzt desc
	</select>
	<select id="selectwqjhksbcount1" parameterType="planwqgzsj" resultType="int">
		select count(*) from 
		(select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1
		 		<if test="sbthcd>=4 ">
 					and (t.jh_sbthcd>=#{sbthcd} or shyj is not null) 
 				</if>
		  		<if test="sbthcd &lt; 4 ">
					and t.jh_sbthcd>=#{sbthcd} 
				</if>
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="qlbh!=null and qlbh!=''">
			and qlbh like '%'||#{qlbh}||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
	</select>
	<select id="loadwqjhksbCount11" parameterType="planwqgzsj" resultType="planwqgzsj">
		select count(*) sl,sum(pfztz) pfztz,decode(sfylrbwqk,'是',decode(sum(jhsybzje),null,0,sum(jhsybzje))) jhsybzje,sum(jhsydfzcje) jhsydfzcje,decode(sfylrbwqk,'否',decode(sum(shengbz),null,0,sum(shengbz))) shengbz,decode(sum(xdzj),null,0,sum(xdzj)) xdzj from 
		(select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm,z.xdzj,  
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t left join plan_zjxd z on t.id=z.xmid join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1
		 		<if test="sbthcd>=4 ">
 					and (t.jh_sbthcd>=#{sbthcd} or shyj is not null) 
 				</if>
		  		<if test="sbthcd &lt; 4 ">
					and t.jh_sbthcd>=#{sbthcd} 
				</if>
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="qlbh!=null and qlbh!=''">
			and qlbh like '%'||#{qlbh}||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		group by sfylrbwqk
	</select>
	
	<select id="loadwqjhksbCount1" parameterType="planwqgzsj" resultType="planwqgzsj">
		select count(*) sl,sum(pfztz) pfztz,decode(sfylrbwqk,'是',decode(sum(jhsybzje),null,0,sum(jhsybzje))) jhsybzje,sum(jhsydfzcje) jhsydfzcje,decode(sfylrbwqk,'否',decode(sum(shengbz),null,0,sum(shengbz))) shengbz,decode(sum(xdzj),null,0,sum(xdzj)) xdzj from 
		(select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm,z.xdzj,  
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t left join plan_zjxd z on t.id=z.xmid join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1
		 		<if test="sbthcd>=4 ">
 					and (t.jh_sbthcd>=#{sbthcd} or shyj is not null) 
 				</if>
		  		<if test="sbthcd &lt; 4 ">
					and t.jh_sbthcd>=#{sbthcd} 
				</if>
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="qlbh!=null and qlbh!=''">
			and qlbh like '%'||#{qlbh}||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		group by sfylrbwqk
	</select>
	
	<select id="selectwqjhksb11" parameterType="planwqgzsj" resultType="planwqgzsj">
			select * from (
		select rownum num ,t.*,decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报')) sbzt2 from
		 (select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1
		 		<if test="sbthcd>=4 ">
 					and (t.jh_sbthcd>=#{sbthcd} or shyj is not null) 
 				</if>
		  		<if test="sbthcd &lt; 4 ">
					and t.jh_sbthcd>=#{sbthcd} 
				</if>
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="qlbh!=null and qlbh!=''">
			and qlbh like '%'||#{qlbh}||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报')),spzt desc
	</select>
	<select id="selectwqjhksbcount11" parameterType="planwqgzsj" resultType="int">
		select count(*) from 
		(select t.*,xm.xzqhdm,xm.gydwbm,xm.lxmc,xm.qlmc,xm.jsdj,xm.akjfl,xm.lxbm, 
		 xm.xzqhmc,xm.gydw,xm.qlbh,xm.tsdq,sc.sck_qlbh,sc.sck_qlzxzh
		 from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1
		 		<if test="sbthcd>=4 ">
 					and (t.jh_sbthcd>=#{sbthcd} or shyj is not null) 
 				</if>
		  		<if test="sbthcd &lt; 4 ">
					and t.jh_sbthcd>=#{sbthcd} 
				</if>
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="pddj!='' and pddj!= null ">
					and pddj = #{pddj}
				</if>
				) t where 1=1 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="qlbh!=null and qlbh!=''">
			and qlbh like '%'||#{qlbh}||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
	</select>
	
	
	
	<update id="sbWqgzjh" parameterType="hashmap">
		update plan_wqgz set sbzt='1',sbsj=sysdate,sbbm=#{sbbm},jh_sbthcd=#{sbthcd}
		where id=#{id}
	</update>
	<update id="shtyWqgzsbById" parameterType="planwqgzsj">
		update plan_wqgz set sbzt='1',sbsj=sysdate,sbbm=#{sbbm},jh_sbthcd=#{sbthcd},shzt1='已审核',shyj1='同意'
		where id=#{id}
	</update>
	<update id="shbtyWqgzsbById" parameterType="planwqgzsj">
		update plan_wqgz set sbzt='0',sbsj=sysdate,sbbm=#{sbbm},jh_sbthcd=#{sbthcd},shzt1='未审核',shyj1=#{shyj1}
		where id=#{id}
	</update>
	<update id="shtyWqgzshById" parameterType="planwqgzsj">
		update plan_wqgz set spzt='1',spsj=sysdate,spbm=#{sbbm},jh_sbthcd=#{sbthcd},shzt='已审核',shyj='同意'
		where id=#{id}
	</update>
	<update id="shbtyWqgzshById" parameterType="planwqgzsj">
		update plan_wqgz set spzt='0',spsj=sysdate,spbm=#{sbbm},jh_sbthcd=#{sbthcd},shzt='未审核',shyj=#{shyj1}
		where id=#{id}
	</update>
	<select id="dcwqgzsjjhExcel" parameterType="planwqgzsj" resultType="elist">
	select xm.sqs v_1,xm.xsq v_2,xm.szxz v_3,xm.qlmc v_4,xm.qlbh v_5,xm.lxbm v_6,xm.lxmc v_7,decode(substr(xm.lxbm,0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道') v_8,xm.jsdj v_9,xm.qlzxzh v_10,xm.xjgjnd v_11,xm.qlqc v_12,xm.akjfl v_13,xm.synf v_14,xm.kjzc v_15,xm.dkzdkj v_16,xm.sjhspl v_17,xm.qxjkuan v_18,xm.qxjkong v_19,xm.zqks v_20,xm.qmjk v_21,xm.kydwlx v_22,xm.thdj v_23,xm.glqlyt v_24,xm.sbjgxs v_25,xm.qdlx v_26,xm.qtlx v_27,xm.pzlx v_28,xm.pddj v_29,xm.xmnf v_30,xm.qlyhgcs v_31,xm.qljggcs v_32,sc.scqlqk v_33,sc.scqlqk v_34,sc.scxmnf v_35,sc.fapgdw v_36,sc.fascdw v_37,sc.faspsj v_38,sc.spwh v_39,sc.jsxz v_40,sc.tzgs v_41,sc.sjdwmc v_42,sc.hzdj v_43,sc.scsjhspl v_44,sc.kjzh v_45,sc.sck_sbjgxs v_46,sc.sck_xbjgxs v_47,sc.sgtpfsj v_48,sc.pfwh v_49,sc.zgq v_50,sc.rksj v_51,sc.cjqz v_52,sc.scthdj v_53,sc.qljc v_54,sc.ydgldj v_55,sc.sjsd v_56,sc.ztz v_57,sc.nsqbbz v_58,t.jhqlqc v_59,t.jhqlqk v_60,t.sbnf v_61,t.jhkgsj v_62,t.jhwgsj v_63,t.sjdw v_64,t.sjpfdw v_65,t.pfwh v_66,t.pfsj v_67,t.sfsqablbz v_68,t.ablbzsqwh v_69,t.pfztz v_70,decode(t.sfylrbwqk,'是',t.jhsybzje,'否',t.shengbz) v_71,t.jhsydfzcje v_72,t.bz v_73
	from plan_wqgz t join sck_wqgz sc on t.sckid=sc.sckid join xmk_wqgz xm on xmkid=xm.id where 1=1 and gydwbm like '1%'
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="pddj!='' and pddj!= null ">
			and pddj = #{jsdj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		order by xm.xzqhdm
	</select>
	<select id="dcwqgzsjjhshExcel3" parameterType="planwqgzsj" resultType="elist">
	select 
	sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,sc.sck_qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,
	pl.jhjsxz v_8,pl.zyjsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'否',pl.shengbz,pl.jhsybzje) v_11,
	pl.jhsydfzcje v_12,pl.jhkgsj v_13,pl.jhwgsj v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,
	pl.pfwh v_18,pl.bz v_19,substr(xm.xzqhdm,0,4)||'00' v_30,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') xzqhmc
	from plan_wqgz pl,sck_wqgz sc,xmk_wqgz xm 
	where pl.sckid=sc.sckid and sc.xmkid=xm.id and xm.gydwbm like '1%'
		<if test="sbthcd>=4 ">
			and (pl.jh_sbthcd>=#{sbthcd} or shyj is not null) 
			</if>
			<if test="sbthcd &lt; 4 ">
			and pl.jh_sbthcd>=#{sbthcd} 
			</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="pddj!='' and pddj!= null ">
			and pddj = #{jsdj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		order by v_30
	</select>
	<select id="dcwqgzsjjhshExcel2" parameterType="planwqgzsj" resultType="elist"> 
	select t.xzqhmc||'小计' v_1,' ' v_4,count(*) v_5,sum(v_6) v_6,sum(v_10) v_10,sum(v_11) v_11,sum(v_12) v_12,t.xzqhdm v_30
	from (
		select 
		sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,sc.sck_qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,
		pl.jhjsxz v_8,pl.zyjsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'否',pl.shengbz,pl.jhsybzje) v_11,
		pl.jhsydfzcje v_12,pl.jhkgsj v_13,pl.jhwgsj v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,
		pl.pfwh v_18,pl.bz v_19,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') xzqhmc
		from plan_wqgz pl,sck_wqgz sc,xmk_wqgz xm 
		where pl.sckid=sc.sckid and sc.xmkid=xm.id and xm.gydwbm like '1%'
		<if test="sbthcd>=4 ">
			and (pl.jh_sbthcd>=#{sbthcd} or shyj is not null) 
			</if>
			<if test="sbthcd &lt; 4 ">
			and pl.jh_sbthcd>=#{sbthcd} 
			</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="pddj!='' and pddj!= null ">
			and pddj = #{jsdj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		) t group by t.xzqhmc,t.xzqhdm order by xzqhdm
	
	</select>
	<select id="dcwqgzsjjhshExcel1" parameterType="planwqgzsj" resultType="elist"> 
	select '全省合计' v_1,' ' v_4,count(*) v_5,sum(v_6) v_6,sum(v_10) v_10,sum(v_11) v_11,sum(v_12) v_12
	from (
		select 
		sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,sc.sck_qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,
		pl.jhjsxz v_8,pl.zyjsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'否',pl.shengbz,pl.jhsybzje) v_11,
		pl.jhsydfzcje v_12,pl.jhkgsj v_13,pl.jhwgsj v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,
		pl.pfwh v_18,pl.bz v_19,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') xzqhmc
		from plan_wqgz pl,sck_wqgz sc,xmk_wqgz xm 
		where pl.sckid=sc.sckid and sc.xmkid=xm.id and xm.gydwbm like '1%'
		<if test="sbthcd>=4 ">
			and (pl.jh_sbthcd>=#{sbthcd} or shyj is not null) 
			</if>
			<if test="sbthcd &lt; 4 ">
			and pl.jh_sbthcd>=#{sbthcd} 
			</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="pddj!='' and pddj!= null ">
			and pddj = #{jsdj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>

		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		) t  order by xzqhdm
	
	</select>
	
	<select id="dcwqgzsjjhshExcel6" parameterType="planwqgzsj" resultType="elist">
	select 
	sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,sc.sck_qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,
	pl.jhjsxz v_8,pl.zyjsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'否',pl.shengbz,pl.jhsybzje) v_11,
	pl.jhsydfzcje v_12,pl.jhkgsj v_13,pl.jhwgsj v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,
	pl.pfwh v_18,pl.bz v_19,substr(xm.xzqhdm,0,4)||'00' v_30,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') xzqhmc
	from plan_wqgz_tz pl,sck_wqgz sc,xmk_wqgz xm 
	where pl.sckid=sc.sckid and sc.xmkid=xm.id and xm.gydwbm like '1%'
		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="pddj!='' and pddj!= null ">
			and pddj = #{jsdj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		order by v_30
	</select>
	<select id="dcwqgzsjjhshExcel5" parameterType="planwqgzsj" resultType="elist"> 
	select t.xzqhmc||'小计' v_1,' ' v_4,count(*) v_5,sum(v_6) v_6,sum(v_10) v_10,sum(v_11) v_11,sum(v_12) v_12,t.xzqhdm v_30
	from (
		select 
		sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,sc.sck_qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,
		pl.jhjsxz v_8,pl.zyjsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'否',pl.shengbz,pl.jhsybzje) v_11,
		pl.jhsydfzcje v_12,pl.jhkgsj v_13,pl.jhwgsj v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,
		pl.pfwh v_18,pl.bz v_19,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') xzqhmc
		from plan_wqgz_tz pl,sck_wqgz sc,xmk_wqgz xm 
		where pl.sckid=sc.sckid and sc.xmkid=xm.id and xm.gydwbm like '1%'
		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="pddj!='' and pddj!= null ">
			and pddj = #{jsdj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		) t group by t.xzqhmc,t.xzqhdm order by xzqhdm
	
	</select>
	<select id="dcwqgzsjjhshExcel4" parameterType="planwqgzsj" resultType="elist"> 
	select '全省合计' v_1,' ' v_4,count(*) v_5,sum(v_6) v_6,sum(v_10) v_10,sum(v_11) v_11,sum(v_12) v_12
	from (
		select 
		sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,sc.sck_qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,
		pl.jhjsxz v_8,pl.zyjsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'否',pl.shengbz,pl.jhsybzje) v_11,
		pl.jhsydfzcje v_12,pl.jhkgsj v_13,pl.jhwgsj v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,
		pl.pfwh v_18,pl.bz v_19,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') xzqhmc
		from plan_wqgz_tz pl,sck_wqgz sc,xmk_wqgz xm 
		where pl.sckid=sc.sckid and sc.xmkid=xm.id and xm.gydwbm like '1%'
		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jhjsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="pddj!='' and pddj!= null ">
			and pddj = #{jsdj}
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="sfylsjl!='' and sfylsjl!= null ">
 			and sfylsjl like #{sfylsjl}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like (#{lxbm})||'%'
		</if>
		<if test="sbnf!='' and sbnf!= null ">
			and sbnf in (${sbnf})
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(JH_SBTHCD,#{sbthcd},'未上报',decode(SBZT,0,'未上报',1,'已上报'))=#{sbzt}
		</if>
		<if test="jhzt !='' and jhzt != null ">
			<if test="jhzt == '未审核'">
			and spzt='0' and jh_sbthcd='4'
			</if>
			<if test="jhzt == '已审核'">
			and (spzt = '1' or (shyj is not null and jh_sbthcd=2))
			</if>
			<if test="jhzt == '审核不通过'">
			and shyj != '同意' and jh_sbthcd='2'
			</if>
			<if test="jhzt == '审核通过'">
			and spzt='1'
			</if>
		</if>
		) t order by xzqhdm
	
	</select>
	
	
	
	<update id="tuihuiWqgzsjById" parameterType="java.util.List">
		 	update plan_wqgz set spzt='0' where id=#{String}
	 </update>
	 <update id="tzxzyb" parameterType="planwqgzsj">
		 	update plan_wqgz set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where id=#{id}
	 </update>
	 <insert id="tzxztj" parameterType="planwqgzsj">
	 	insert into plan_wqgz_tz select * from plan_wqgz where id=#{id}
	 </insert>
	 <delete id="qxtzxz" parameterType="planwqgzsj">
	 	delete from  plan_wqgz where id=#{id}
	 </delete>
	 <select id="querytzbyid" parameterType="planwqgzsj" resultType="planwqgzsj">
	 	select * from plan_wqgz_tz where id=#{id}
	 </select>
	 <update id="tzxzxg" parameterType="planwqgzsj" >
	 	update plan_wqgz_tz set tzxz=#{tzxz} where id=#{id}
	 </update>
	  <insert id="thtz" parameterType="planwqgzsj">
	 	insert into plan_wqgz select * from plan_wqgz_tz where id=#{id}
	 </insert>
	 <delete id="thtzxjhb" parameterType="planwqgzsj">
	 	delete from  plan_wqgz_tz where id=#{id}
	 </delete>
	 
	 
	 <select id="cxwqjlbz" parameterType="planwqgzsj" resultType="wqbzbz">
	 	select (
	 	case when #{sfgz}='1' and #{sfth}='1' and qk is null then ((to_number(jlzj)+200)*to_number(#{scqlqc})*to_number(#{scqlqk}))/10000
	 	 when #{sfgz}='1' and #{sfth}='1' and qk is not null and to_number(#{scqlqk})&lt;=to_number(qk) then ((to_number(jlzj)+200)*to_number(#{scqlqc})*to_number(#{scqlqk}))/10000
	 	 when #{sfgz}='1' and #{sfth}='1' and qk is not null and to_number(#{scqlqk})>to_number(qk) then ((to_number(jlzj)+200)*to_number(#{scqlqc})*to_number(qk))/10000
	 	
	 	 when #{sfgz}='1' and #{sfth}='0' and qk is null then ((to_number(jlzj)+100)*to_number(#{scqlqc})*to_number(#{scqlqk}))/10000
	 	 when #{sfgz}='1' and #{sfth}='0' and qk is not null and to_number(#{scqlqk})&lt;=to_number(qk) then ((to_number(jlzj)+100)*to_number(#{scqlqc})*to_number(#{scqlqk}))/10000
	 	 when #{sfgz}='1' and #{sfth}='0' and qk is not null and to_number(#{scqlqk})>to_number(qk) then ((to_number(jlzj)+100)*to_number(#{scqlqc})*to_number(qk))/10000
	 	
	 	 when #{sfgz}='0' and #{sfth}='1' and qk is null then ((to_number(jlzj)+100)*to_number(#{scqlqc})*to_number(#{scqlqk}))/10000
	 	 when #{sfgz}='0' and #{sfth}='1' and qk is not null and to_number(#{scqlqk})&lt;=to_number(qk) then ((to_number(jlzj)+100)*to_number(#{scqlqc})*to_number(#{scqlqk}))/10000
	 	 when #{sfgz}='0' and #{sfth}='1' and qk is not null and to_number(#{scqlqk})>to_number(qk) then ((to_number(jlzj)+100)*to_number(#{scqlqc})*to_number(qk))/10000
	 	
	 	 when #{sfgz}='0' and #{sfth}='0' and qk is null then (to_number(jlzj)*to_number(#{scqlqc})*to_number(#{scqlqk}))/10000
	 	 when #{sfgz}='0' and #{sfth}='0' and qk is not null and to_number(#{scqlqk})&lt;=to_number(qk) then (to_number(jlzj)*to_number(#{scqlqc})*to_number(#{scqlqk}))/10000
	 	 when #{sfgz}='0' and #{sfth}='0' and qk is not null and to_number(#{scqlqk})>to_number(qk) then (to_number(jlzj)*to_number(#{scqlqc})*to_number(qk))/10000
	 	
	 	 else 0 end
	 	) jlzj from xtgl_wqjlbz where qllx like #{akjfl}
	 	and to_number(minqc)&lt;=#{scqlqc} and to_number(maxqc)>=#{scqlqc} 
	 	<if test="sck_qlbh!='' and sck_qlbh!= null ">
			and jsdj like '%'||(substr(#{sck_qlbh},0,1))||'%'
		</if>
		
	 </select>
</mapper>
