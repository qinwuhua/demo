<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.jckwqgzsj">
	<delete id="deleteqlzpbyxmbm" parameterType="jckwqgzsj">
		delete from plan_upload where parentid=#{id}
	</delete>
	<insert id="insertWqgz" parameterType="jckwqgzsj">
		insert into xmk_wqgz(id,qlmc,qlbh,xzqhmc,xzqhdm,lxmc,lxbm,gydw,gydwbm,xjgjnd,jsdj,pddj,qlzxzh,qlkd,qlqc,
		kjzc,dkzdkj,akjfl,sbjgxs,bhnr,bz,tbbmbm,xmnf,xmtype,tbsj,sbzt,sbthcd,tsdq,qlyhgcs,qljggcs,czyjhjy,
		ptx,pty,sqs,xsq,szxz,synf,sjhspl,qxjkuan,qxjkong,zqks,qmjk,kydwlx,thdj,glqlyt,qdlx,qtlx,pzlx,sfylrbwqk,xlxbm,xlxmc,xqlbm,xzxzh,xxcsj<if test="xqlmc != null">,xqlmc</if>) 
		values(#{id},#{qlmc},#{qlbh},#{xzqhmc},#{xzqhdm},#{lxmc},#{lxbm},#{gydw},
		(select id from xtgl_department where name=#{gydw}),#{xjgjnd},#{jsdj},
		#{pddj},#{qlzxzh},#{qlkd},#{qlqc},#{kjzc},#{dkzdkj},#{akjfl},#{sbjgxs},#{bhnr},#{bz},#{tbbmbm},#{xmnf},#{xmtype},
		sysdate,'未上报',#{sbthcd},#{tsdq},#{qlyhgcs},#{qljggcs},#{czyjhjy},
		#{ptx},#{pty},#{sqs},#{xsq},#{szxz},#{synf},#{sjhspl},#{qxjkuan},#{qxjkong},#{zqks},#{qmjk},#{kydwlx},#{thdj},#{glqlyt},#{qdlx},#{qtlx},#{pzlx},#{sfylrbwqk},#{xlxbm},#{xlxmc},#{xqlbm},#{xzxzh},'是'<if test="xqlmc != null">,#{xqlmc}</if>)
	</insert>
	
		<select id="selectWqgzList" parameterType="jckwqgzsj" resultType="jckwqgzsj">
	 	select * from (
	 		select rownum num ,t.*,decode(sbthcd,#{sbthcd},'未上报',sbzt) sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t 
	 		left join (select count(*) jhsl,a3.id from plan_wqgz a1 left join sck_wqgz a2 on a1.sckid=a2.sckid left join xmk_wqgz a3 on a2.xmkid=a3.id group by a3.id) t1
	 			on t.id=t1.id
	 			where 1=1 
	 			and  sbthcd &lt;=#{sbthcd} and gydwbm like '1%' and xxcsj='是' and sfsc is null
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqhdm!='' and xzqhdm!= null ">
				${xzqhdm}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="qlmc!='' and qlmc!= null ">
	 			and qlmc like '%'||(#{qlmc})||'%'
	 		</if>
	 		<if test="xmnf!='' and xmnf!= null ">
	 			and xmnf in (${xmnf})
	 		</if>
	 		<if test="xmtype!='' and xmtype!= null ">
	 			and xmtype like '%'||(#{xmtype})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 			</if> 
	 		<if test="akjfl!='' and akjfl!= null ">
	 			${akjfl}
	 		</if>
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="qlbh!='' and qlbh!= null ">
	 			and qlbh like '%'||(#{qlbh})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 				and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
	 		</if>
	 		<if test="gldj != '' and gldj != null ">
	 			${gldj}
	 		</if>
	 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
	 			order by decode(sbthcd,#{sbthcd},'未上报',sbzt),shzt desc 
	 </select>
	 <select id="dcwqgzsjjhExcel" parameterType="jckwqgzsj" resultType="elist">
	 	select 
      sqs v_1,xsq v_2,szxz v_3,xzqhdm v_4,qlmc v_5,xlxbm v_6,xlxmc v_7,xqlbm v_8,xzxzh v_9,qlbh v_10,lxbm v_11,lxmc v_12,decode(substr(lxbm,0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道') v_13,
      decode(substr(jsdj,0,1),'一','一级','二','二级','三','三级','四','四级','五','五级') v_14,qlzxzh v_15,ptx v_16,pty v_17,xjgjnd v_18,
      qlqc v_19,akjfl v_20,synf v_21,jsdj v_22,kjzc v_23,dkzdkj v_24,sjhspl v_25,qxjkuan v_26,qxjkong v_27,zqks v_28,
      qlkd v_29,qmjk v_30,kydwlx v_31,thdj v_32,glqlyt v_33,sbjgxs v_34,qdlx v_35,qtlx v_36,pzlx v_37,bhnr v_38,pddj v_39,bz v_40,sfylrbwqk v_41
	 	 from (
	 		select rownum num ,t.*,decode(sbthcd,#{sbthcd},'未上报',sbzt) sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where 1=1 
	 			and  sbthcd &lt;=#{sbthcd} and gydwbm like '1%'  and xxcsj='是'
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqhdm!='' and xzqhdm!= null ">
				${xzqhdm}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="qlmc!='' and qlmc!= null ">
	 			and qlmc like '%'||(#{qlmc})||'%'
	 		</if>
	 		<if test="xmnf!='' and xmnf!= null ">
	 			and xmnf in (${xmnf})
	 		</if>
	 		<if test="xmtype!='' and xmtype!= null ">
	 			and xmtype like '%'||(#{xmtype})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 			</if> 
	 		<if test="akjfl!='' and akjfl!= null ">
	 			${akjfl}
	 		</if>
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="qlbh!='' and qlbh!= null ">
	 			and qlbh like '%'||(#{qlbh})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 				and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
	 		</if>
	 		<if test="gldj != '' and gldj != null ">
	 			${gldj}
	 		</if>) order by v_4
	 			
	 </select>
	 
	  <select id="selectWqgzCount" parameterType="jckwqgzsj" resultType="int">
	 		select count(*) from xmk_wqgz t
	 		left join (select count(*) jhsl,a3.id from plan_wqgz a1 left join sck_wqgz a2 on a1.sckid=a2.sckid left join xmk_wqgz a3 on a2.xmkid=a3.id group by a3.id) t1
	 			on t.id=t1.id where 1=1 
	 			and  sbthcd &lt;=#{sbthcd} and gydwbm like '1%'  and xxcsj='是' and sfsc is null
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqhdm!='' and xzqhdm!= null ">
				${xzqhdm}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="qlmc!='' and qlmc!= null ">
	 			and qlmc like '%'||(#{qlmc})||'%'
	 		</if>
	 		<if test="xmnf!='' and xmnf!= null ">
	 			and xmnf in (${xmnf})
	 		</if>
	 		<if test="xmtype!='' and xmtype!= null ">
	 			and xmtype like '%'||(#{xmtype})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 			</if> 
	 		<if test="akjfl!='' and akjfl!= null ">
	 			${akjfl}
	 		</if>
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="qlbh!='' and qlbh!= null ">
	 			and qlbh like '%'||(#{qlbh})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 				and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
	 		</if>
	 		<if test="gldj != '' and gldj != null ">
	 			${gldj}
	 		</if>
		 </select>
		 <delete id="deleteWqgzsjById" parameterType="java.util.List" >
		 	delete from xmk_wqgz where id =#{String}
		 </delete>

		 <update id="tuihuiWqgzsjById" parameterType="java.util.List">
		 	update xmk_wqgz set shzt='未审核' where id=#{String}
		 </update>
		
		  <update id="tuihuiWqgzsjsckById" parameterType="java.util.List">
		 	update sck_wqgz set sck_shzt='未审核' where sckid=#{String}
		 </update>
		  <update id="tuihuiWqgzsjsckByIdjh" parameterType="java.util.List">
		 	delete from plan_wqgz where sckid=#{String}
		 </update>
		  <update id="tuihuiAfsckById" parameterType="java.util.List">
		 	update SCK_AQSMFH set shzt='未审核',shyj='' where id=#{String}
		 </update>
		 <select id="getwqgzZP1" resultType="plan_upload" parameterType="jckwqgzsj">
		 	select id from plan_upload where parentid=#{id} and filetype='桥梁正面文件'
		 </select>
		 <select id="getwqgzZP2" resultType="plan_upload" parameterType="jckwqgzsj">
		 	select id from plan_upload where parentid=#{id} and filetype='桥梁侧面文件'
		 </select>
		 <update id="xgJckwqgzSbzt" parameterType="hashmap" >
 			update xmk_wqgz set sbzt='已上报',sbsj=sysdate,sbbm=#{sbbm},sbthcd=#{sbthcd} where id =#{id}
 		</update>
 		<update id="sjshbtyWqgzsjByIdbeatch" parameterType="hashmap" >
 			update xmk_wqgz set shzt='未审核',shsj=sysdate,shbm=#{shbm},sbthcd=#{sbthcd},shzt1='未审核',shyj2=#{shyj2} where id =#{id} 
 		</update>
 		
 		 <update id="shtyWqgzsjById" parameterType="jckwqgzsj" >
 			update xmk_wqgz set sbzt='已上报',sbsj=sysdate,sbbm=#{sbbm},sbthcd=#{sbthcd},shzt1='已审核',shyj1='同意' where id =#{id} 
 		</update>
 		<update id="shbtyWqgzsjById" parameterType="jckwqgzsj" >
 			update xmk_wqgz set sbzt='未上报',sbsj=sysdate,sbbm=#{sbbm},sbthcd=#{sbthcd},shzt1='未审核',shyj1=#{shyj1} where id =#{id} 
 		</update>
 		 <select id="dcwqgzsjxmkshExcel" parameterType="jckwqgzsj" resultType="elist">
	 	select 
       sqs v_1,xsq v_2,szxz v_3,xzqhdm v_4,qlmc v_5,xlxbm v_6,xlxmc v_7,xqlbm v_8,xzxzh v_9,qlbh v_10,lxbm v_11,lxmc v_12,decode(substr(lxbm,0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道') v_13,
      decode(substr(jsdj,0,1),'一','一级','二','二级','三','三级','四','四级','五','五级') v_14,qlzxzh v_15,ptx v_16,pty v_17,xjgjnd v_18,
      qlqc v_19,akjfl v_20,synf v_21,jsdj v_22,kjzc v_23,dkzdkj v_24,sjhspl v_25,qxjkuan v_26,qxjkong v_27,zqks v_28,
      qlkd v_29,qmjk v_30,kydwlx v_31,thdj v_32,glqlyt v_33,sbjgxs v_34,qdlx v_35,qtlx v_36,pzlx v_37,bhnr v_38,pddj v_39,bz v_40,sfylrbwqk v_41
	 	 from (
	 		select rownum num ,t.*,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where sbthcd=7 
			and sbthcd>=#{sbthcd} and gydwbm like '1%'  and xxcsj='是' and sfsc is null
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf in (${xmnf})
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="shzt!='' and shzt!= null ">
 			
 			<if test="shzt == '未审核'">
 			and (shzt like '%'||(#{shzt})||'%' or shzt is null) and sbthcd=7
 			</if>
 			<if test="shzt == '已审核'">
 			and (shzt like '%'||(#{shzt})||'%' or (shyj2 is not null and sbthcd!=7))
 			</if>
 			<if test="shzt == '审核不同意'">
 			and sbthcd != 7 and shyj2 is not null
 			</if>
 			<if test="shzt == '审核同意'">
 			and sbthcd = 7 and shyj2 = '同意' and shzt='已审核'
 			</if>
 		</if>
 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 		</if>
 		<if test="akjfl!='' and akjfl!= null ">
 			${akjfl}
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			${tsdq}
 		</if>
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
 		</if>
 		<if test="bzls!='' and bzls!= null ">
			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
 		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
	 	) order by v_4
	 			
	 </select>
 		<select id="selectJckShwqgz" parameterType="jckwqgzsj" resultType="jckwqgzsj">
 	select * from (
 		select rownum num ,t.*,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t 
 		left join (select count(*) jhsl,a3.id from plan_wqgz a1 left join sck_wqgz a2 on a1.sckid=a2.sckid left join xmk_wqgz a3 on a2.xmkid=a3.id group by a3.id) t1
	 			on t.id=t1.id
 		where (sbthcd=7 or shyj2 is not null)
			and sbthcd>=#{sbthcd} and gydwbm like '1%'  and xxcsj='是' and sfsc is null
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf in (${xmnf})
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="shzt!='' and shzt!= null ">
 			
 			<if test="shzt == '未审核'">
 			and (shzt like '%'||(#{shzt})||'%' or shzt is null) and sbthcd=7
 			</if>
 			<if test="shzt == '已审核'">
 			and (shzt like '%'||(#{shzt})||'%' or (shyj2 is not null and sbthcd!=7))
 			</if>
 			<if test="shzt == '审核不同意'">
 			and sbthcd != 7 and shyj2 is not null
 			</if>
 			<if test="shzt == '审核同意'">
 			and sbthcd = 7 and shyj2 = '同意' and shzt='已审核'
 			</if>
 		</if>
 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 		</if>
 		<if test="akjfl!='' and akjfl!= null ">
 			${akjfl}
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			${tsdq}
 		</if>
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
 		</if>
 		<if test="bzls!='' and bzls!= null ">
			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
 		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
 			order by shzt desc
 </select>
  <select id="selectWqgzShCount" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_wqgz t 
 		left join (select count(*) jhsl,a3.id from plan_wqgz a1 left join sck_wqgz a2 on a1.sckid=a2.sckid left join xmk_wqgz a3 on a2.xmkid=a3.id group by a3.id) t1
	 			on t.id=t1.id
 		where (sbthcd=7 or shyj2 is not null)
			and sbthcd>=#{sbthcd} and gydwbm like '1%'  and xxcsj='是' and sfsc is null
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf in (${xmnf})
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="shzt!='' and shzt!= null ">
 			
 			<if test="shzt == '未审核'">
 			and (shzt like '%'||(#{shzt})||'%' or shzt is null) and sbthcd=7
 			</if>
 			<if test="shzt == '已审核'">
 			and (shzt like '%'||(#{shzt})||'%' or (shyj2 is not null and sbthcd!=7))
 			</if>
 			<if test="shzt == '审核不同意'">
 			and sbthcd != 7 and shyj2 is not null
 			</if>
 			<if test="shzt == '审核同意'">
 			and sbthcd = 7 and shyj2 = '同意' and shzt='已审核'
 			</if>
 		</if>
 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 		</if>
 		<if test="akjfl!='' and akjfl!= null ">
 			${akjfl}
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			${tsdq}
 		</if>
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
 		</if>
 		<if test="bzls!='' and bzls!= null ">
			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
 		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
 </select>
 
 		<update id="sjshtyWqgzsjById" parameterType="jckwqgzsj" >
 			update xmk_wqgz set shzt='已审核',shsj=sysdate,shbm=#{shbm},sbthcd=#{sbthcd},shyj2='同意' where id =#{id} 
 		</update>
 		<update id="sjshtyWqgzsjByIdbeatch" parameterType="jckwqgzsj" >
 			update xmk_wqgz set shzt='已审核',shsj=sysdate,shbm=#{shbm},sbthcd=#{sbthcd},shyj2='同意' where 1=1 and ${id}
 		</update>
 		<update id="sjshbtyWqgzsjById" parameterType="jckwqgzsj" >
 			update xmk_wqgz set shzt='未审核',shsj=sysdate,shbm=#{shbm},sbthcd=#{sbthcd},shzt1='未审核',shyj2=#{shyj2} where id =#{id} 
 		</update>
 		
 		
 		<update id="xgwqsfsc" parameterType="jckwqgzsj" >
 			update xmk_wqgz set sfsc='是' where id =#{xmkid} 
 		</update>
 		<update id="xgwqsfscbeatch" parameterType="java.util.List" >
 			update xmk_wqgz set sfsc=null where 1=1 and id in (select xmkid from sck_wqgz where sckid=#{value})
 		</update>
 		
 		
 		
 		<update id="updateWqgz" parameterType="jckwqgzsj">
 			update xmk_wqgz set xmnf=#{xmnf},bhnr=#{bhnr},bz=#{bz},qlyhgcs=#{qlyhgcs},qljggcs=#{qljggcs},
 			czyjhjy=#{czyjhjy},pddj=#{pddj},sbjgxs=#{sbjgxs},
 			sqs=#{sqs},xsq=#{xsq},szxz=#{szxz},synf=#{synf},sjhspl=#{sjhspl},qxjkuan=#{qxjkuan},qxjkong=#{qxjkong},jsdj=#{jsdj},
 			zqks=#{zqks},qmjk=#{qmjk},kydwlx=#{kydwlx},thdj=#{thdj},glqlyt=#{glqlyt},qdlx=#{qdlx},qtlx=#{qtlx},pzlx=#{pzlx},tsdq=#{tsdq},sfylrbwqk=#{sfylrbwqk},xlxbm=#{xlxbm},xlxmc=#{xlxmc},xqlbm=#{xqlbm},xzxzh=#{xzxzh},ptx=#{ptx},pty=#{pty}
 			<if test="xqlmc != null">,xqlmc=#{xqlmc}</if>
 			where id=#{id}
 		</update>
 		
 		<select id="dcwqgzsjsckExcel" parameterType="jckwqgzsj" resultType="elist">
	 <!-- 	select 
      scsqs v_1,scxsq v_2,scszxz v_3,qlbh v_4,xqlbm v_5,qlmc v_6,sck_qlzxzh v_7,scqlqc v_8,scqlqk v_9,fapgdw v_10,fascdw v_11,faspsj v_12,
      spwh v_13,round(to_number(ztz),0) v_14,jsxz v_15,jsnr v_16,scxmnf v_17,round(to_number(nsqbbz),0) v_18,bz v_19
	 	 from (
	 		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
		 (select * from sck_wqgz t join xmk_wqgz xm on t.xmkid=xm.id where 1=1  -->
		 select 
	      scsqs v_1,scxsq v_2,scszxz v_3,qlbh v_4,xqlbm v_5,lxbm v_6,lxmc v_7,qlmc v_8,sck_qlzxzh v_9,scqlqc v_10,scqlqk v_11,fapgdw v_12,fascdw v_13,faspsj v_14,
	      spwh v_15,round(to_number(ztz),0) v_16,jsxz v_17,jsnr v_18,scxmnf v_19,round(to_number(nsqbbz),0) v_20,bz v_21
		 	 from (
		 		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
			 (select * from sck_wqgz t join xmk_wqgz xm on t.xmkid=xm.id where 1=1  and sfjh is null
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="xmrksj !='' and xmrksj != null ">
 					and xm.xmnf in (${xmrksj})
 				</if>
 				) t where 
			sck_sbthcd &lt;=#{sck_sbthcd} and gydwbm like '1%' 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf in (${xmnf})
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if> order by xzqhdm)
	 			
	 </select>
	 <select id="dcwqgzsjsckshExcel" parameterType="jckwqgzsj" resultType="elist">
	 	 <!--select 
     scsqs v_1,scxsq v_2,scszxz v_3,qlbh v_4,xqlbm v_5,qlmc v_6,sck_qlzxzh v_7,scqlqc v_8,scqlqk v_9,fapgdw v_10,fascdw v_11,faspsj v_12,
      spwh v_13,round(to_number(ztz),0) v_14,jsxz v_15,jsnr v_16,scxmnf v_17,round(to_number(nsqbbz),0) v_18,bz v_19
	 	 from (
	 		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
		 (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1  -->
		   select 
	      scsqs v_1,scxsq v_2,scszxz v_3,qlbh v_4,xqlbm v_5,lxbm v_6,lxmc v_7,qlmc v_8,sck_qlzxzh v_9,scqlqc v_10,scqlqk v_11,fapgdw v_12,fascdw v_13,faspsj v_14,
	      spwh v_15,round(to_number(ztz),0) v_16,jsxz v_17,jsnr v_18,scxmnf v_19,round(to_number(nsqbbz),0) v_20,bz v_21
		 	 from (
		 		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
			 (select * from sck_wqgz t join xmk_wqgz xm on t.xmkid=xm.id where 1=1   and sfjh is null
		 
 				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 			</if>
 				<if test="tsdq!='' and tsdq!= null ">
 				${tsdq}
 				</if>
 				<if test="xmrksj !='' and xmrksj != null ">
 					and xmk_wqgz.xmnf in (${xmrksj})
 				</if>) t where 
			(sck_sbthcd &lt;=7 or sck_shyj2 is not null) and gydwbm like '1%' 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf in (${xmnf})
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or sck_shzt is null) and sck_sbthcd=7
 			</if>
 			<if test="shzt == '已审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or (sck_shyj2 is not null and sck_sbthcd!=7))
 			</if>
 			<if test="shzt == '审核不同意'">
 			and sck_sbthcd != 7 and sck_shyj2 is not null
 			</if>
 			<if test="shzt == '审核同意'">
 			and sck_sbthcd = 7 and sck_shyj2 = '同意' and sck_shzt='已审核'
 			</if>
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if> order by xzqhdm)
	 			
	 </select>
	 
 		<select id="selectSckwqgz" parameterType="jckwqgzsj" resultType="jckwqgzsj">
		select * from (
		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
		 (select * from sck_wqgz t join xmk_wqgz xm on xmkid=xm.id where 1=1  and sfjh is null
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="xmrksj !='' and xmrksj != null ">
 					and xm.xmnf in (${xmrksj})
 				</if>
 				) t where 
			sck_sbthcd &lt;=#{sck_sbthcd} and gydwbm like '1%' 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf in (${xmnf})
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt),sck_shzt desc
	</select>
	<select id="selectSckwqgzCount" parameterType="jckwqgzsj" resultType="int">
		select count(*) from (select * from sck_wqgz t join xmk_wqgz xm on xmkid=xm.id where 1=1  and sfjh is null
				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="xmrksj !='' and xmrksj != null ">
 					and xm.xmnf in (${xmrksj})
 				</if>
 				) t where 
			sck_sbthcd &lt;=#{sck_sbthcd} and gydwbm like '1%' 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf in (${xmnf})
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
	</select>
	<select id="selectSckwqgzCount1" parameterType="jckwqgzsj" resultType="jckwqgzsj">
		select count(*) id,sum(ztz) ztz,sum(nsqbbz) nsqbbz from (select * from sck_wqgz t join xmk_wqgz xm on xmkid=xm.id where 1=1  and sfjh is null
				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					${tsdq}
 				</if>
 				<if test="xmrksj !='' and xmrksj != null ">
 					and xm.xmnf in (${xmrksj})
 				</if>
 				) t where 
			sck_sbthcd &lt;=#{sck_sbthcd} and gydwbm like '1%' 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf in (${xmnf})
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
	</select>
	 <select id="JckWqgzRoad" parameterType="hashmap" resultType="jckwqgzsj">
	 	select t.*,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where shzt='已审核'  and qlbh like #{qlbh}||'%' 
	 	<if test="gydwbm!='' and gydwbm!= null ">
				and gydwbm in(select id from xtgl_department where id like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%' or parent like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%') 
			</if>
	 	order by qlbh
 		</select>
 
 	 <select id="JckWqgzRoad1" parameterType="hashmap" resultType="jckwqgzsj">
	 	select t.*,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where shzt='已审核'  and qlbh like #{qlbh}||'%' and xxcsj='是'
	 	<if test="gydwbm!='' and gydwbm!= null ">
				and gydwbm in(select id from xtgl_department where id like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%' or parent like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%') 
			</if>
	 	order by qlbh
 		</select>
 
 	<insert id="insertSckwqgz" parameterType="jckwqgzsj">
		insert into
		sck_wqgz(sckid,xmkid,tzgs,spwh,fapgdw,fascdw,faspsj,jsxz,jsnr,scbz,scbmbm,sck_sbzt,sck_qlbh,sck_qlzxzh,
		sck_lxbm,sck_sbthcd,lrjh,bzls,scxmnf,scqlqc,scqlqk,sjdwmc,hzdj,scsjhspl,sck_sbjgxs,kjzh,sck_xbjgxs,ztz,sgtpfsj,pfwh,zgq,sfylrbwqk,
		rksj,cjqz,scthdj,qljc,ydgldj,sjsd,scsqs,scxsq,scszxz,nsqbbz,sfkxg,zdezj,scakjfl<if test="nsqsbz !=null">,nsqsbz</if><if test="nsqsjl !=null">,nsqsjl</if>)
		values(#{sckid},#{xmkid},#{tzgs},#{spwh},#{fapgdw},#{fascdw},#{faspsj},#{jsxz},#{jsnr},#{scbz},
		#{scbmbm},'未上报',#{qlbh},#{qlzxzh},#{lxbm},#{sck_sbthcd},'未列入',#{bzls},#{scxmnf},#{scqlqc},#{scqlqk},#{sjdwmc},#{hzdj},#{scsjhspl},#{sck_sbjgxs},#{kjzh},#{sck_xbjgxs},#{ztz},#{sgtpfsj},#{pfwh},#{zgq},#{sfylrbwqk},
		#{rksj},#{cjqz},#{scthdj},#{qljc},#{ydgldj},#{sjsd},#{scsqs},#{scxsq},#{scszxz},#{nsqbbz},#{sfkxg},#{zdezj},#{scakjfl}<if test="nsqsbz !=null">,#{nsqsbz}</if><if test="nsqsjl !=null">,#{nsqsjl}</if>)
	</insert>
	<delete id="deleteSckWqgz" parameterType="java.util.List" >
	 	delete from sck_wqgz where sckid =#{String}
	</delete>
	<update id="xgSckWqgzSbzt" parameterType="hashmap" >
 		update sck_wqgz set sck_sbzt='已上报',sck_sbsj=sysdate,sck_sbbm=#{sbbm},sck_sbthcd=#{sbthcd} where sckid =#{id}
	</update>
 	 <update id="shtyWqgzsckById" parameterType="jckwqgzsj" >
		update sck_wqgz set sck_sbzt='已上报',sck_sbsj=sysdate,sck_sbbm=#{sbbm},sck_sbthcd=#{sbthcd},sck_shzt1='已审核',sck_shyj1='同意' where sckid =#{id} 
	</update>
	<update id="shbtyWqgzsckById" parameterType="jckwqgzsj" >
		update sck_wqgz set sck_sbzt='未上报',sck_sbsj=sysdate,sck_sbbm=#{sbbm},sck_sbthcd=#{sbthcd},sck_shzt1='未审核',sck_shyj1=#{shyj1} where sckid =#{id} 
	</update>	
 	<update id="updateSckwqgz" parameterType="jckwqgzsj">
		update sck_wqgz
		set tzgs=#{tzgs},spwh=#{spwh},fapgdw=#{fapgdw},fascdw=#{fascdw},faspsj=#{faspsj},jsxz=#{jsxz},jsnr=#{jsnr},scbz=#{scbz},
		scxmnf=#{scxmnf},scqlqc=#{scqlqc},scqlqk=#{scqlqk},sjdwmc=#{sjdwmc},hzdj=#{hzdj},scsjhspl=#{scsjhspl},sck_sbjgxs=#{sck_sbjgxs},kjzh=#{kjzh},sck_xbjgxs=#{sck_xbjgxs},
		ztz=#{ztz},sgtpfsj=#{sgtpfsj},pfwh=#{pfwh},zgq=#{zgq}, zdezj=#{zdezj},
		rksj=#{rksj},cjqz=#{cjqz},scthdj=#{scthdj},qljc=#{qljc},ydgldj=#{ydgldj},sjsd=#{sjsd},scsqs=#{scsqs},scxsq=#{scxsq},scszxz=#{scszxz},nsqbbz=#{nsqbbz},sfylrbwqk=#{sfylrbwqk}<if test="nsqsbz != null">,nsqsbz=#{nsqsbz}</if>
		<if test="nsqsjl != null">,nsqsjl=#{nsqsjl}</if>
		<if test="scakjfl!='' and scakjfl!= null ">
			,scakjfl=#{scakjfl}
		</if>
		where sckid=#{sckid}
	</update>
 	<select id="selectSckShwqgz" parameterType="jckwqgzsj" resultType="jckwqgzsj">
		select * from (
		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
		 (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1  and sfjh is null
 				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 			</if>
 				<if test="tsdq!='' and tsdq!= null ">
 				${tsdq}
 				</if>
 				<if test="xmrksj !='' and xmrksj != null ">
 					and xmk_wqgz.xmnf in (${xmrksj})
 				</if>) t where 
			(sck_sbthcd &lt;=7 or sck_shyj2 is not null) and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf in (${xmnf})
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or sck_shzt is null) and sck_sbthcd=7
 			</if>
 			<if test="shzt == '已审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or (sck_shyj2 is not null and sck_sbthcd!=7))
 			</if>
 			<if test="shzt == '审核不同意'">
 			and sck_sbthcd != 7 and sck_shyj2 is not null
 			</if>
 			<if test="shzt == '审核同意'">
 			and sck_sbthcd = 7 and sck_shyj2 = '同意'  and sck_shzt='已审核'
 			</if>
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt),sck_shzt desc
	</select>
	<select id="selectSckShwqgzCount" parameterType="jckwqgzsj" resultType="int">
		select count(*) from (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1  and sfjh is null
 				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 			</if>
 				<if test="tsdq!='' and tsdq!= null ">
 				${tsdq}
 				</if>
 				<if test="xmrksj !='' and xmrksj != null ">
 					and xmk_wqgz.xmnf in (${xmrksj})
 				</if>) t where 
			(sck_sbthcd &lt;=7 or sck_shyj2 is not null) and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf in (${xmnf})
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or sck_shzt is null) and sck_sbthcd=7
 			</if>
 			<if test="shzt == '已审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or (sck_shyj2 is not null and sck_sbthcd!=7))
 			</if>
 			<if test="shzt == '审核不同意'">
 			and sck_sbthcd != 7 and sck_shyj2 is not null
 			</if>
 			<if test="shzt == '审核同意'">
 			and sck_sbthcd = 7 and sck_shyj2 = '同意'  and sck_shzt='已审核'
 			</if>
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
	</select>	
	
	<select id="selectSckShwqgzCount1" parameterType="jckwqgzsj" resultType="jckwqgzsj">
		select count(*) id,sum(ztz) ztz,sum(nsqbbz) nsqbbz from (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1  and sfjh is null
 				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 			</if>
 				<if test="tsdq!='' and tsdq!= null ">
 				${tsdq}
 				</if>
 				<if test="xmrksj !='' and xmrksj != null ">
 					and xmk_wqgz.xmnf in (${xmrksj})
 				</if>) t where 
			(sck_sbthcd &lt;=7 or sck_shyj2 is not null) and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf in (${xmnf})
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or sck_shzt is null) and sck_sbthcd=7
 			</if>
 			<if test="shzt == '已审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or (sck_shyj2 is not null and sck_sbthcd!=7))
 			</if>
 			<if test="shzt == '审核不同意'">
 			and sck_sbthcd != 7 and sck_shyj2 is not null
 			</if>
 			<if test="shzt == '审核同意'">
 			and sck_sbthcd = 7 and sck_shyj2 = '同意'  and sck_shzt='已审核'
 			</if>
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			${akjfl}
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz like '%'||(#{jsxz})||'%'
		</if>
		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
	</select>	
	<select id="cxplanwqgzbyid" parameterType="jckwqgzsj" resultType="planwqgzsj">
	select * from plan_wqgz where sckid=#{id}
	</select>
	<update id="sjshtyWqgzsjwqgz" parameterType="jckwqgzsj" >
		update sck_wqgz set sck_shzt='已审核',lrjh='已列入',sck_shsj=sysdate,sck_shbm=#{shbm},sck_sbthcd=#{sbthcd},sck_shyj2='同意' where sckid =#{id} 
	</update>
	<update id="xgsfjhty" parameterType="jckwqgzsj" >
		update sck_wqgz set sfjh='是' where sckid =#{id} 
	</update>
	
	<update id="sjshbtyWqgzsjwqgz" parameterType="jckwqgzsj" >
		update sck_wqgz set sck_shzt='未审核',sck_shsj=sysdate,sck_shbm=#{shbm},sck_sbthcd=#{sbthcd},sck_shzt1='未审核',sck_shyj2=#{shyj2} where sckid =#{id} 
	</update>
	
	<insert id="lrjhSckwqgz"  parameterType="jckwqgzsj">
		insert into plan_wqgz(id,sckid,xdzt,sbnf,jh_sbthcd
		<if test="shibz!='' and shibz!= null ">,shibz</if>
		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">,sfylrbwqk</if>
		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">,sfkxg</if>
		<if test="bzls!='' and bzls!= null ">,sfylsjl</if>
		<if test="scszxz!='' and scszxz!= null ">,qlszxz</if>
		<if test="jsnr!='' and jsnr!= null ">,zyjsnr</if>
		<if test="jsxz!='' and jsxz!= null ">,jhjsxz</if>
		<if test="faspsj!='' and faspsj!= null ">,pfsj</if>
		<if test="sjdwmc!='' and sjdwmc!= null ">,sjdw</if>
		<if test="fascdw!='' and fascdw!= null ">,sjpfdw</if>
		<if test="pfwh!='' and pfwh!= null ">,pfwh</if>
		<if test="ztz!='' and ztz!= null ">,pfztz</if>
		<if test="nsqsjl !='' and nsqsjl!= null ">,nsqsjl</if>
		<if test="sfylrbwqk !='' and sfylrbwqk!= null and nsqbbz!= null ">
			,jhsybzje
		</if>
		<if test="sfylrbwqk !='' and sfylrbwqk!= null and shengbz!= null ">
			,shengbz
		</if>
		<!-- ,pfztz -->) 
		values(sys_guid(),#{id},'未下达',#{scxmnf},#{bz}
		<if test="shibz!='' and shibz!= null ">,#{shibz}</if>
		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">,#{sfylrbwqk}</if>
		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">,decode(#{sfylrbwqk},'是','是','否','否')</if>
		<if test="bzls!='' and bzls!= null ">,#{bzls}</if>
		<if test="scszxz!='' and scszxz!= null ">,#{scszxz}</if>
		<if test="jsnr!='' and jsnr!= null ">,#{jsnr}</if>
		<if test="jsxz!='' and jsxz!= null ">,#{jsxz}</if>
		<if test="faspsj!='' and faspsj!= null ">,#{faspsj}</if>
		<if test="sjdwmc!='' and sjdwmc!= null ">,#{sjdwmc}</if>
		<if test="fascdw!='' and fascdw!= null ">,#{fascdw}</if>
		<if test="pfwh!='' and pfwh!= null ">,#{pfwh}</if>
		<if test="ztz!='' and ztz!= null ">,#{ztz}</if>
		<if test="nsqsjl !='' and nsqsjl!= null ">,#{nsqsjl}</if>
		<if test="sfylrbwqk !='' and sfylrbwqk!= null and nsqbbz!= null ">
			,#{nsqbbz}
		</if>
		<if test="sfylrbwqk !='' and sfylrbwqk!= null and shengbz!= null ">
			,#{shengbz}
		</if>
		<!-- ,#{ztz} -->)
	</insert>
	<select id="cxtiaojian" parameterType="jckwqgzsj" resultType="jckwqgzsj">
		select sckid,sc.sck_qlbh,fapgdw,fascdw,spwh,ztz,nsqbbz,scqlqk,scqlqc,xm.tsdq,xm.akjfl,sc.sfylrbwqk,sc.bzls,sc.scsqs,sc.scxsq,sc.scszxz,decode(sc.jsnr,null,' ',sc.jsnr) jsnr,decode(sc.jsxz,null,' ',sc.jsxz) jsxz,decode(sc.faspsj,null,to_char(sysdate,'yyyy-mm-dd') ,sc.faspsj) faspsj,sc.nsqsjl from sck_wqgz sc left join xmk_wqgz xm on sc.xmkid=xm.id
		where sckid=#{id}
	</select>
	<select id="selectshibz" parameterType="jckwqgzsj" resultType="wqbzbz">
		select * from xtgl_wqbzbz where 1=1 and bzjb='市级'
		<if test="sck_qlbh!='' and sck_qlbh!= null ">
			and jsdj like '%'||(substr(#{sck_qlbh},0,1))||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and #{akjfl} like '%'||qllx||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz = #{jsxz}
		</if>
	</select>
	<select id="selectshengbz" parameterType="jckwqgzsj" resultType="wqbzbz">
		select * from xtgl_wqbzbz where 1=1 and bzjb='省级'
		<if test="sck_qlbh!='' and sck_qlbh!= null ">
			and jsdj like '%'||(substr(#{sck_qlbh},0,1))||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and #{akjfl} like '%'||qllx||'%'
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz = #{jsxz}
		</if>
	</select>
	<update id="lrqqgzsj" parameterType="jckwqgzsj">
	update xmk_wqgz set qqgzsj=#{qqgzsj} where id=#{id}
	</update>
	
</mapper>

