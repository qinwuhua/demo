<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.jckwqgzsj">
	<delete id="deleteqlzpbyxmbm" parameterType="jckwqgzsj">
		delete from plan_upload where parentid=#{id}
	</delete>
	<insert id="insertWqgz" parameterType="jckwqgzsj">
		insert into xmk_wqgz(id,qlmc,qlbh,xzqhmc,xzqhdm,lxmc,lxbm,gydw,gydwbm,xjgjnd,jsdj,pddj,qlzxzh,qlkd,qlqc,
		kjzc,dkzdkj,akjfl,sbjgxs,bhnr,bz,tbbmbm,xmnf,xmtype,tbsj,sbzt,sbthcd,tsdq,qlyhgcs,qljggcs,czyjhjy,
		ptx,pty,sqs,xsq,szxz,synf,sjhspl,qxjkuan,qxjkong,zqks,qmjk,kydwlx,thdj,glqlyt,qdlx,qtlx,pzlx,sfylrbwqk) 
		values(#{id},#{qlmc},#{qlbh},#{xzqhmc},#{xzqhdm},#{lxmc},#{lxbm},#{gydw},
		(select id from xtgl_department where name=#{gydw}),#{xjgjnd},#{jsdj},
		#{pddj},#{qlzxzh},#{qlkd},#{qlqc},#{kjzc},#{dkzdkj},#{akjfl},#{sbjgxs},#{bhnr},#{bz},#{tbbmbm},#{xmnf},#{xmtype},
		sysdate,'未上报',#{sbthcd},#{tsdq},#{qlyhgcs},#{qljggcs},#{czyjhjy},
		#{ptx},#{pty},#{sqs},#{xsq},#{szxz},#{synf},#{sjhspl},#{qxjkuan},#{qxjkong},#{zqks},#{qmjk},#{kydwlx},#{thdj},#{glqlyt},#{qdlx},#{qtlx},#{pzlx},#{sfylrbwqk})
	</insert>
	
		<select id="selectWqgzList" parameterType="jckwqgzsj" resultType="jckwqgzsj">
	 	select * from (
	 		select rownum num ,t.*,decode(sbthcd,#{sbthcd},'未上报',sbzt) sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where 1=1 
	 			and  sbthcd &lt;=#{sbthcd} and gydwbm like '1%'
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqhdm!='' and xzqhdm!= null ">
				${xzqhdm}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="qlmc!='' and qlmc!= null ">
	 			and qlmc like '%'||(#{qlmc})||'%'
	 		</if>
	 		<if test="xmnf!='' and xmnf!= null ">
	 			and xmnf like '%'||(#{xmnf})||'%'
	 		</if>
	 		<if test="xmtype!='' and xmtype!= null ">
	 			and xmtype like '%'||(#{xmtype})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 			</if> 
	 		<if test="akjfl!='' and akjfl!= null ">
	 			and akjfl like '%'||(#{akjfl})||'%'
	 		</if>
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="qlbh!='' and qlbh!= null ">
	 			and qlbh like '%'||(#{qlbh})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			and tsdq like '%'||(#{tsdq})||'%'
	 		</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 		</if>
	 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
	 			order by decode(sbthcd,#{sbthcd},'未上报',sbzt),shzt desc 
	 </select>
	 <select id="dcwqgzsjjhExcel" parameterType="jckwqgzsj" resultType="elist">
	 	select 
      sqs v_1,xsq v_2,szxz v_3,qlmc v_4,qlbh v_5,lxbm v_6,lxmc v_7,decode(substr(lxbm,0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道') v_8,
      decode(substr(jsdj,0,1),'一','一级','二','二级','三','三级','四','四级','五','五级') v_9,qlzxzh v_10,ptx v_11,pty v_12,xjgjnd v_13,
      qlqc v_14,akjfl v_15,synf v_16,jsdj v_17,kjzc v_18,dkzdkj v_19,sjhspl v_20,qxjkuan v_21,qxjkong v_22,zqks v_23,
      qlkd v_24,qmjk v_25,kydwlx v_26,thdj v_27,glqlyt v_28,sbjgxs v_29,qdlx v_30,qtlx v_31,pzlx v_32,pddj v_33,sfylrbwqk v_34
	 	 from (
	 		select rownum num ,t.*,decode(sbthcd,#{sbthcd},'未上报',sbzt) sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where 1=1 
	 			and  sbthcd &lt;=#{sbthcd} and gydwbm like '1%'
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqhdm!='' and xzqhdm!= null ">
				${xzqhdm}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="qlmc!='' and qlmc!= null ">
	 			and qlmc like '%'||(#{qlmc})||'%'
	 		</if>
	 		<if test="xmnf!='' and xmnf!= null ">
	 			and xmnf like '%'||(#{xmnf})||'%'
	 		</if>
	 		<if test="xmtype!='' and xmtype!= null ">
	 			and xmtype like '%'||(#{xmtype})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
	 			and pddj like '%'||(#{jsdj})||'%'
	 		</if>
	 		<if test="akjfl!='' and akjfl!= null ">
	 			and akjfl like '%'||(#{akjfl})||'%'
	 		</if>
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="qlbh!='' and qlbh!= null ">
	 			and qlbh like '%'||(#{qlbh})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			and tsdq like '%'||(#{tsdq})||'%'
	 		</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 		</if>)
	 			
	 </select>
	 
	  <select id="selectWqgzCount" parameterType="jckwqgzsj" resultType="int">
	 		select count(*) from xmk_wqgz t where 1=1 
	 			and  sbthcd &lt;=#{sbthcd} and gydwbm like '1%'
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqhdm!='' and xzqhdm!= null ">
				${xzqhdm}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="qlmc!='' and qlmc!= null ">
	 			and qlmc like '%'||(#{qlmc})||'%'
	 		</if>
	 		<if test="xmnf!='' and xmnf!= null ">
	 			and xmnf like '%'||(#{xmnf})||'%'
	 		</if>
	 		<if test="xmtype!='' and xmtype!= null ">
	 			and xmtype like '%'||(#{xmtype})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
	 			and pddj like '%'||(#{jsdj})||'%'
	 		</if>
	 		<if test="akjfl!='' and akjfl!= null ">
	 			and akjfl like '%'||(#{akjfl})||'%'
	 		</if>
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="qlbh!='' and qlbh!= null ">
	 			and qlbh like '%'||(#{qlbh})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			and tsdq like '%'||(#{tsdq})||'%'
	 		</if>
	 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 		</if>
		 </select>
		 <delete id="deleteWqgzsjById" parameterType="java.util.List" >
		 	delete from xmk_wqgz where id =#{String}
		 </delete>
		 <select id="getwqgzZP1" resultType="plan_upload" parameterType="jckwqgzsj">
		 	select id from plan_upload where parentid=#{id} and filetype='桥梁正面文件'
		 </select>
		 <select id="getwqgzZP2" resultType="plan_upload" parameterType="jckwqgzsj">
		 	select id from plan_upload where parentid=#{id} and filetype='桥梁侧面文件'
		 </select>
		 <update id="xgJckwqgzSbzt" parameterType="hashmap" >
 			update xmk_wqgz set sbzt='已上报',sbsj=sysdate,sbbm=#{sbbm},sbthcd=#{sbthcd} where id =#{id}
 		</update>
 		 <update id="shtyWqgzsjById" parameterType="jckwqgzsj" >
 			update xmk_wqgz set sbzt='已上报',sbsj=sysdate,sbbm=#{sbbm},sbthcd=#{sbthcd},shzt1='已审核',shyj1='同意' where id =#{id} 
 		</update>
 		<update id="shbtyWqgzsjById" parameterType="jckwqgzsj" >
 			update xmk_wqgz set sbzt='未上报',sbsj=sysdate,sbbm=#{sbbm},sbthcd=#{sbthcd},shzt1='未审核',shyj1=#{shyj1} where id =#{id} 
 		</update>
 		 <select id="dcwqgzsjxmkshExcel" parameterType="jckwqgzsj" resultType="elist">
	 	select 
      sqs v_1,xsq v_2,szxz v_3,qlmc v_4,qlbh v_5,lxbm v_6,lxmc v_7,decode(substr(lxbm,0,1),'G','国道','S','省道','X','县道','Y','乡道','C','村道','Z','专道') v_8,
      decode(substr(jsdj,0,1),'一','一级','二','二级','三','三级','四','四级','五','五级') v_9,qlzxzh v_10,ptx v_11,pty v_12,xjgjnd v_13,
      qlqc v_14,akjfl v_15,synf v_16,jsdj v_17,kjzc v_18,dkzdkj v_19,sjhspl v_20,qxjkuan v_21,qxjkong v_22,zqks v_23,
      qlkd v_24,qmjk v_25,kydwlx v_26,thdj v_27,glqlyt v_28,sbjgxs v_29,qdlx v_30,qtlx v_31,pzlx v_32,pddj v_33,sfylrbwqk v_34
	 	 from (
	 		select rownum num ,t.*,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where sbthcd=7 
			and sbthcd>=#{sbthcd} and gydwbm like '1%'
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="shzt!='' and shzt!= null ">
 			<if test="shzt == '未审核'">
 			and (shzt like '%'||(#{shzt})||'%' or shzt=' ')
 			</if>
 			<if test="shzt == '已审核'">
 			and shzt like '%'||(#{shzt})||'%'
 			</if>
 		</if>
 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 		</if>
 		<if test="akjfl!='' and akjfl!= null ">
 			and akjfl like '%'||(#{akjfl})||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			and tsdq like '%'||(#{tsdq})||'%'
 		</if>
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 	</if>)
	 			
	 </select>
 		<select id="selectJckShwqgz" parameterType="jckwqgzsj" resultType="jckwqgzsj">
 	select * from (
 		select rownum num ,t.*,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where sbthcd=7 
			and sbthcd>=#{sbthcd} and gydwbm like '1%'
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="shzt!='' and shzt!= null ">
 			<if test="shzt == '未审核'">
 			and (shzt like '%'||(#{shzt})||'%' or shzt=' ')
 			</if>
 			<if test="shzt == '已审核'">
 			and shzt like '%'||(#{shzt})||'%'
 			</if>
 		</if>
 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 		</if>
 		<if test="akjfl!='' and akjfl!= null ">
 			and akjfl like '%'||(#{akjfl})||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			and tsdq like '%'||(#{tsdq})||'%'
 		</if>
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 		</if>
 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
 			order by shzt desc
 </select>
  <select id="selectWqgzShCount" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_wqgz t where sbthcd=7 
			and sbthcd>=#{sbthcd} and gydwbm like '1%'
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf like '%'||(#{xmnf})||'%'
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="shzt!='' and shzt!= null ">
 			<if test="shzt == '未审核'">
 			and (shzt like '%'||(#{shzt})||'%' or shzt=' ')
 			</if>
 			<if test="shzt == '已审核'">
 			and shzt like '%'||(#{shzt})||'%'
 			</if>
 		</if>
 		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 		</if>
 		<if test="akjfl!='' and akjfl!= null ">
 			and akjfl like '%'||(#{akjfl})||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			and tsdq like '%'||(#{tsdq})||'%'
 		</if>
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 		</if>
 </select>
 
 		<update id="sjshtyWqgzsjById" parameterType="jckwqgzsj" >
 			update xmk_wqgz set shzt='已审核',shsj=sysdate,shbm=#{shbm},sbthcd=#{sbthcd},shyj2='同意' where id =#{id} 
 		</update>
 		<update id="sjshbtyWqgzsjById" parameterType="jckwqgzsj" >
 			update xmk_wqgz set shzt='未审核',shsj=sysdate,shbm=#{shbm},sbthcd=#{sbthcd},shzt1='未审核',shyj2=#{shyj2} where id =#{id} 
 		</update>
 		<update id="updateWqgz" parameterType="jckwqgzsj">
 			update xmk_wqgz set xmnf=#{xmnf},bhnr=#{bhnr},bz=#{bz},qlyhgcs=#{qlyhgcs},qljggcs=#{qljggcs},
 			czyjhjy=#{czyjhjy},pddj=#{pddj},sbjgxs=#{sbjgxs},
 			sqs=#{sqs},xsq=#{xsq},szxz=#{szxz},synf=#{synf},sjhspl=#{sjhspl},qxjkuan=#{qxjkuan},qxjkong=#{qxjkong},jsdj=#{jsdj},
 			zqks=#{zqks},qmjk=#{qmjk},kydwlx=#{kydwlx},thdj=#{thdj},glqlyt=#{glqlyt},qdlx=#{qdlx},qtlx=#{qtlx},pzlx=#{pzlx},tsdq=#{tsdq},sfylrbwqk=#{sfylrbwqk}
 			where id=#{id}
 		</update>
 		
 		<select id="dcwqgzsjsckExcel" parameterType="jckwqgzsj" resultType="elist">
	 	select 
      scsqs v_1,scxsq v_2,scszxz v_3,qlbh v_4,qlmc v_5,sck_qlzxzh v_6,scqlqc v_7,scqlqk v_8,fapgdw v_9,fascdw v_10,faspsj v_11,
      spwh v_12,round(to_number(ztz),0) v_13,jsxz v_14,jsnr v_15,scxmnf v_16,round(to_number(nsqbbz),0) v_17,bz v_18
	 	 from (
	 		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
		 (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1 
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					and xmk_wqgz.tsdq like '%'||#{tsdq}||'%'
 				</if>) t where 
			sck_sbthcd &lt;=#{sck_sbthcd} and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf like '%'||(#{xmnf})||'%'
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and akjfl like #{akjfl}||'%'
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>)
	 			
	 </select>
	 <select id="dcwqgzsjsckshExcel" parameterType="jckwqgzsj" resultType="elist">
	 	select 
      scsqs v_1,scxsq v_2,scszxz v_3,qlbh v_4,qlmc v_5,sck_qlzxzh v_6,scqlqc v_7,scqlqk v_8,fapgdw v_9,fascdw v_10,faspsj v_11,
      spwh v_12,round(to_number(ztz),0) v_13,jsxz v_14,jsnr v_15,scxmnf v_16,round(to_number(nsqbbz),0) v_17,bz v_18
	 	 from (
	 		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
		 (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1 
 				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 			</if>
 				<if test="tsdq!='' and tsdq!= null ">
 				and xmk_wqgz.tsdq like '%'||#{tsdq}||'%'
 				</if>) t where 
			sck_sbthcd &lt;=7 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf like '%'||(#{xmnf})||'%'
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or sck_shzt is null)
 			</if>
 			<if test="shzt == '已审核'">
 			and sck_shzt like '%'||(#{shzt})||'%'
 			</if>
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and akjfl like #{akjfl}||'%'
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>)
	 			
	 </select>
	 
 		<select id="selectSckwqgz" parameterType="jckwqgzsj" resultType="jckwqgzsj">
		select * from (
		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
		 (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1 
		 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 					and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 					and xmk_wqgz.tsdq like '%'||#{tsdq}||'%'
 				</if>) t where 
			sck_sbthcd &lt;=#{sck_sbthcd} and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf like '%'||(#{xmnf})||'%'
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and akjfl like #{akjfl}||'%'
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt),sck_shzt desc
	</select>
	<select id="selectSckwqgzCount" parameterType="jckwqgzsj" resultType="int">
		select count(*) from (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1 
				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
		 			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
				</if>
 				<if test="tsdq!='' and tsdq!= null ">
 				and xmk_wqgz.tsdq like '%'||#{tsdq}||'%'
 				</if>)
			where sck_sbthcd &lt;=#{sck_sbthcd} and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf like '%'||(#{xmnf})||'%'
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="sbzt!='' and sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and akjfl like #{akjfl}||'%'
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		
	</select>
	 <select id="JckWqgzRoad" parameterType="hashmap" resultType="jckwqgzsj">
	 	select t.*,to_char(wqrksj,'yyyy-mm-dd') xmrksj from xmk_wqgz t where shzt='已审核'  and qlbh like #{qlbh}||'%' 
	 	<if test="gydwbm!='' and gydwbm!= null ">
				and gydwbm in(select id from xtgl_department where id like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%' or parent like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%') 
			</if>
	 	order by qlbh
 </select>
 
 	<insert id="insertSckwqgz" parameterType="jckwqgzsj">
		insert into
		sck_wqgz(sckid,xmkid,tzgs,spwh,fapgdw,fascdw,faspsj,jsxz,jsnr,scbz,scbmbm,sck_sbzt,sck_qlbh,sck_qlzxzh,
		sck_lxbm,sck_sbthcd,lrjh,bzls,scxmnf,scqlqc,scqlqk,sjdwmc,hzdj,scsjhspl,sck_sbjgxs,kjzh,sck_xbjgxs,ztz,sgtpfsj,pfwh,zgq,sfylrbwqk,
		rksj,cjqz,scthdj,qljc,ydgldj,sjsd,scsqs,scxsq,scszxz,nsqbbz,sfkxg,zdezj,scakjfl)
		values(#{sckid},#{xmkid},#{tzgs},#{spwh},#{fapgdw},#{fascdw},#{faspsj},#{jsxz},#{jsnr},#{scbz},
		#{scbmbm},'未上报',#{qlbh},#{qlzxzh},#{lxbm},#{sck_sbthcd},'未列入',#{bzls},#{scxmnf},#{scqlqc},#{scqlqk},#{sjdwmc},#{hzdj},#{scsjhspl},#{sck_sbjgxs},#{kjzh},#{sck_xbjgxs},#{ztz},#{sgtpfsj},#{pfwh},#{zgq},#{sfylrbwqk},
		#{rksj},#{cjqz},#{scthdj},#{qljc},#{ydgldj},#{sjsd},#{scsqs},#{scxsq},#{scszxz},#{nsqbbz},#{sfkxg},#{zdezj},#{scakjfl})
	</insert>
	<delete id="deleteSckWqgz" parameterType="java.util.List" >
	 	delete from sck_wqgz where sckid =#{String}
	</delete>
	<update id="xgSckWqgzSbzt" parameterType="hashmap" >
 		update sck_wqgz set sck_sbzt='已上报',sck_sbsj=sysdate,sck_sbbm=#{sbbm},sck_sbthcd=#{sbthcd} where sckid =#{id}
	</update>
 	 <update id="shtyWqgzsckById" parameterType="jckwqgzsj" >
		update sck_wqgz set sck_sbzt='已上报',sck_sbsj=sysdate,sck_sbbm=#{sbbm},sck_sbthcd=#{sbthcd},sck_shzt1='已审核',sck_shyj1='同意' where sckid =#{id} 
	</update>
	<update id="shbtyWqgzsckById" parameterType="jckwqgzsj" >
		update sck_wqgz set sck_sbzt='未上报',sck_sbsj=sysdate,sck_sbbm=#{sbbm},sck_sbthcd=#{sbthcd},sck_shzt1='未审核',sck_shyj1=#{shyj1} where sckid =#{id} 
	</update>	
 	<update id="updateSckwqgz" parameterType="jckwqgzsj">
		update sck_wqgz
		set tzgs=#{tzgs},spwh=#{spwh},fapgdw=#{fapgdw},fascdw=#{fascdw},faspsj=#{faspsj},jsxz=#{jsxz},jsnr=#{jsnr},scbz=#{scbz},
		scxmnf=#{scxmnf},scqlqc=#{scqlqc},scqlqk=#{scqlqk},sjdwmc=#{sjdwmc},hzdj=#{hzdj},scsjhspl=#{scsjhspl},sck_sbjgxs=#{sck_sbjgxs},kjzh=#{kjzh},sck_xbjgxs=#{sck_xbjgxs},
		ztz=#{ztz},sgtpfsj=#{sgtpfsj},pfwh=#{pfwh},zgq=#{zgq}, zdezj=#{zdezj},
		rksj=#{rksj},cjqz=#{cjqz},scthdj=#{scthdj},qljc=#{qljc},ydgldj=#{ydgldj},sjsd=#{sjsd},scsqs=#{scsqs},scxsq=#{scxsq},scszxz=#{scszxz},nsqbbz=#{nsqbbz},sfylrbwqk=#{sfylrbwqk}
		<if test="scakjfl!='' and scakjfl!= null ">
			,scakjfl=#{scakjfl}
		</if>
		where sckid=#{sckid}
	</update>
 	<select id="selectSckShwqgz" parameterType="jckwqgzsj" resultType="jckwqgzsj">
		select * from (
		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2,to_char(wqrksj,'yyyy-mm-dd') xmrksj from
		 (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1 
 				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 			</if>
 				<if test="tsdq!='' and tsdq!= null ">
 				and xmk_wqgz.tsdq like '%'||#{tsdq}||'%'
 				</if>) t where 
			sck_sbthcd &lt;=7 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf like '%'||(#{xmnf})||'%'
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or sck_shzt is null)
 			</if>
 			<if test="shzt == '已审核'">
 			and sck_shzt like '%'||(#{shzt})||'%'
 			</if>
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and akjfl like #{akjfl}||'%'
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt),sck_shzt desc
	</select>
	<select id="selectSckShwqgzCount" parameterType="jckwqgzsj" resultType="int">
		select count(*) from (select * from sck_wqgz t join xmk_wqgz on xmkid=xmk_wqgz.id where 1=1 
 				<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
	 			and t.sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
	 			</if>
 				<if test="tsdq!='' and tsdq!= null "> 
 				and xmk_wqgz.tsdq like '%'||#{tsdq}||'%'
 				</if>)
			where sck_sbthcd &lt;=7 and gydwbm like '1%'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf like '%'||(#{xmnf})||'%'
		</if>
		<if test="xmtype!='' and xmtype!= null ">
			and xmtype like '%'||(#{xmtype})||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			<if test="shzt == '未审核'">
 			and (sck_shzt like '%'||(#{shzt})||'%' or sck_shzt is null)
 			</if>
 			<if test="shzt == '已审核'">
 			and sck_shzt like '%'||(#{shzt})||'%'
 			</if>
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and pddj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and akjfl like #{akjfl}||'%'
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
	</select>	
	<update id="sjshtyWqgzsjwqgz" parameterType="jckwqgzsj" >
		update sck_wqgz set sck_shzt='已审核',lrjh='已列入',sck_shsj=sysdate,sck_shbm=#{shbm},sck_sbthcd=#{sbthcd},sck_shyj2='同意' where sckid =#{id} 
	</update>
	<update id="sjshbtyWqgzsjwqgz" parameterType="jckwqgzsj" >
		update sck_wqgz set sck_shzt='未审核',sck_shsj=sysdate,sck_shbm=#{shbm},sck_sbthcd=#{sbthcd},sck_shzt1='未审核',sck_shyj2=#{shyj2} where sckid =#{id} 
	</update>
	
	<insert id="lrjhSckwqgz"  parameterType="jckwqgzsj">
		insert into plan_wqgz(id,sckid,xdzt,sbnf,jh_sbthcd,shibz,shengbz,sfylrbwqk,sfkxg,sfylsjl,qlszxz,zyjsnr,jhjsxz,pfsj,sjdw,sjpfdw,pfwh<!-- ,pfztz -->) 
		values(sys_guid(),#{id},'未下达',#{scxmnf},#{bz},#{shibz},#{shengbz},#{sfylrbwqk},decode(#{sfylrbwqk},'是','是','否','否'),#{bzls},#{scszxz},#{jsnr},#{jsxz},to_date(#{faspsj},'yyyy-mm-dd'),#{sjdwmc},#{fascdw},#{pfwh}<!-- ,#{ztz} -->)
	</insert>
	<select id="cxtiaojian" parameterType="jckwqgzsj" resultType="jckwqgzsj">
		select sckid,sc.sck_qlbh,fapgdw,fascdw,spwh,ztz,scqlqk,scqlqc,xm.tsdq,xm.akjfl,sc.sfylrbwqk,sc.bzls,sc.scsqs,sc.scxsq,sc.scszxz,decode(sc.jsnr,null,' ',sc.jsnr) jsnr,decode(sc.jsxz,null,' ',sc.jsxz) jsxz,decode(sc.faspsj,null,to_char(sysdate,'yyyy-mm-dd') ,sc.faspsj) faspsj from sck_wqgz sc left join xmk_wqgz xm on sc.xmkid=xm.id
		where sckid=#{id}
	</select>
	<select id="selectshibz" parameterType="jckwqgzsj" resultType="wqbzbz">
		select * from xtgl_wqbzbz where 1=1 and bzjb='市级'
		<if test="sck_qlbh!='' and sck_qlbh!= null ">
			and jsdj like '%'||(substr(#{sck_qlbh},0,1))||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and qllx = #{akjfl}
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz = #{jsxz}
		</if>
	</select>
	<select id="selectshengbz" parameterType="jckwqgzsj" resultType="wqbzbz">
		select * from xtgl_wqbzbz where 1=1 and bzjb='省级'
		<if test="sck_qlbh!='' and sck_qlbh!= null ">
			and jsdj like '%'||(substr(#{sck_qlbh},0,1))||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and qllx = #{akjfl}
		</if>
		<if test="jsxz!='' and jsxz!= null ">
			and jsxz = #{jsxz}
		</if>
	</select>
</mapper>

