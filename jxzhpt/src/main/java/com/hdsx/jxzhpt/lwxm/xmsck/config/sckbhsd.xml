<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.sckbhsd">
	<insert id="insertSckbhsd" parameterType="sckbhsd">
		insert into
		sck_bhsd(sckid,xmkid,tzgs,spwh,spdw,sjdw,sck_jsxz,zyjsnr,scbz,scbmbm,sck_sbzt,sck_shzt,sck_sddm,sck_sdzxzh,
		sck_lxbm,sck_lxmc,sck_sbthcd,lrjh,sck_xmnf,sck_sdcd,sck_sdkd,sck_sdgd,sck_nsddm,sck_nlxbm,sck_nsdzxzh,sck_nlxmc)
		values(sys_guid(),#{xmkid},#{tzgs},#{spwh,jdbcType=VARCHAR},#{spdw,jdbcType=VARCHAR},#{sjdw,jdbcType=VARCHAR},
		#{sck_jsxz,jdbcType=VARCHAR},#{zyjsnr,jdbcType=VARCHAR},#{scbz,jdbcType=VARCHAR},#{scbmbm},'未上报',
		'未审核',#{sck_sddm,jdbcType=VARCHAR},#{sck_sdzxzh,jdbcType=VARCHAR},
		#{sck_lxbm},#{sck_lxmc},#{sck_sbthcd},'未列入',#{sck_xmnf},#{sck_sdcd,jdbcType=VARCHAR},#{sck_sdkd,jdbcType=VARCHAR},
		#{sck_sdgd,jdbcType=VARCHAR},#{sck_nsddm,jdbcType=VARCHAR},
		#{sck_nlxbm,jdbcType=VARCHAR},#{sck_nsdzxzh,jdbcType=VARCHAR},#{sck_nlxmc,jdbcType=VARCHAR})
	</insert>
	
	<insert id="lrjhSckbhsd"  parameterType="java.util.List">
		insert into plan_bhsd(id,sckid,xdzt,jh_sbthcd) values(sys_guid(),#{sckid},'未下达',#{jh_sbthcd})
	</insert>
 	<insert id="xglrjhSckbhsd"  parameterType="java.util.List">
		update sck_bhsd set lrjh='已列入'  where sckid=#{String}
	</insert>

	<select id="selectSckbhsd" parameterType="sckbhsd" resultType="sckbhsd">
		select * from (
		select rownum num ,t.*,decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) sck_sbzt2 from
		 (select * from sck_bhsd t join xmk_bhsd on xmkid=xmk_bhsd.id where 1=1
 				) t where 
			sck_sbthcd &lt;=#{sck_sbthcd} 
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		<if test="sck_sbzt!='' and sck_sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sck_sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sddm!='' and sddm!= null ">
			and sddm like '%'||(#{sddm})||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by sck_sbzt2,sck_shzt asc
		
	</select>
	<select id="selectWqgzCount" parameterType="sckbhsd" resultType="int">
		select count(*) from (select * from sck_bhsd t join xmk_bhsd on xmkid=xmk_bhsd.id where 1=1
 				)
			where sck_sbthcd &lt;=#{sck_sbthcd} 
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		<if test="sck_sbzt!='' and sck_sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sck_sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sddm!='' and sddm!= null ">
			and sddm like '%'||(#{sddm})||'%'
		</if>
	</select>

	<update id="updateSckbhsd" parameterType="sckbhsd">
		update sck_bhsd set
		tzgs=#{tzgs,jdbcType=VARCHAR},spwh=#{spwh,jdbcType=VARCHAR},spdw=#{spdw,jdbcType=VARCHAR},sjdw=#{sjdw,jdbcType=VARCHAR},
		sck_jsxz=#{sck_jsxz,jdbcType=VARCHAR},zyjsnr=#{zyjsnr,jdbcType=VARCHAR},scbz=#{scbz,jdbcType=VARCHAR},sck_xmnf=#{sck_xmnf},
		sck_sdcd=#{sck_sdcd,jdbcType=VARCHAR},sck_sdkd=#{sck_sdkd,jdbcType=VARCHAR},sck_sdgd=#{sck_sdgd,jdbcType=VARCHAR},
		sck_nsddm=#{sck_nsddm,jdbcType=VARCHAR},sck_nlxbm=#{sck_nlxbm,jdbcType=VARCHAR},sck_nsdzxzh=#{sck_nsdzxzh,jdbcType=VARCHAR},sck_nlxmc=#{sck_nlxmc,jdbcType=VARCHAR}
		where sckid=#{sckid}
	</update>
	<select id="selectSckbhsdById" parameterType="sckbhsd" resultType="sckbhsd">
		select * from sck_bhsd t join xmk_bhsd on xmkid=xmk_bhsd.id where
		sckid=#{sckid}
	</select>
	<delete id="deleteSckbhsd" parameterType="java.util.List">
		delete from sck_bhsd where sckid =#{String}
	</delete>

	<update id="xgSckbhsdSbzt" parameterType="hashmap">
		update sck_bhsd set sck_sbzt='已上报', sck_sbsj=sysdate,sck_sbbm=#{sck_sbbm},
 		sck_sbthcd=#{sck_sbthcd},sck_thyj='' where sckid =#{sckid}
	</update>
	
	<update id="xgSckbhsdShzt" parameterType="hashmap">
		update sck_bhsd set sck_shzt='已审核',lrjh='已列入',sck_shsj=sysdate,sck_shbm=#{sck_shbm} where sckid=#{sckid}
	</update>

    <update id="xgSckbhsdSdzt" parameterType="hashmap">
		update sck_bhsd set sck_sdzt='1',lrjh='已列入' where sckid=#{sckid}
	</update>
	
	 <select id="selectBhsdWsd" parameterType="sckbhsd" resultType="sckbhsd">
	   select * from sck_bhsd t left join xmk_bhsd  on xmkid=xmk_bhsd.id
	    where  sck_sbthcd=2 and sck_shzt='已审核' and sck_sdzt='0' 
        <if test="xtType!='' and xtType!= null ">
			${xtType}
		</if>
    </select>
 
	<update id="xgSckbhsdTH" parameterType="java.util.List">
		update sck_bhsd set sck_sbthcd=(sck_sbthcd+2),sck_thyj=#{sck_thyj} where sckid =#{id}
	</update>

    <update id="xgSckbhsdTH1" parameterType="hashmap">
		update sck_bhsd set sck_sbthcd=(sck_sbthcd+2),sck_sbbm=#{sck_sbbm} where sckid =#{sckid}
	</update>
	
	 <select id="selectSbbmByBhsdId" parameterType="sckbhsd" resultType="sckbhsd">
	 select parent as sck_sbbm from xtgl_department where 
	 id =(select scbmbm from sck_bhsd where sckid=#{sckid})
     </select>
  
	<select id="selectSckShbhsd" parameterType="sckbhsd" resultType="sckbhsd">
		select * from (
		select rownum num ,t.* from (select * from sck_bhsd t join xmk_bhsd on
		xmkid=xmk_bhsd.id 
		where 1=1
 			) t
		where sck_sbthcd=7
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
<!-- 		Cif> -->
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		
		<if test="sck_shzt!='' and sck_shzt!= null ">
			and sck_shzt like '%'||(#{sck_shzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sddm!='' and sddm!= null ">
			and sddm like '%'||(#{sddm})||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by sck_shzt desc,lrjh desc
	</select>
	
	<select id="selectSckbhsdShCount" parameterType="sckbhsd" resultType="int">
		select count(*) from (select * from sck_bhsd t join xmk_bhsd on
		xmkid=xmk_bhsd.id
		where 1=1)
		where sck_sbthcd=7
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		
		<if test="sck_shzt!='' and sck_shzt!= null ">
			and sck_shzt like '%'||(#{sck_shzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sddm!='' and sddm!= null ">
			and sddm like '%'||(#{sddm})||'%'
		</if>
	</select>
	
	<select id="selectSckSdbhsd" parameterType="sckbhsd" resultType="sckbhsd">
		select * from (
		select rownum num ,t.* from (select * from sck_bhsd t join xmk_bhsd on
		xmkid=xmk_bhsd.id 
		where 1=1
 			) t
		where sck_sbthcd=7
			and sck_shzt='已审核' 
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		
		<if test="sck_sdzt!='' and sck_sdzt!= null ">
			and sck_sdzt like '%'||(#{sck_sdzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sddm!='' and sddm!= null ">
			and sddm like '%'||(#{sddm})||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and
		t1.num>(#{page}-1)*#{rows}
		order by sck_shzt desc,lrjh desc
	</select>
	
	<select id="selectSckbhsdSdCount" parameterType="sckbhsd"
		resultType="int">
		select count(*) from (select * from sck_bhsd t join xmk_bhsd on
		xmkid=xmk_bhsd.id
		where 1=1
 			)
		where sck_sbthcd=7
			and sck_shzt='已审核' 
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		
		<if test="sck_sdzt!='' and sck_sdzt!= null ">
			and sck_sdzt like '%'||(#{sck_sdzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sddm!='' and sddm!= null ">
			and sddm like '%'||(#{sddm})||'%'
		</if>
	</select>
	
	<select id="onceSckbhsd" parameterType="sckbhsd" resultType="int">
 		select count(*) from sck_bhsd where 1=1
<!--  		and substr(sck_lxbm,1,1) in('G','S') -->
 		<if test="sck_sddm!='' and sck_sddm!= null "  >
 			and (sck_sddm=#{sck_sddm}
 			or (sck_lxbm=#{sck_lxbm} and to_number(sck_sdzxzh)=to_number(#{sck_sdzxzh})))
 		</if>
 		<if test="sck_xmnf!='' and sck_xmnf!=  null "  >
 			and sck_xmnf=#{sck_xmnf}
 		</if>
 		
 </select>
 
	<select id="bzBhsd" parameterType="sckbhsd" resultType="int">
 		SELECT C1.CON1+C2.CON2 FROM
(select count(*) CON1 from sck_bhsd where lrjh='已列入' 
and (sck_qlbh=#{qlbh}
or (sck_lxbm=#{lxbm} and to_number(sck_qlzxzh)=to_number(#{qlzxzh})))
)C1,
(select count(*) CON2 from sck_bhsd SC,
(select YQLBH,YLXBM,YQLZXZH from XTGL_QLSJ where (xqlbh=#{qlbh}
or (xlxbm=#{lxbm} and xqlzxzh=to_number(#{qlzxzh})))) k
where SC.lrjh='已列入' AND (SC.sck_qlbh=k.YQLBH
or (SC.sck_lxbm=k.YLXBM and to_number(SC.sck_qlzxzh)=to_number(k.YQLZXZH)))
)C2
 </select>

   <select id="daoRubhsdsh" parameterType="sckbhsd" resultType="sckbhsd">
 		select * from xmk_bhsd where sdzt='1'
 		<if test="gydwbm!='' and gydwbm!= null ">
			and tbbmbm like #{gydwbm}||'%'
		</if>
 		<if test="sddm!='' and sddm!= null "  >
 			and (sddm=#{sddm}
 			or (lxbm=#{lxbm} and to_number(sdzxzh)=#{sdzxzh}))
 		</if>
 </select>
 
	
	<select id="exportExcel_bhsd_scgl" parameterType="sckbhsd"
		resultType="sjbb">
		select	
        (case when sck_thyj is not null  then decode(sck_sbthcd,#{sck_sbthcd},'未上报(退回)',sck_sbzt) 
        when  sck_thyj!='' then decode(sck_sbthcd,#{sck_sbthcd},'未上报(退回)',sck_sbzt)
        else decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) end) v_0,
		sck_shzt v_1,gydw v_2,xzqhmc v_3,sddm v_4,sdmc v_5,sdzxzh v_6,lxbm v_7,lxmc
		v_8,pddj v_9,xjgjnd v_10,xmnf v_11,sck_jsxz v_12,xmk_bhsd.xmmc v_13
		from sck_bhsd t join xmk_bhsd on xmkid=xmk_bhsd.id where 1=1
		and sck_sbthcd &lt;=#{sck_sbthcd} 
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		<if test="sck_sbzt!='' and sck_sbzt!= null ">
			and decode(sck_sbthcd,#{sck_sbthcd},'未上报',sck_sbzt) like '%'||(#{sck_sbzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sck_sddm!='' and sck_sddm!= null ">
			and sck_sddm like '%'||(#{sck_sddm})||'%'
		</if>
	</select>
	<select id="exportExcel_bhsd_scsh" parameterType="sckbhsd"
		resultType="sjbb">
		select
		sck_shzt v_0,gydw v_1,xzqhmc v_2,sddm v_3,sdmc v_4,sdzxzh v_5,lxbm v_6,lxmc
		v_7,pddj v_8,xjgjnd v_9,xmnf v_10,sck_jsxz v_11,xmk_bhsd.xmmc v_12
		from sck_bhsd t join xmk_bhsd on xmkid=xmk_bhsd.id where 1=1 and
			sck_sbthcd=7
			and sck_sbthcd>=#{sck_sbthcd} 
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		<if test="sck_shzt!='' and sck_shzt!= null ">
			and sck_shzt like '%'||(#{sck_shzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sddm!='' and sddm!= null ">
			and sddm like '%'||(#{sddm})||'%'
		</if>
	</select>
	<select id="exportExcel_bhsd_scsd" parameterType="sckbhsd"
		resultType="sjbb">
		select
		decode(sck_sdzt,0,'未审定','已审定') v_0,gydw v_1,xzqhmc v_2,sddm v_3,sdmc v_4,sdzxzh v_5,lxbm v_6,lxmc
		v_7,pddj v_8,xjgjnd v_9,xmnf v_10,sck_jsxz v_11,xmk_bhsd.xmmc v_12
		from sck_bhsd t join xmk_bhsd on xmkid=xmk_bhsd.id where 1=1 and
			sck_sbthcd=2
			and sck_sbthcd>=#{sck_sbthcd} 
<!--         <if test="xtType!='' and xtType!= null "> -->
<!-- 			${xtType} -->
<!-- 		</if> -->
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="lxmc!='' and lxmc!= null ">
			and lxmc like '%'||(#{lxmc})||'%'
		</if>
		<if test="sdmc!='' and sdmc!= null ">
			and sdmc like '%'||(#{sdmc})||'%'
		</if>
		<if test="sck_xmnf!='' and sck_xmnf!= null ">
			and sck_xmnf like '%'||(#{sck_xmnf})||'%'
		</if>
		<if test="sck_sdzt!='' and sck_sdzt!= null ">
			and sck_sdzt like '%'||(#{sck_sdzt})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="acdfl!='' and acdfl!= null ">
			and acdfl=#{acdfl}
		</if>
 		<if test="lxbm!='' and lxbm!= null ">
			and lxbm like '%'||(#{lxbm})||'%'
		</if>
		<if test="sddm!='' and sddm!= null ">
			and sddm like '%'||(#{sddm})||'%'
		</if>
	</select>
	<select id="insertToSheet" resultType="sjbb" parameterType="hashMap">
		select
		qlbh v_0,qlmc v_1,qlzxzh v_2,lxbm v_3,qlqc v_4,qlkd v_5
		from xmk_bhsd where shzt='已审核'
		and id not in (select xmkid from sck_bhsd)
		<if test="tbdw!=null and tbdw!=''">
		and tbbmbm like #{tbdw}||'%'
	</if>
	</select>
	<insert id="importBhsd_sc" parameterType="hashMap">
		insert into
		sck_bhsd(sckid,xmkid,spdw,sjdw,spwh,tzgs,sck_xmnf,sck_jsxz,zyjsnr,scbz,sck_sbzt,sck_shzt,sck_sddm,sck_sdzxzh,sck_lxbm,scbmbm,sck_sbthcd,lrjh)
		values(sys_guid(),(select ID from xmk_bhsd where sddm=trim(#{0}) and sdmc=trim(#{1})),
		#{7},#{8},#{9},#{10},#{11},#{12},#{13},#{14},'未上报','未审核',#{0},#{2},#{3},#{scbmbm},#{sck_sbthcd},'未列入')
	</insert>
	<!--  列入计划-->
 
 <select id="lrjhWqgz" parameterType="sckbhsd" resultType="sckbhsd">
 	select * from (
 		select rownum num ,t.* from (select * from sck_bhsd t join xmk_bhsd on xmkid=xmk_bhsd.id where 1=1
 				) t 
 		where sck_shzt='已审核' and lrjh='未列入'
			and sck_sbthcd>=#{sck_sbthcd}
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
		<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf like '%'||(#{xmnf})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and akjfl like #{akjfl}||'%'
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
 			order by sck_shzt desc,lrjh desc
 </select>
  <select id="lrjhWqgzCount" parameterType="sckbhsd" resultType="int">
 		select count(*) from (select * from sck_bhsd t join xmk_bhsd on xmkid=xmk_bhsd.id where 1=1
 			)
 		 where sck_shzt='已审核' and lrjh='未列入'
			and sck_sbthcd>=#{sck_sbthcd}
<!-- 		<if test="scbmbm!='' and scbmbm!= null "> -->
<!-- 		   and scbmbm like '%'||(#{scbmbm})||'%' -->
<!-- 		</if> -->
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
			<if test="qlmc!='' and qlmc!= null ">
			and qlmc like '%'||(#{qlmc})||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and scxmnf like '%'||(#{xmnf})||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and jsdj like '%'||(#{jsdj})||'%'
		</if>
		<if test="akjfl!='' and akjfl!= null ">
			and akjfl like #{akjfl}||'%'
		</if>
		<if test="bzls!='' and bzls!= null ">
 			and bzls like #{bzls}||'%'
 		</if>
		<if test="qlbh!='' and qlbh!= null ">
			and qlbh like '%'||(#{qlbh})||'%'
		</if>
 </select>
 <update id="xgBhsdXmnf" parameterType="sckbhsd" >
 		update xmk_bhsd set sck_xmnf=#{sck_xmnf} where id=#{xmkid}
 </update>
</mapper>
