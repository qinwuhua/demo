<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxcsxm.tjbb">
	<select id="createBtTree" parameterType="elist" resultType="treenode">
	select 
	value id,text,state,(case when value not like '%v_%' then substr(id,0,length(id)-1)
	else id
	end) parent,id id1,xh
	from(
	select (case when value like '%v_%' then substr(value,0,instr(value,'v')-1) else value end) id,name text,'open' state,value,xh
	from ZDYBBBT where ssbb=#{ssbb} and value like #{treeno}||'%' 
	)
	order by (case when id like '%v_%' then id1||'v_' else id end), to_number(substr(id,instr(id, 'v') + 2)), xh
	</select>
	<select id="getZdyBbzd" parameterType="elist" resultType="elist">
	  select t2.value, t2.name, t1.co, t2.hight, t2.rowxh, t2.width
	  from (select substr1 value, count(*) co
	          from zdybbbt
	         where value in
	               (${name}) and ssbb=#{ssbb}
	         group by substr1
	        union all
	        select substr2 value, count(*) co
	          from zdybbbt
	         where value in
	               (${name}) and ssbb=#{ssbb}
	           and substr2 is not null
	         group by substr2
	        union all
	        select substr3 value, count(*) co
	          from zdybbbt
	         where value in
	               (${name}) and ssbb=#{ssbb}
	           and substr3 is not null
	         group by substr3
	        union all
	        select value, count(*) co
	          from zdybbbt
	         where value in
	               (${name}) and ssbb=#{ssbb}
	         group by value) t1,
	       zdybbbt t2
	 where t1.value = t2.value and ssbb=#{ssbb}
	 order by t2.xh
	</select>
	<select id="getJhzxqkb" parameterType="elist" resultType="elist">
		select rownum v_0,bb.* from(
			select distinct
			xd.jhxdwh v_1,xm.gydw v_2,xm.xmmc v_3,xm.ztz v_4,wc.wcl v_5,fun_char(wc.wctz,3) v_6,decode(wc.wctz,null,null,to_char(decode(xm.ztz,null,0,0,0,round(wc.wctz/decode(xm.ztz,0,99999999,xm.ztz)*100,2)),'fm9999999990.00')||'%') v_7,
			xd.ztz v_8,xd.cgs v_9,xd.rys v_10,xd.ttc v_11,xd.dfzc v_12,
			dw.ztz v_13,dw.cgs v_14,dw.rys v_15,dw.ttc v_16,dw.dfzc v_17,
			bf.ztz v_18,bf.cgs v_19,bf.rys v_20,bf.ttc v_21,bf.dfzc v_22,
			decode(dw.ztz,null,null,to_char(decode(xd.ztz,null,0,0,0,round(dw.ztz/xd.ztz*100,2)),'fm9999999990.00')||'%') v_23,
			decode(bf.ztz,null,null,to_char(decode(dw.ztz,null,0,0,0,round(bf.ztz/dw.ztz*100,2)),'fm9999999990.00')||'%') v_24,
			decode(substr(xm.gydwdm,0,1),'1',xm.gydwdm,substr(xm.gydwdm,0,9)||'00') gydwdm,substr(xm.xzqhdm,0,4)||'00' xzqhdm
			from
			(select xmid,jhxdwh,xdnf,sum(nvl(ztz,0)) ztz,
			sum(nvl(btzzj,0)) cgs,sum(nvl(rys,0)) rys,sum(nvl(ztz,0))-sum(nvl(btzzj,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)) ttc,sum(nvl(dfzc,0)) dfzc 
			from xm_gsd_jhxd where jhxdwh is not null group by xmid,jhxdwh,xdnf) xd,
			xmjbxx xm,xm_xmwc wc,
			(select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjdw <if test="bbsj != null and bbsj != ''">where to_date(dwyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) dw,
			(select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjbf <if test="bbsj != null and bbsj != ''">where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) bf
			where xd.xmid=xm.xmbm and xd.xmid=wc.xmbm(+) and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+) and xd.jhxdwh is not null and xd.jhxdwh!=' '
			and xm.gydwdm!='11101360000'
			<if test="jhnf != null">${jhnf}</if>
			<if test="gydwdm != null">${gydwdm}</if>
			<if test="xzqhdm != null">${xzqhdm}</if>
			<if test="jhxdwh != null">${jhxdwh}</if>
			<if test="xmlx != null">${xmlx}</if>
			<if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
			order by gydwdm
		)bb
	</select>
	
	<select id="getJhzxqkbWh" parameterType="elist" resultType="elist">
		
			select distinct
			xd.jhxdwh v_1,xm.gydw v_2,xm.xmmc v_3,xm.ztz v_4,wc.wcl v_5,fun_char(wc.wctz,3) v_6,decode(wc.wctz,null,null,to_char(decode(xm.ztz,null,0,0,0,round(wc.wctz/decode(xm.ztz,0,99999999,xm.ztz)*100,2)),'fm9999999990.00')||'%') v_7,
			xd.ztz v_8,xd.cgs v_9,xd.rys v_10,xd.ttc v_11,xd.dfzc v_12,
			dw.ztz v_13,dw.cgs v_14,dw.rys v_15,dw.ttc v_16,dw.dfzc v_17,
			bf.ztz v_18,bf.cgs v_19,bf.rys v_20,bf.ttc v_21,bf.dfzc v_22,
			decode(dw.ztz,null,null,to_char(decode(xd.ztz,null,0,0,0,round(dw.ztz/xd.ztz*100,2)),'fm9999999990.00')||'%') v_23,
			decode(bf.ztz,null,null,to_char(decode(dw.ztz,null,0,0,0,round(bf.ztz/dw.ztz*100,2)),'fm9999999990.00')||'%') v_24,
			xm.gydwdm,substr(xm.xzqhdm,0,4)||'00' xzqhdm
			from
			(select xmid,jhxdwh,xdnf,sum(nvl(ztz,0)) ztz,
			sum(nvl(btzzj,0)) cgs,sum(nvl(rys,0)) rys,sum(nvl(ztz,0))-sum(nvl(btzzj,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)) ttc,sum(nvl(dfzc,0)) dfzc 
			from xm_gsd_jhxd where jhxdwh is not null group by xmid,jhxdwh,xdnf) xd,
			xmjbxx xm,xm_xmwc wc,
			(select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjdw <if test="bbsj != null and bbsj != ''">where to_date(dwyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) dw,
			(select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjbf <if test="bbsj != null and bbsj != ''">where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) bf
			where xd.xmid=xm.xmbm and xd.xmid=wc.xmbm(+) and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+) and xd.jhxdwh is not null and xd.jhxdwh!=' '
			and xm.gydwdm!='11101360000'
			<if test="jhnf != null">${jhnf}</if>
			<if test="gydwdm != null">${gydwdm}</if>
			<if test="xzqhdm != null">${xzqhdm}</if>
			<if test="jhxdwh != null">${jhxdwh}</if>
			<if test="xmlx != null">${xmlx}</if>
			<if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
			order by gydwdm,v_1
		
	</select>
	
	<select id="getJhzxqkbXm" parameterType="elist" resultType="elist">
		
			select distinct
			xd.jhxdwh v_1,xm.gydw v_2,xm.xmmc v_3,xm.ztz v_4,wc.wcl v_5,fun_char(wc.wctz,3) v_6,decode(wc.wctz,null,null,to_char(decode(xm.ztz,null,0,0,0,round(wc.wctz/decode(xm.ztz,0,99999999,xm.ztz)*100,2)),'fm9999999990.00')||'%') v_7,
			xd.ztz v_8,xd.cgs v_9,xd.rys v_10,xd.ttc v_11,xd.dfzc v_12,
			dw.ztz v_13,dw.cgs v_14,dw.rys v_15,dw.ttc v_16,dw.dfzc v_17,
			bf.ztz v_18,bf.cgs v_19,bf.rys v_20,bf.ttc v_21,bf.dfzc v_22,
			decode(dw.ztz,null,null,to_char(decode(xd.ztz,null,0,0,0,round(dw.ztz/xd.ztz*100,2)),'fm9999999990.00')||'%') v_23,
			decode(bf.ztz,null,null,to_char(decode(dw.ztz,null,0,0,0,round(bf.ztz/dw.ztz*100,2)),'fm9999999990.00')||'%') v_24,
			xm.gydwdm,substr(xm.xzqhdm,0,4)||'00' xzqhdm,xm.xmbm
			from
			(select xmid,jhxdwh,xdnf,sum(nvl(ztz,0)) ztz,
			sum(nvl(btzzj,0)) cgs,sum(nvl(rys,0)) rys,sum(nvl(ztz,0))-sum(nvl(btzzj,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)) ttc,sum(nvl(dfzc,0)) dfzc 
			from xm_gsd_jhxd where jhxdwh is not null group by xmid,jhxdwh,xdnf) xd,
			xmjbxx xm,xm_xmwc wc,
			(select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjdw <if test="bbsj != null and bbsj != ''">where to_date(dwyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) dw,
			(select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjbf <if test="bbsj != null and bbsj != ''">where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) bf
			where xd.xmid=xm.xmbm and xd.xmid=wc.xmbm(+) and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+) and xd.jhxdwh is not null and xd.jhxdwh!=' '
			and xm.gydwdm!='11101360000'
			<if test="jhnf != null">${jhnf}</if>
			<if test="gydwdm != null">${gydwdm}</if>
			<if test="xzqhdm != null">${xzqhdm}</if>
			<if test="jhxdwh != null">${jhxdwh}</if>
			<if test="xmlx != null">${xmlx}</if>
			<if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
			order by gydwdm,xmbm
		
	</select>
	
	<select id="getJhzxqkbzHj" parameterType="elist" resultType="elist">
	  select count(distinct xm.xmbm) xmsl,'36' gydwdm,'合计' v_1,
      nvl(sum(xm.ztz),0) v_4,nvl(sum(wc.wcl),0) v_5,nvl(sum(fun_char(wc.wctz,3)),0) v_6,
      nvl(to_char(decode(nvl(sum(xm.ztz),0),null,'0','0','0',round(nvl(sum(fun_char(wc.wctz,3)),0)/nvl(sum(xm.ztz),0)*100,2))),'0')||'%' v_7,
      nvl(sum(xd.ztz),0) v_8,nvl(sum(xd.cgs),0) v_9,nvl(sum(xd.rys),0) v_10,
      nvl(sum(xd.ttc),0) v_11,nvl(sum(xd.dfzc),0) v_12,nvl(sum(dw.ztz),0) v_13,
      nvl(sum(dw.cgs),0) v_14,nvl(sum(dw.rys),0) v_15,nvl(sum(dw.ttc),0) v_16,
      nvl(sum(dw.dfzc),0) v_17,nvl(sum(bf.ztz),0) v_18,nvl(sum(bf.cgs),0) v_19,
      nvl(sum(bf.rys),0) v_20,nvl(sum(bf.ttc),0) v_21,nvl(sum(bf.dfzc),0) v_22,
      decode(nvl(sum(dw.ztz),0),null,null,to_char(decode(nvl(sum(xd.ztz),0),null,0,0,0,round(nvl(sum(dw.ztz),0)/nvl(sum(xd.ztz),0)*100,2)),'fm9999999990.00')||'%') v_23,
      decode(nvl(sum(bf.ztz),0),null,null,to_char(decode(nvl(sum(dw.ztz),0),null,0,0,0,round(nvl(sum(bf.ztz),0)/nvl(sum(dw.ztz),0)*100,2)),'fm9999999990.00')||'%') v_24
      from
      (select xmid,jhxdwh,xdnf,sum(nvl(ztz,0)) ztz,
      sum(nvl(btzzj,0)) cgs,sum(nvl(rys,0)) rys,sum(nvl(ztz,0))-sum(nvl(btzzj,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)) ttc,sum(nvl(dfzc,0)) dfzc 
      from xm_gsd_jhxd where jhxdwh is not null group by xmid,jhxdwh,xdnf) xd,
      xmjbxx xm,xm_xmwc wc,
      (select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjdw  group by xmbm,jhxdwh) dw,
      (select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjbf  group by xmbm,jhxdwh) bf
      where xd.xmid=xm.xmbm and xd.xmid=wc.xmbm(+) and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+) and xd.jhxdwh is not null and xd.jhxdwh!=' '
      and xm.gydwdm!='11101360000'
      <if test="xzqhdm != null">${xzqhdm}</if>
      <if test="jhnf != null">${jhnf}</if>
      <if test="gydwdm != null">${gydwdm}</if>
      <if test="jhxdwh != null">${jhxdwh}</if>
      <if test="xmlx != null">${xmlx}</if>
      <if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
	</select>
	
	
	<select id="getJhzxqkbHj" parameterType="elist" resultType="elist">
	  select count(distinct xm.xmbm) xmsl,decode(substr(xm.gydwdm,0,1),'1',xm.gydwdm,substr(xm.gydwdm,0,9)||'00') gydwdm,min(gydw)||'合计' v_1,
      nvl(sum(xm.ztz),0) v_4,nvl(sum(wc.wcl),0) v_5,nvl(sum(fun_char(wc.wctz,3)),0) v_6,
      nvl(to_char(decode(nvl(sum(xm.ztz),0),null,'0','0','0',round(nvl(sum(fun_char(wc.wctz,3)),0)/nvl(sum(xm.ztz),0)*100,2))),'0')||'%' v_7,
      nvl(sum(xd.ztz),0) v_8,nvl(sum(xd.cgs),0) v_9,nvl(sum(xd.rys),0) v_10,
      nvl(sum(xd.ttc),0) v_11,nvl(sum(xd.dfzc),0) v_12,nvl(sum(dw.ztz),0) v_13,
      nvl(sum(dw.cgs),0) v_14,nvl(sum(dw.rys),0) v_15,nvl(sum(dw.ttc),0) v_16,
      nvl(sum(dw.dfzc),0) v_17,nvl(sum(bf.ztz),0) v_18,nvl(sum(bf.cgs),0) v_19,
      nvl(sum(bf.rys),0) v_20,nvl(sum(bf.ttc),0) v_21,nvl(sum(bf.dfzc),0) v_22,
      decode(nvl(sum(dw.ztz),0),null,null,to_char(decode(nvl(sum(xd.ztz),0),null,0,0,0,round(nvl(sum(dw.ztz),0)/nvl(sum(xd.ztz),0)*100,2)),'fm9999999990.00')||'%') v_23,
      decode(nvl(sum(bf.ztz),0),null,null,to_char(decode(nvl(sum(dw.ztz),0),null,0,0,0,round(nvl(sum(bf.ztz),0)/nvl(sum(dw.ztz),0)*100,2)),'fm9999999990.00')||'%') v_24
      from
      (select xmid,jhxdwh,xdnf,sum(nvl(ztz,0)) ztz,
      sum(nvl(btzzj,0)) cgs,sum(nvl(rys,0)) rys,sum(nvl(ztz,0))-sum(nvl(btzzj,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)) ttc,sum(nvl(dfzc,0)) dfzc 
      from xm_gsd_jhxd where jhxdwh is not null group by xmid,jhxdwh,xdnf) xd,
      xmjbxx xm,xm_xmwc wc,
      (select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjdw <if test="bbsj != null and bbsj != ''">where to_date(dwyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) dw,
      (select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjbf <if test="bbsj != null and bbsj != ''">where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) bf
      where xd.xmid=xm.xmbm and xd.xmid=wc.xmbm(+) and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+) and xd.jhxdwh is not null and xd.jhxdwh!=' '
      and xm.gydwdm!='11101360000'
      <if test="xzqhdm != null">${xzqhdm}</if>
      <if test="jhnf != null">${jhnf}</if>
      <if test="gydwdm != null">${gydwdm}</if>
      <if test="jhxdwh != null">${jhxdwh}</if>
      <if test="xmlx != null">${xmlx}</if>
      <if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
      group by decode(substr(xm.gydwdm,0,1),'1',xm.gydwdm,substr(xm.gydwdm,0,9)||'00') order by gydwdm
	</select>
	
	<select id="getJhzxqkbWhHj" parameterType="elist" resultType="elist">
	  select count(distinct xm.xmbm) xmsl,decode(substr(xm.gydwdm,0,1),'1',xm.gydwdm,substr(xm.gydwdm,0,9)||'00') gydwdm,xd.jhxdwh||'合计' v_1,
      nvl(sum(xm.ztz),0) v_4,nvl(sum(wc.wcl),0) v_5,nvl(sum(fun_char(wc.wctz,3)),0) v_6,
      nvl(to_char(decode(nvl(sum(xm.ztz),0),null,'0','0','0',round(nvl(sum(fun_char(wc.wctz,3)),0)/nvl(sum(xm.ztz),0)*100,2))),'0')||'%' v_7,
      nvl(sum(xd.ztz),0) v_8,nvl(sum(xd.cgs),0) v_9,nvl(sum(xd.rys),0) v_10,
      nvl(sum(xd.ttc),0) v_11,nvl(sum(xd.dfzc),0) v_12,nvl(sum(dw.ztz),0) v_13,
      nvl(sum(dw.cgs),0) v_14,nvl(sum(dw.rys),0) v_15,nvl(sum(dw.ttc),0) v_16,
      nvl(sum(dw.dfzc),0) v_17,nvl(sum(bf.ztz),0) v_18,nvl(sum(bf.cgs),0) v_19,
      nvl(sum(bf.rys),0) v_20,nvl(sum(bf.ttc),0) v_21,nvl(sum(bf.dfzc),0) v_22,
      decode(nvl(sum(dw.ztz),0),null,null,to_char(decode(nvl(sum(xd.ztz),0),null,0,0,0,round(nvl(sum(dw.ztz),0)/nvl(sum(xd.ztz),0)*100,2)),'fm9999999990.00')||'%') v_23,
      decode(nvl(sum(bf.ztz),0),null,null,to_char(decode(nvl(sum(dw.ztz),0),null,0,0,0,round(nvl(sum(bf.ztz),0)/nvl(sum(dw.ztz),0)*100,2)),'fm9999999990.00')||'%') v_24
      from
      (select xmid,jhxdwh,xdnf,sum(nvl(ztz,0)) ztz,
      sum(nvl(btzzj,0)) cgs,sum(nvl(rys,0)) rys,sum(nvl(ztz,0))-sum(nvl(btzzj,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)) ttc,sum(nvl(dfzc,0)) dfzc 
      from xm_gsd_jhxd where jhxdwh is not null group by xmid,jhxdwh,xdnf) xd,
      xmjbxx xm,xm_xmwc wc,
      (select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjdw <if test="bbsj != null and bbsj != ''">where to_date(dwyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) dw,
      (select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjbf <if test="bbsj != null and bbsj != ''">where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) bf
      where xd.xmid=xm.xmbm and xd.xmid=wc.xmbm(+) and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+) and xd.jhxdwh is not null and xd.jhxdwh!=' '
      and xm.gydwdm!='11101360000'
      <if test="xzqhdm != null">${xzqhdm}</if>
      <if test="jhnf != null">${jhnf}</if>
      <if test="gydwdm != null">${gydwdm}</if>
      <if test="jhxdwh != null">${jhxdwh}</if>
      <if test="xmlx != null">${xmlx}</if>
      <if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
      group by decode(substr(xm.gydwdm,0,1),'1',xm.gydwdm,substr(xm.gydwdm,0,9)||'00'),xd.jhxdwh order by gydwdm,xd.jhxdwh
	</select>
	
	<select id="getJhzxqkbXmHj" parameterType="elist" resultType="elist">
      select count(distinct xm.xmbm) xmsl,decode(substr(xm.gydwdm,0,1),'1',xm.gydwdm,substr(xm.gydwdm,0,9)||'00') gydwdm,min(xm.xmmc)||'合计' v_1,
      nvl(sum(xm.ztz),0) v_4,nvl(sum(wc.wcl),0) v_5,nvl(sum(fun_char(wc.wctz,3)),0) v_6,
      nvl(to_char(decode(nvl(sum(xm.ztz),0),null,'0','0','0',round(nvl(sum(fun_char(wc.wctz,3)),0)/nvl(sum(xm.ztz),0)*100,2))),'0')||'%' v_7,
      nvl(sum(xd.ztz),0) v_8,nvl(sum(xd.cgs),0) v_9,nvl(sum(xd.rys),0) v_10,
      nvl(sum(xd.ttc),0) v_11,nvl(sum(xd.dfzc),0) v_12,nvl(sum(dw.ztz),0) v_13,
      nvl(sum(dw.cgs),0) v_14,nvl(sum(dw.rys),0) v_15,nvl(sum(dw.ttc),0) v_16,
      nvl(sum(dw.dfzc),0) v_17,nvl(sum(bf.ztz),0) v_18,nvl(sum(bf.cgs),0) v_19,
      nvl(sum(bf.rys),0) v_20,nvl(sum(bf.ttc),0) v_21,nvl(sum(bf.dfzc),0) v_22,
      decode(nvl(sum(dw.ztz),0),null,null,to_char(decode(nvl(sum(xd.ztz),0),null,0,0,0,round(nvl(sum(dw.ztz),0)/nvl(sum(xd.ztz),0)*100,2)),'fm9999999990.00')||'%') v_23,
      decode(nvl(sum(bf.ztz),0),null,null,to_char(decode(nvl(sum(dw.ztz),0),null,0,0,0,round(nvl(sum(bf.ztz),0)/nvl(sum(dw.ztz),0)*100,2)),'fm9999999990.00')||'%') v_24
    
      from
      (select xmid,jhxdwh,xdnf,sum(nvl(ztz,0)) ztz,
      sum(nvl(btzzj,0)) cgs,sum(nvl(rys,0)) rys,sum(nvl(ztz,0))-sum(nvl(btzzj,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)) ttc,sum(nvl(dfzc,0)) dfzc 
      from xm_gsd_jhxd where jhxdwh is not null group by xmid,jhxdwh,xdnf) xd,
      xmjbxx xm,xm_xmwc wc,
      (select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjdw <if test="bbsj != null and bbsj != ''">where to_date(dwyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) dw,
      (select xmbm,jhxdwh,sum(ztz) ztz,sum(cgs) cgs,sum(rys) rys,decode(sum(nvl(ttc,0)),0, sum(nvl(ztz,0))-sum(nvl(cgs,0))-sum(nvl(rys,0))-sum(nvl(dfzc,0)),sum(nvl(ttc,0))) ttc,sum(dfzc) dfzc from xm_zjbf <if test="bbsj != null and bbsj != ''">where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{bbsj},'yyyy-mm')</if>  group by xmbm,jhxdwh) bf
      where xd.xmid=xm.xmbm and xd.xmid=wc.xmbm(+) and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+) and xd.jhxdwh is not null and xd.jhxdwh!=' '
      and xm.gydwdm!='11101360000'
      <if test="xzqhdm != null">${xzqhdm}</if>
      <if test="jhnf != null">${jhnf}</if>
      <if test="gydwdm != null">${gydwdm}</if>
      <if test="jhxdwh != null">${jhxdwh}</if>
      <if test="xmlx != null">${xmlx}</if>
      <if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
      group by decode(substr(xm.gydwdm,0,1),'1',xm.gydwdm,substr(xm.gydwdm,0,9)||'00'),xmbm order by gydwdm,xmbm
	</select>
	
	
	<select id="getTzhzb" parameterType="elist" resultType="elist">
		select rownum v_0,bb.* from
		(select xm.xmmc v_1,xd.jhxdwh v_2,xm.ztz v_3,nvl(xd.ztz,0) v_4,nvl(xd.btzzj,0) v_5,nvl(xd.rys,0) v_6,nvl(xd.ztz,0)-nvl(xd.btzzj,0)-nvl(xd.rys,0)-nvl(xd.dfzc,0) v_7,nvl(xd.dfzc,0) v_8,
		dw.sn v_9,dw.bn v_10,dw.ztz v_11,bf.sn v_12,bf.bn v_13,bf.ztz v_14,nvl(xd.ztz,0)-nvl(dw.ztz,0) v_15,nvl(dw.ztz,0)-nvl(bf.ztz,0) v_16,' ' v_17,substr(xm.xzqhdm,0,4)||'00' xzqhdm
		
		 from xmjbxx xm,xm_gsd_jhxd xd,
		(select xmbm,jhxdwh,sum(decode(substr(dwyf,0,4),to_char(${jhnf}-1),ztz,0)) sn,sum(decode(substr(dwyf,0,4),to_char(${jhnf}),ztz,0)) bn,sum(ztz) ztz  from xm_zjdw group by xmbm,jhxdwh) dw,
		(select xmbm,jhxdwh,sum(decode(substr(bfyf,0,4),to_char(${jhnf}-1),ztz,0)) sn,sum(decode(substr(bfyf,0,4),to_char(${jhnf}),ztz,0)) bn,sum(ztz) ztz  from xm_zjbf group by xmbm,jhxdwh) bf
		where xm.xmbm=xd.xmid and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+)
			<if test="xzqhdm != null">${xzqhdm}</if>
			<if test="jhxdwh != null">${jhxdwh}</if>
			<if test="gydw != null">and xm.gydwdm like #{gydw}||'%'</if>
			<if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmlx != null">${xmlx}</if>
		and xd.jhxdwh is not null and xd.jhxdwh!=' '
		order by xzqhdm,xd.xdnf,xd.jhxdwh)bb 
	</select>
	
	<select id="getTzhzbHj" parameterType="elist" resultType="elist">
		select 
		xzqhdm,(select name from xtgl_xzqh where id=xzqhdm)||'合计' v_1,
		nvl(sum(v_3),0) v_3,nvl(sum(v_4),0) v_4,nvl(sum(v_5),0) v_5,
		nvl(sum(v_6),0) v_6,nvl(sum(v_7),0) v_7,nvl(sum(v_8),0) v_8,
		nvl(sum(v_9),0) v_9,nvl(sum(v_10),0) v_10,nvl(sum(v_11),0) v_11,
		nvl(sum(v_12),0) v_12,nvl(sum(v_13),0) v_13,nvl(sum(v_14),0) v_14,
		nvl(sum(v_15),0) v_15,nvl(sum(v_16),0) v_16
		
		from 
		(
		select rownum v_0,bb.* from
		(select xm.xmmc v_1,xd.jhxdwh v_2,xm.ztz v_3,nvl(xd.ztz,0) v_4,nvl(xd.btzzj,0) v_5,nvl(xd.rys,0) v_6,nvl(xd.ztz,0)-nvl(xd.btzzj,0)-nvl(xd.rys,0)-nvl(xd.dfzc,0) v_7,nvl(xd.dfzc,0) v_8,
		dw.sn v_9,dw.bn v_10,dw.ztz v_11,bf.sn v_12,bf.bn v_13,bf.ztz v_14,nvl(xd.ztz,0)-nvl(dw.ztz,0) v_15,nvl(dw.ztz,0)-nvl(bf.ztz,0) v_16,' ' v_17,substr(xm.xzqhdm,0,4)||'00' xzqhdm
		from xmjbxx xm,xm_gsd_jhxd xd,
		(select xmbm,jhxdwh,sum(decode(substr(dwyf,0,4),to_char(${jhnf}-1),ztz,0)) sn,sum(decode(substr(dwyf,0,4),to_char(${jhnf}),ztz,0)) bn,sum(ztz) ztz  from xm_zjdw group by xmbm,jhxdwh) dw,
		(select xmbm,jhxdwh,sum(decode(substr(bfyf,0,4),to_char(${jhnf}-1),ztz,0)) sn,sum(decode(substr(bfyf,0,4),to_char(${jhnf}),ztz,0)) bn,sum(ztz) ztz  from xm_zjbf group by xmbm,jhxdwh) bf
		where xm.xmbm=xd.xmid and xd.xmid=dw.xmbm(+) and xd.xmid=bf.xmbm(+) and xd.jhxdwh=dw.jhxdwh(+) and xd.jhxdwh=bf.jhxdwh(+)
			<if test="xzqhdm != null">${xzqhdm}</if>
			<if test="gydw != null">and xm.gydwdm like #{gydw}||'%'</if>
			<if test="jhxdwh != null">${jhxdwh}</if>
			<if test="xmmc != null">and xm.xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmlx != null">${xmlx}</if>
		and xd.jhxdwh is not null and xd.jhxdwh!=' '
		order by xd.xdnf,xd.jhxdwh)bb
		) group by xzqhdm order by xzqhdm
		
	</select>
	
	
	<select id="queryXmlist" parameterType="xmjbxx" resultType="xmjbxx">
		select * from(select rownum num ,t1.* from(select t.*,xd.jhxdwh,xsbzt,ssbzt,shzt,nvl(xsbztstr,'未填写') xsbztstr,nvl(ssbztstr,'未填写') ssbztstr,nvl(shztstr,'未填写') shztstr  from xmjbxx t
		left join(select xmid,replace(WMSYS.WM_CONCAT(distinct jhxdwh),',',',') jhxdwh from xm_gsd_jhxd group by xmid) xd
		on t.xmbm=xd.xmid	
		left join(
	    select xmbm xmids,sum(decode(xsbzt,'未上报',1,0)) xsbzt,sum(decode(ssbzt,'未上报',1,0)) ssbzt,sum(decode(shzt,'未审核',1,0)) shzt,
		(case when replace(WMSYS.WM_CONCAT(xsbzt),',',',') like '%未上报%' then '未上报' else '已上报' end) xsbztstr,
		(case when replace(WMSYS.WM_CONCAT(ssbzt),',',',') like '%未上报%' then '未上报' else '已上报' end) ssbztstr,
		(case when replace(WMSYS.WM_CONCAT(shzt),',',',') like '%未审核%' then '未审核' else '已审核' end) shztstr
		from xm_zjdw group by xmbm) dw on t.xmbm=dw.xmids
		where 1=1 
		<if test="xzqh !='' and xzqh != null">${xzqh}</if>
		<if test="gydw != null">and t.gydwdm like #{gydw}||'%'</if>
		<if test="xmnf !='' and xmnf != null">${xmnf}</if>
		<if test="jsxz !='' and jsxz != null">${jsxz}</if>
		<if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if>
		<if test="gcfl !='' and gcfl != null">${gcfl}</if>
		<if test="xmbm !='' and xmbm != null">and xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmmc !='' and xmmc != null">and xmmc like '%'||#{xmmc}||'%'</if>
		) t1 where 1=1
		<if test="shzt !='' and shzt != null">${shzt}</if>
		<if test="ssbzt !='' and ssbzt != null">${ssbzt}</if>
		<if test="xsbzt !='' and xsbzt != null">${xsbzt}</if>
		and rownum &lt;=(#{page} * #{rows}) 
		order by decode(xsbzt,null,0,xsbzt) desc,decode(ssbzt,null,0,ssbzt) desc,decode(shzt,null,0,shzt) desc,xmnf
		)t2
		where t2.num>(#{page}-1)*#{rows}
		
	</select>
	<select id="queryXmlistCount" parameterType="xmjbxx" resultType="int">
		select count(*) from(select t.*,xd.jhxdwh,xsbzt,ssbzt,shzt,nvl(xsbztstr,'未填写') xsbztstr,nvl(ssbztstr,'未填写') ssbztstr,nvl(shztstr,'未填写') shztstr  from xmjbxx t
		left join(select xmid,replace(WMSYS.WM_CONCAT(distinct jhxdwh),',',',') jhxdwh from xm_gsd_jhxd group by xmid) xd
		on t.xmbm=xd.xmid	
		left join(
	    select xmbm xmids,sum(decode(xsbzt,'未上报',1,0)) xsbzt,sum(decode(ssbzt,'未上报',1,0)) ssbzt,sum(decode(shzt,'未审核',1,0)) shzt,
		(case when replace(WMSYS.WM_CONCAT(xsbzt),',',',') like '%未上报%' then '未上报' else '已上报' end) xsbztstr,
		(case when replace(WMSYS.WM_CONCAT(ssbzt),',',',') like '%未上报%' then '未上报' else '已上报' end) ssbztstr,
		(case when replace(WMSYS.WM_CONCAT(shzt),',',',') like '%未审核%' then '未审核' else '已审核' end) shztstr
		from xm_zjdw group by xmbm) dw on t.xmbm=dw.xmids
		where 1=1 
		<if test="xzqh !='' and xzqh != null">${xzqh}</if>
		<if test="gydw != null">and t.gydwdm like #{gydw}||'%'</if>
		<if test="xmnf !='' and xmnf != null">${xmnf}</if>
		<if test="jsxz !='' and jsxz != null">${jsxz}</if>
		<if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if>
		<if test="gcfl !='' and gcfl != null">${gcfl}</if>
		<if test="xmbm !='' and xmbm != null">and xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmmc !='' and xmmc != null">and xmmc like '%'||#{xmmc}||'%'</if>
		) where 1=1
		<if test="shzt !='' and shzt != null">${shzt}</if>
		<if test="ssbzt !='' and ssbzt != null">${ssbzt}</if>
		<if test="xsbzt !='' and xsbzt != null">${xsbzt}</if>
	</select>
	
	<select id="getTzmxbbtdw" parameterType="elist" resultType="elist">
		select distinct dwyf v_0 from xm_zjdw where 
		1=1
		and xmbm=#{xmbm} 
		and substr(dwyf,0,4)=#{jhnf}
		 order by v_0
	</select>
	<select id="getTzmxbbtbf" parameterType="elist" resultType="elist">
		select distinct bfyf v_0 from xm_zjbf where 
		1=1
		and xmbm=#{xmbm} 
		and substr(bfyf,0,4)=#{jhnf}
		 order by v_0
	</select>
	<select id="queryListBySql" parameterType="elist" resultType="elist">
	 ${sql}
	</select>
	
	<select id="getGlzcqkb" parameterType="elist" resultType="elist">
	select v_0,v_1,v_2,rownum v_3,to_char(v_4,'99990.999') v_4,to_char(v_5,'99990.999') v_5,
	to_char(v_6,'99990.999') v_6,to_char(v_7,'99990.999') v_7,to_char(v_8,'99990.9999') v_8,
	to_char(v_9,'99990.9999') v_9,to_char(v_10,'99990.9999') v_10,to_char(v_11,'99990.9999') v_11 from (	
	select 
	'合计' v_0,jsdj v_1,'公里' v_2,lcqcs v_4,
	(case when lcqms-lcqcs>0 then lcqms-lcqcs else 0 end) v_5,
	(case when lcqcs-lcqms>0 then lcqcs-lcqms else 0 end) v_6,
	lcqms v_7,zcqcs v_8,zcqms v_9,fzqcs v_10,fzqms v_11,1 px
	
	from (
	select '合计'jsdj,sum(decode(nf,'2016',lc,(select sum(lc) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) lcqcs,
	sum(lc) lcqms,
	sum(decode(nf,'2016',zcqcs,(select sum(zcqms) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) zcqcs,
	sum(zcqms) zcqms,
	sum(decode(nf,'2016',fzqcs,(select sum(fzqms) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) fzqcs,
	sum(fzqms) fzqms,
	1 px
	from zcgl z 
	where nf=#{nf}
	<if test="gydw != null">
	${gydw}
	</if>
	)
	
	union all
	
	select 
	'等级公路' v_0,jsdj v_1,'公里' v_2,lcqcs v_4,
	(case when lcqms-lcqcs>0 then lcqms-lcqcs else 0 end) v_5,
	(case when lcqcs-lcqms>0 then lcqcs-lcqms else 0 end) v_6,
	lcqms v_7,zcqcs v_8,zcqms v_9,fzqcs v_10,fzqms v_11,2 px
	
	from (
	select '总计'jsdj,sum(decode(nf,'2016',lc,(select sum(lc) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) lcqcs,
	sum(lc) lcqms,
	sum(decode(nf,'2016',zcqcs,(select sum(zcqms) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) zcqcs,
	sum(zcqms) zcqms,
	sum(decode(nf,'2016',fzqcs,(select sum(fzqms) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) fzqcs,
	sum(fzqms) fzqms,
	2 px
	from zcgl z 
	where nf=#{nf}
	and (jsdj='高速公路' or jsdj='一级公路' or jsdj='二级公路' or jsdj='三级公路' or jsdj='四级公路')
	<if test="gydw != null">
	${gydw}
	</if>
	)
	
	union all
	
	select 
	decode(jsdj,'等外公路','等外公路','等级公路') v_0,jsdj v_1,'公里' v_2,lcqcs v_4,
	(case when lcqms-lcqcs>0 then lcqms-lcqcs else 0 end) v_5,
	(case when lcqcs-lcqms>0 then lcqcs-lcqms else 0 end) v_6,
	lcqms v_7,zcqcs v_8,zcqms v_9,fzqcs v_10,fzqms v_11,px
	
	from (
	select jsdj,sum(decode(nf,'2016',lc,(select sum(lc) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) lcqcs,
	sum(lc) lcqms,
	sum(decode(nf,'2016',zcqcs,(select sum(zcqms) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) zcqcs,
	sum(zcqms) zcqms,
	sum(decode(nf,'2016',fzqcs,(select sum(fzqms) from zcgl z1 where nf=to_char(${nf}-1) and z1.jsdj=z.jsdj ))) fzqcs,
	sum(fzqms) fzqms,
	min(decode(jsdj,'高速公路',3,'一级公路',4,'二级公路',5,'三级公路',6,'四级公路',7,'等外公路',8)) px
	from zcgl z 
	where nf=#{nf}
	<if test="gydw != null">
	${gydw}
	</if>
	group by jsdj
	)

	order by px
	) t
	</select>
	
	<delete id="deleteTjbb" parameterType="hashMap">
		DELETE FROM YY2CSBB WHERE NF=#{NF} AND YF=#{YF} AND GYDW=#{GYDW} AND XMLX=#{XMLX}
	</delete>
	<insert id="importTjbb" parameterType="hashMap">
	insert into YY2CSBB
	    <trim prefix="(" suffix=")" suffixOverrides="," >
	      <if test="GYDW != null and GYDW != ''" >GYDW,</if>
	      <if test="NF != null and NF != ''" >NF,</if>
	      <if test="YF != null and YF != ''" >YF,</if>
	      <if test="XMLX != null and XMLX != ''" >XMLX,</if>
	      <if test="XH != null and XH != ''" >XH,</if>
	      <if test="V_0 != null and V_0 != ''" >V_0,</if>
	      <if test="V_1 != null and V_1 != ''" >V_1,</if>
	      <if test="V_2 != null and V_2 != ''" >V_2,</if>
	      <if test="V_3 != null and V_3 != ''" >V_3,</if>
	      <if test="V_4 != null and V_4 != ''" >V_4,</if>
	      <if test="V_5 != null and V_5 != ''" >V_5,</if>
	      <if test="V_6 != null and V_6 != ''" >V_6,</if>
	      <if test="V_7 != null and V_7 != ''" >V_7,</if>
	      <if test="V_8 != null and V_8 != ''" >V_8,</if>
	      <if test="V_9 != null and V_9 != ''" >V_9,</if>
	      <if test="V_10 != null and V_10 != ''" >V_10,</if>
	      <if test="V_11 != null and V_11 != ''" >V_11,</if>
	      <if test="V_12 != null and V_12 != ''" >V_12,</if>
	      <if test="V_13 != null and V_13 != ''" >V_13,</if>
	      <if test="V_14 != null and V_14 != ''" >V_14,</if>
	      <if test="V_15 != null and V_15 != ''" >V_15,</if>
	      <if test="V_16 != null and V_16 != ''" >V_16,</if>
	      <if test="V_17 != null and V_17 != ''" >V_17,</if>
	      <if test="V_18 != null and V_18 != ''" >V_18,</if>
	      <if test="V_19 != null and V_19 != ''" >V_19,</if>
	      
	    </trim>
	    <trim prefix="values (" suffix=")" suffixOverrides="," >
	      <if test="GYDW != null and GYDW != ''" >#{GYDW},</if>
	      <if test="NF != null and NF != ''" >#{NF},</if>
	      <if test="YF != null and YF != ''" >#{YF},</if>
	      <if test="XMLX != null and XMLX != ''" >#{XMLX},</if>
	      <if test="XH != null and XH != ''" >#{XH},</if>
	      <if test="V_0 != null and V_0 != ''" >#{V_0},</if>
	      <if test="V_1 != null and V_1 != ''" >#{V_1},</if>
	      <if test="V_2 != null and V_2 != ''" >#{V_2},</if>
	      <if test="V_3 != null and V_3 != ''" >#{V_3},</if>
	      <if test="V_4 != null and V_4 != ''" >#{V_4},</if>
	      <if test="V_5 != null and V_5 != ''" >#{V_5},</if>
	      <if test="V_6 != null and V_6 != ''" >#{V_6},</if>
	      <if test="V_7 != null and V_7 != ''" >#{V_7},</if>
	      <if test="V_8 != null and V_8 != ''" >#{V_8},</if>
	      <if test="V_9 != null and V_9 != ''" >#{V_9},</if>
	      <if test="V_10 != null and V_10 != ''" >#{V_10},</if>
	      <if test="V_11 != null and V_11 != ''" >#{V_11},</if>
	      <if test="V_12 != null and V_12 != ''" >#{V_12},</if>
	      <if test="V_13 != null and V_13 != ''" >#{V_13},</if>
	      <if test="V_14 != null and V_14 != ''" >#{V_14},</if>
	      <if test="V_15 != null and V_15 != ''" >#{V_15},</if>
	      <if test="V_16 != null and V_16 != ''" >#{V_16},</if>
	      <if test="V_17 != null and V_17 != ''" >#{V_17},</if>
	      <if test="V_18 != null and V_18 != ''" >#{V_18},</if>
	      <if test="V_19 != null and V_19 != ''" >#{V_19},</if>
	    </trim>
	
	</insert>
	<select id="getTjbbOfbzsrzcb" parameterType="elist" resultType="elist">
		SELECT 
		XH,MIN(V_0) V_0,FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_1),'1',0,V_1)),2) V_1,DECODE(MAX(V_2),'——','——',FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_2),'1',0,V_2)),2)) V_2		
		FROM YY2CSBB WHERE 1=1 AND XMLX=#{xmlx}
			<if test="gydw != null and gydw != ''">${gydw}</if>
			<if test="nf != null and nf != ''">AND NF = #{nf}</if>
			<if test="yf != null and yf != ''">${yf}</if>
			
		GROUP BY XH
		ORDER BY XH
	</select>
	<select id="getTjbbOfbycbb" parameterType="elist" resultType="elist">
		SELECT 
		XH,MIN(V_0) V_0,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_1),'1',0,v_1))),2)) v_1,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_2),'1',0,v_2))),2)) v_2,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_3),'1',0,v_3))),2)) v_3,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_4),'1',0,v_4))),2)) v_4,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_5),'1',0,v_5))),2)) v_5,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_6),'1',0,v_6))),2)) v_6,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_7),'1',0,v_7))),2)) v_7,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_8),'1',0,v_8))),2)) v_8,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_9),'1',0,v_9))),2)) v_9,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_10),'1',0,v_10))),2)) v_10,
		DECODE(SUBSTR(max(V_0),-1),'%',('要计算百分百'),FUN_CHAR(SUM(DECODE(SUBSTR(V_0,-1),'%',0,decode(f_str_or_num(v_11),'1',0,v_11))),2)) v_11
		FROM  YY2CSBB WHERE 1=1 AND XMLX=#{xmlx}
		<if test="gydw != null and gydw != ''">${gydw}</if>
		<if test="nf != null and nf != ''">AND NF = #{nf}</if>
		<if test="yf != null and yf != ''">${yf}</if>
			
		GROUP BY XH
		ORDER BY XH
	</select>
	
	<select id="getTjbbOfzjbdb" parameterType="elist" resultType="elist">
		SELECT 
		XH,MIN(V_0) V_0,
		FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_1),'1',0,V_1)),2) V_1,
    	MIN(V_2) V_2,
		FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_3),'1',0,V_3)),2) V_3
    	FROM YY2CSBB WHERE 1=1 AND XMLX=#{xmlx}
		<if test="gydw != null and gydw != ''">${gydw}</if>
		<if test="nf != null and nf != ''">AND NF = #{nf}</if>
		<if test="yf != null and yf != ''">${yf}</if>
			
		GROUP BY XH
		ORDER BY XH
	</select>
	<select id="getTjbbOfsrzcb" parameterType="elist" resultType="elist">
		SELECT 
		XH,MIN(V_0) V_0,
		FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_1),'1',0,V_1)),2) V_1,
    	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_2),'1',0,V_2)),2) V_2
    	FROM YY2CSBB WHERE 1=1 AND XMLX=#{xmlx}
		<if test="gydw != null and gydw != ''">${gydw}</if>
		<if test="nf != null and nf != ''">AND NF = #{nf}</if>
		<if test="yf != null and yf != ''">${yf}</if>
			
		GROUP BY XH
		ORDER BY XH
	</select>
	<select id="getTjbbOfzxqkb" parameterType="elist" resultType="elist">
		SELECT XH,
       	MIN(V_0) V_0,
       	MIN(V_1) V_1,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_2), '1', 0, V_2)),2) V_2,
      	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_3), '1', 0, V_3)),2) V_3,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_4), '1', 0, V_4)),2) V_4,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_5), '1', 0, V_5)),2) V_5,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_6), '1', 0, V_6)),2) V_6,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_7), '1', 0, V_7)),2) V_7,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_8), '1', 0, V_8)),2) V_8
  		FROM YY2CSBB WHERE 1=1 AND XMLX=#{xmlx}
		<if test="gydw != null and gydw != ''">${gydw}</if>
		<if test="nf != null and nf != ''">AND NF = #{nf}</if>
		<if test="yf != null and yf != ''">${yf}</if>
		GROUP BY XH
		ORDER BY XH
	</select>
	<select id="getTjbbOfzcfzb" parameterType="elist" resultType="elist">
		SELECT XH,
       	MIN(V_0) V_0,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_1), '1', 0, V_1)),2) V_1,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_2), '1', 0, V_2)),2) V_2,      
       	MIN(V_3) V_3,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_4), '1', 0, V_4)),2) V_4,
       	FUN_CHAR(SUM(DECODE(F_STR_OR_NUM(V_5), '1', 0, V_5)),2) V_5
  		FROM YY2CSBB WHERE 1=1 AND XMLX=#{xmlx}
		<if test="gydw != null and gydw != ''">${gydw}</if>
		<if test="nf != null and nf != ''">AND NF = #{nf}</if>
		<if test="yf != null and yf != ''">${yf}</if>
		GROUP BY XH
		ORDER BY XH
	</select>
	<select id="getZjsymxb" parameterType="elist" resultType="elist">
		select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
		nvl(yqjh.yqbb,0) v_4,nvl(yqjh.yqsb,0) v_5,nvl(yqjh.yqdf,0) v_6,nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_7,nvl(dnjh.dnbb,0) v_8,nvl(dnjh.dnsb,0) v_9,nvl(dnjh.dndf,0) v_10,
		nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_11,
		nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_12,
		jy.snbb v_13,jy.snsb v_14,jy.sndf v_15,
		jy.snztz v_16,jy.ssnztz v_17,jy.snztz v_18,
		nvl(dndw.bb,0) v_19,nvl(dndw.sb,0) v_20,nvl(dndw.df,0) v_21,nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_22,
		nvl(dnbf.bb,0) v_23,nvl(dnbf.sb,0) v_24,nvl(dnbf.df,0) v_25,nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_26,
		jy.dnbb v_27,jy.dnsb v_28,jy.dndf v_29,jy.dnztz v_30,
		nvl(tj.bb,0) v_31,nvl(tj.sb,0) v_32,nvl(tj.df,0) v_33,nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_34,'' v_35
		from xmjbxx x,(
		select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
		) yqjh,(
		select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
		) dnjh ,(
		select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		group by xmbm,substr(dwyf, 1, 4)
		)dndw,(
		select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf})  and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		group by xmbm,substr(bfyf, 1, 4)
		)dnbf,
		(select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
        fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
        fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
		from xmjbxx) jy,(
		select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		group by xmbm,substr(bfyf, 1, 4)
		)tj 
		
		where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
		 and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+) and x.xmbm=jy.xmbm(+)
		<if test="gydw != null">
		${gydw}
		</if> 
		<if test="xmnf != null">
	    ${xmnf}
	    </if> 
	    <if test="xmlx != null">
	    ${xmlx}
	    </if>
		
	</select>
	
	<select id="getZjsymxbzj" parameterType="elist" resultType="elist">
		select  '是' sfhj,''  v_0,'总计' v_1,'' v_2,'' v_3,
		sum(nvl(yqjh.yqbb,0)) v_4,sum(nvl(yqjh.yqsb,0)) v_5,sum(nvl(yqjh.yqdf,0)) v_6,sum(nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)) v_7,sum(nvl(dnjh.dnbb,0)) v_8,sum(nvl(dnjh.dnsb,0)) v_9,sum(nvl(dnjh.dndf,0)) v_10,
		sum(nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0)) v_11,
		sum(nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0)) v_12,
		sum(jy.snbb) v_13,sum(jy.snsb) v_14,sum(jy.sndf) v_15,
		sum(jy.snztz) v_16,sum(jy.ssnztz) v_17,sum(jy.snztz) v_18,
		sum(nvl(dndw.bb,0)) v_19,sum(nvl(dndw.sb,0)) v_20,sum(nvl(dndw.df,0)) v_21,sum(nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0)) v_22,
		sum(nvl(dnbf.bb,0)) v_23,sum(nvl(dnbf.sb,0)) v_24,sum(nvl(dnbf.df,0)) v_25,sum(nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0)) v_26,
		sum(jy.dnbb) v_27,sum(jy.dnsb) v_28,sum(jy.dndf) v_29,sum(jy.dnztz) v_30,
		sum(nvl(tj.bb,0)) v_31,sum(nvl(tj.sb,0)) v_32,sum(nvl(tj.df,0)) v_33,sum(nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0)) v_34,'' v_35
		from xmjbxx x,(
		select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
		) yqjh,(
		select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
		) dnjh ,(
		select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		group by xmbm,substr(dwyf, 1, 4)
		)dndw,(
		select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf})  and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		group by xmbm,substr(bfyf, 1, 4)
		)dnbf,
		(select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
        fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
        fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
		from xmjbxx) jy,(
		select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		group by xmbm,substr(bfyf, 1, 4)
		)tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
		 and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+) and x.xmbm=jy.xmbm(+)
		<if test="gydw != null">
		${gydw}
		</if> 
		<if test="xmnf != null">
	    ${xmnf}
	    </if> 
	    <if test="xmlx != null">
	    ${xmlx}
	    </if>
		
	</select>
	
	
	
	<select id="getZjsydwhzbhj" parameterType="elist" resultType="elist">
		select 
		'是' sfhj,'合计' v_1,sum(nvl(v_4,0)) v_4,sum(nvl(v_5,0)) v_5,sum(nvl(v_6,0)) v_6,sum(nvl(v_7,0)) v_7,sum(nvl(v_8,0)) v_8,sum(nvl(v_9,0)) v_9,
		sum(nvl(v_10,0)) v_10,sum(nvl(v_11,0)) v_11,sum(nvl(v_12,0)) v_12,sum(nvl(v_13,0)) v_13,count(*) xmsl
		from (
		select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
		    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
			jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9,
		    nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
		    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
		    jy.dnztz v_12,
		    nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(substr(x.gydwdm,0,1),'1',x.gydwdm,substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00') gydwdm
		    from xmjbxx x,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
		    ) yqjh,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
		    ) dnjh ,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(dwyf, 1, 4)
		    )dndw,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )dnbf,
		    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
            fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
        	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
			from xmjbxx) jy,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
		     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
		    <if test="gydw != null">
		    ${gydw}
		    </if> 
		    <if test="xmnf != null">
		    ${xmnf}
		    </if> 
		    <if test="xmlx != null">
		    ${xmlx}
		    </if>
		    )
		   
		
	</select>
	<select id="getZjsydwhzbhz" parameterType="elist" resultType="elist">
		select 
		'是' sfhj,gydwdm,min((select name from xtgl_department where id=gydwdm)) v_1,sum(nvl(v_4,0)) v_4,sum(nvl(v_5,0)) v_5,sum(nvl(v_6,0)) v_6,sum(nvl(v_7,0)) v_7,sum(nvl(v_8,0)) v_8,sum(nvl(v_9,0)) v_9,
		sum(nvl(v_10,0)) v_10,sum(nvl(v_11,0)) v_11,sum(nvl(v_12,0)) v_12,sum(nvl(v_13,0)) v_13,count(*) xmsl
		from (
		select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
		    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
		    jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9,
		    nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
		    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
		    jy.dnztz v_12,
		    nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(substr(x.gydwdm,0,1),'1',x.gydwdm,substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00') gydwdm
		    from xmjbxx x,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
		    ) yqjh,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
		    ) dnjh ,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(dwyf, 1, 4)
		    )dndw,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )dnbf,
		    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
        	fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
        	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
			from xmjbxx) jy,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
		     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
		    <if test="gydw != null">
		    ${gydw}
		    </if> 
		    <if test="xmnf != null">
		    ${xmnf}
		    </if> 
		    <if test="xmlx != null">
		    ${xmlx}
		    </if>
		    )
		    group by gydwdm
		    
		    order by gydwdm
		
	</select>
	<select id="getZjsydwhzb" parameterType="elist" resultType="elist">
	select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
    jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9,
    nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
    jy.dnztz v_12,
    nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(substr(x.gydwdm,0,1),'1',x.gydwdm,substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00') gydwdm
    from xmjbxx x,(
    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
    ) yqjh,(
    select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
    ) dnjh,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(dwyf, 1, 4)
    )dndw,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(bfyf, 1, 4)
    )dnbf,
    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
   	fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
   	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
	from xmjbxx) jy,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(bfyf, 1, 4)
    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
    <if test="gydw != null">
    ${gydw}
    </if> 
    <if test="xmnf != null">
    ${xmnf}
    </if> 
    <if test="xmlx != null">
    ${xmlx}
    </if>
    order by gydwdm
    
	</select>
	
	
	
	
	
	
	<select id="getZjsydwhzbhjds" parameterType="elist" resultType="elist">
		select 
		'是' sfhj,'合计' v_1,sum(nvl(v_4,0)) v_4,sum(nvl(v_5,0)) v_5,sum(nvl(v_6,0)) v_6,sum(nvl(v_7,0)) v_7,sum(nvl(v_8,0)) v_8,sum(nvl(v_9,0)) v_9,
		sum(nvl(v_10,0)) v_10,sum(nvl(v_11,0)) v_11,sum(nvl(v_12,0)) v_12,sum(nvl(v_13,0)) v_13,count(*) xmsl
		from (
		select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
		    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
		    jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9,
		    nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
		    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
		    jy.dnztz v_12,
		    nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(substr(x.gydwdm,0,1),'1',substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00',substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00') gydwdm
		    from xmjbxx x,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
		    ) yqjh,(
		     select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
   			 ) dnjh,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(dwyf, 1, 4)
		    )dndw,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )dnbf,
		    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
        	fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
        	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
			from xmjbxx) jy,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
		     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
		    <if test="gydw != null">
		    ${gydw}
		    </if> 
		    <if test="xmnf != null">
		    ${xmnf}
		    </if> 
		    <if test="xmlx != null">
		    ${xmlx}
		    </if>
		    )
		    
	</select>
	
	<select id="getZjsydwhzbhzds" parameterType="elist" resultType="elist">
		select 
		'是' sfhj,gydwdm,min((select name from xtgl_department where id=gydwdm)) v_1,sum(nvl(v_4,0)) v_4,sum(nvl(v_5,0)) v_5,sum(nvl(v_6,0)) v_6,sum(nvl(v_7,0)) v_7,sum(nvl(v_8,0)) v_8,sum(nvl(v_9,0)) v_9,
		sum(nvl(v_10,0)) v_10,sum(nvl(v_11,0)) v_11,sum(nvl(v_12,0)) v_12,sum(nvl(v_13,0)) v_13,count(*) xmsl
		from (
		select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
		    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
		    jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9,nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
		    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
		   jy.dnztz v_12,nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(substr(x.gydwdm,0,1),'1',substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00',substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00') gydwdm
		    from xmjbxx x,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
		    ) yqjh,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
		    ) dnjh ,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(dwyf, 1, 4)
		    )dndw,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )dnbf,
		    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
        	fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
        	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
			from xmjbxx) jy,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
		     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
		    <if test="gydw != null">
		    ${gydw}
		    </if> 
		    <if test="xmnf != null">
		    ${xmnf}
		    </if> 
		    <if test="xmlx != null">
		    ${xmlx}
		    </if>
		    )
		    group by gydwdm
		    
		    order by gydwdm
		
	</select>
	<select id="getZjsydwhzbds" parameterType="elist" resultType="elist">
	select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
    jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9,nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
    jy.dnztz v_12,nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(substr(x.gydwdm,0,1),'1',substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00',substr(x.gydwdm,1,4)||'1'||substr(x.gydwdm,6,4)||'00') gydwdm
    from xmjbxx x,(
    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
    ) yqjh,(
    select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
    ) dnjh ,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(dwyf, 1, 4)
    )dndw,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(bfyf, 1, 4)
    )dnbf,
    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
   	fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
   	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
	from xmjbxx) jy,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(bfyf, 1, 4)
    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
    <if test="gydw != null">
    ${gydw}
    </if> 
    <if test="xmnf != null">
    ${xmnf}
    </if> 
    <if test="xmlx != null">
    ${xmlx}
    </if>
    order by gydwdm
    
	</select>
	
	
	
	
	
	
	
	
	<select id="getZjsyxmhzbhj" parameterType="elist" resultType="elist">
		select 
		'是' sfhj,'合计' v_1,sum(nvl(v_4,0)) v_4,sum(nvl(v_5,0)) v_5,sum(nvl(v_6,0)) v_6,sum(nvl(v_7,0)) v_7,sum(nvl(v_8,0)) v_8,sum(nvl(v_9,0)) v_9,
		sum(nvl(v_10,0)) v_10,sum(nvl(v_11,0)) v_11,sum(nvl(v_12,0)) v_12,sum(nvl(v_13,0)) v_13,count(*) xmsl
		from (
		select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
		    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
		    jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9,nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
		    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
		    jy.dnztz v_12,nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(x.jsxz,'养护大中修',x.jsxz,x.gcfl) xmlx
		    from xmjbxx x,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
		    ) yqjh,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
		    ) dnjh ,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(dwyf, 1, 4)
		    )dndw,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )dnbf,
		    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
        	fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
        	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
			from xmjbxx) jy,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
		     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
		    <if test="gydw != null">
		    ${gydw}
		    </if> 
		    <if test="xmnf != null">
		    ${xmnf}
		    </if> 
		   	<if test="xmlx != null">
		    ${xmlx}
		    </if>
		    )
		    
		
	</select>
	<select id="getZjsyxmhzbhz" parameterType="elist" resultType="elist">
		select 
		'是' sfhj,xmlx,min(xmlx) v_1,sum(nvl(v_4,0)) v_4,sum(nvl(v_5,0)) v_5,sum(nvl(v_6,0)) v_6,sum(nvl(v_7,0)) v_7,sum(nvl(v_8,0)) v_8,sum(nvl(v_9,0)) v_9,
		sum(nvl(v_10,0)) v_10,sum(nvl(v_11,0)) v_11,sum(nvl(v_12,0)) v_12,sum(nvl(v_13,0)) v_13,count(*) xmsl
		from (
		select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
		    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
		    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
		    jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9,nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
		    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
		    jy.dnztz v_12,nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(x.jsxz,'养护大中修',x.jsxz,x.gcfl) xmlx
		    from xmjbxx x,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
		    ) yqjh,(
		    select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
		    ) dnjh ,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(dwyf, 1, 4)
		    )dndw,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )dnbf,
		    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
        	fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
        	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
			from xmjbxx) jy,(
		    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
		    group by xmbm,substr(bfyf, 1, 4)
		    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
		     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
		    <if test="gydw != null">
		    ${gydw}
		    </if> 
		    <if test="xmnf != null">
		    ${xmnf}
		    </if> 
		   	<if test="xmlx != null">
		    ${xmlx}
		    </if>
		    )
		    group by xmlx
		    
		    order by xmlx
		
	</select>
	
	<select id="getZjsyxmhzb" parameterType="elist" resultType="elist">
	select rownum v_0,x.gydw v_1,x.xmmc v_2,decode(yqjh.yqwh,null,dnjh.dnwh,decode(dnjh.dnwh,null,yqjh.yqwh,yqjh.yqwh||','||dnjh.dnwh)) v_3,
    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0) v_4,
    nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_5,
    nvl(yqjh.yqbb,0)+nvl(yqjh.yqsb,0)+nvl(yqjh.yqdf,0)+nvl(dnjh.dnbb,0)+nvl(dnjh.dnsb,0)+nvl(dnjh.dndf,0) v_6,
    jy.snztz v_7,jy.ssnztz v_8,jy.snztz v_9, nvl(dndw.bb,0)+nvl(dndw.sb,0)+nvl(dndw.df,0) v_10,
    nvl(dnbf.bb,0)+nvl(dnbf.sb,0)+nvl(dnbf.df,0) v_11,
    jy.dnztz v_12,nvl(tj.bb,0)+nvl(tj.sb,0)+nvl(tj.df,0) v_13,'' v_14,decode(x.jsxz,'养护大中修',x.jsxz,x.gcfl) xmlx
    from xmjbxx x,(
    select xmid,WMSYS.WM_CONCAT(jhxdwh) yqwh,sum(nvl(btzzj,0)) yqbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) yqsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) yqdf from xm_gsd_jhxd where xdnf &lt;${nf} group by xmid
    ) yqjh,(
    select xmid,WMSYS.WM_CONCAT(jhxdwh) dnwh,sum(nvl(btzzj,0)) dnbb,sum(nvl(stz,0)+nvl(gz,0)+nvl(sz,0)+nvl(stc,0)+nvl(dk,0)+nvl(zq,0)+nvl(jl,0)+nvl(rys,0)+nvl(ttc,0)+nvl(zddzjl,0)) dnsb,sum(nvl(dfzc,0)+nvl(yhdk,0)) dndf from xm_gsd_jhxd where xdnf =${nf} group by xmid
    ) dnjh ,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjdw where substr(dwyf,1,4)=to_char(${nf}) and to_date(dwyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(dwyf, 1, 4)
    )dndw,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjbf where substr(bfyf,1,4)=to_char(${nf}) and to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(bfyf, 1, 4)
    )dnbf,
    (select xmbm,fun_xmjy(xmbm,${nf}-2) ssnztz,fun_xmjybb(xmbm,${nf}-2) ssnbb,fun_xmjysb(xmbm,${nf}-2) ssnsb,fun_xmjydf(xmbm,${nf}-2) ssndf,
   	fun_xmjy(xmbm,${nf}-1) snztz,fun_xmjybb(xmbm,${nf}-1) snbb,fun_xmjysb(xmbm,${nf}-1) snsb,fun_xmjydf(xmbm,${nf}-1) sndf,
   	fun_xmjy(xmbm,${nf}) dnztz,fun_xmjybb(xmbm,${nf}) dnbb,fun_xmjysb(xmbm,${nf}) dnsb,fun_xmjydf(xmbm,${nf}) dndf
	from xmjbxx) jy,(
    select xmbm,sum(cgs) bb,sum(nvl(gz,0)+nvl(sz,0)+nvl(zq,0)+nvl(tdk,0)+nvl(jl,0)+nvl(qt,0)+nvl(rys,0)+nvl(stz,0)+nvl(ttc,0)+nvl(zddzjl,0)) sb,sum(dfzc+yhdk) df from xm_zjtj where to_date(bfyf,'yyyy-mm')&lt;=to_date(#{nf}||'-'||#{yf},'yyyy-mm')
    group by xmbm,substr(bfyf, 1, 4)
    )tj where x.xmbm=yqjh.xmid(+) and x.xmbm=dnjh.xmid(+) and x.xmbm=dndw.xmbm(+) 
     and x.xmbm=jy.xmbm(+) and x.xmbm=dnbf.xmbm(+) and x.xmbm=tj.xmbm(+)
    <if test="gydw != null">
    ${gydw}
    </if> 
    <if test="xmnf != null">
    ${xmnf}
    </if> 
    <if test="xmlx != null">
    ${xmlx}
    </if>
    order by xmlx
    
	</select>
</mapper>
